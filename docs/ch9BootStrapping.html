<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.1 Bootstrap Methods | Simulation Modeling using the Kotlin Simulation Library (KSL)</title>
  <meta name="description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.39 and GitBook 2.6.7" />

  <meta property="og:title" content="8.1 Bootstrap Methods | Simulation Modeling using the Kotlin Simulation Library (KSL)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.1 Bootstrap Methods | Simulation Modeling using the Kotlin Simulation Library (KSL)" />
  
  <meta name="twitter:description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  

<meta name="author" content="Manuel D. Rossetti" />


<meta name="date" content="2024-08-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch9AdvMC.html"/>
<link rel="next" href="ch9VRTs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulation Modeling using the Kotlin Simulation Library (KSL)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="release-history.html"><a href="release-history.html"><i class="fa fa-check"></i>Release History</a></li>
<li class="chapter" data-level="" data-path="ksl-project-page.html"><a href="ksl-project-page.html"><i class="fa fa-check"></i>KSL Project Page</a></li>
<li class="chapter" data-level="" data-path="book-support-files.html"><a href="book-support-files.html"><i class="fa fa-check"></i>Book Support Files</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="intended-audience.html"><a href="intended-audience.html"><i class="fa fa-check"></i>Intended Audience</a></li>
<li class="chapter" data-level="" data-path="organization-of-the-book.html"><a href="organization-of-the-book.html"><i class="fa fa-check"></i>Organization of the Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> Simulation Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulation-modeling.html"><a href="simulation-modeling.html"><i class="fa fa-check"></i><b>1.1</b> Simulation Modeling</a></li>
<li class="chapter" data-level="1.2" data-path="why-simulate.html"><a href="why-simulate.html"><i class="fa fa-check"></i><b>1.2</b> Why Simulate?</a></li>
<li class="chapter" data-level="1.3" data-path="types-of-systems-and-simulation-models.html"><a href="types-of-systems-and-simulation-models.html"><i class="fa fa-check"></i><b>1.3</b> Types of Systems and Simulation Models</a></li>
<li class="chapter" data-level="1.4" data-path="simulation-descriptive-or-prescriptive-modeling.html"><a href="simulation-descriptive-or-prescriptive-modeling.html"><i class="fa fa-check"></i><b>1.4</b> Simulation: Descriptive or Prescriptive Modeling?</a></li>
<li class="chapter" data-level="1.5" data-path="randomness-in-simulation.html"><a href="randomness-in-simulation.html"><i class="fa fa-check"></i><b>1.5</b> Randomness in Simulation</a></li>
<li class="chapter" data-level="1.6" data-path="simulation-languages.html"><a href="simulation-languages.html"><i class="fa fa-check"></i><b>1.6</b> Simulation Languages</a></li>
<li class="chapter" data-level="1.7" data-path="ch1secsimMeth.html"><a href="ch1secsimMeth.html"><i class="fa fa-check"></i><b>1.7</b> Simulation Methodology</a></li>
<li class="chapter" data-level="1.8" data-path="overview-of-the-kotlin-simulation-library.html"><a href="overview-of-the-kotlin-simulation-library.html"><i class="fa fa-check"></i><b>1.8</b> Overview of the Kotlin Simulation Library</a></li>
<li class="chapter" data-level="1.9" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch2rng.html"><a href="ch2rng.html"><i class="fa fa-check"></i><b>2</b> Modeling Randomness</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch2generator.html"><a href="ch2generator.html"><i class="fa fa-check"></i><b>2.1</b> Random Number Generator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch2generator.html"><a href="ch2generator.html#ch2randompkg"><i class="fa fa-check"></i><b>2.1.1</b> Random Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch2generator.html"><a href="ch2generator.html#ch2creatingStreams"><i class="fa fa-check"></i><b>2.1.2</b> Creating and Using Streams</a></li>
<li class="chapter" data-level="2.1.3" data-path="ch2generator.html"><a href="ch2generator.html#ch2crn"><i class="fa fa-check"></i><b>2.1.3</b> Common Random Numbers</a></li>
<li class="chapter" data-level="2.1.4" data-path="ch2generator.html"><a href="ch2generator.html#ch2antitheticStreams"><i class="fa fa-check"></i><b>2.1.4</b> Creating and Using Antithetic Streams</a></li>
<li class="chapter" data-level="2.1.5" data-path="ch2generator.html"><a href="ch2generator.html#ch2rnFAQ"><i class="fa fa-check"></i><b>2.1.5</b> Frequently Asked Questions about Random Numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rvg.html"><a href="rvg.html"><i class="fa fa-check"></i><b>2.2</b> Random Variate Generation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="rvg.html"><a href="rvg.html#basic-random-variate-generation"><i class="fa fa-check"></i><b>2.2.1</b> Basic Random Variate Generation</a></li>
<li class="chapter" data-level="2.2.2" data-path="rvg.html"><a href="rvg.html#rvg_dists"><i class="fa fa-check"></i><b>2.2.2</b> Continuous and Discrete Random Variables</a></li>
<li class="chapter" data-level="2.2.3" data-path="rvg.html"><a href="rvg.html#rvguse"><i class="fa fa-check"></i><b>2.2.3</b> Creating and Using Random Variables</a></li>
<li class="chapter" data-level="2.2.4" data-path="rvg.html"><a href="rvg.html#functions-of-random-variables"><i class="fa fa-check"></i><b>2.2.4</b> Functions of Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="probModels.html"><a href="probModels.html"><i class="fa fa-check"></i><b>2.3</b> Probability Distribution Models</a></li>
<li class="chapter" data-level="2.4" data-path="distFitting.html"><a href="distFitting.html"><i class="fa fa-check"></i><b>2.4</b> Distribution Fitting Using the KSL</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="distFitting.html"><a href="distFitting.html#estimating-distribution-parameters"><i class="fa fa-check"></i><b>2.4.1</b> Estimating Distribution Parameters</a></li>
<li class="chapter" data-level="2.4.2" data-path="distFitting.html"><a href="distFitting.html#continuous-distribution-recommendation-framework"><i class="fa fa-check"></i><b>2.4.2</b> Continuous Distribution Recommendation Framework</a></li>
<li class="chapter" data-level="2.4.3" data-path="distFitting.html"><a href="distFitting.html#discrete-distribution-framework"><i class="fa fa-check"></i><b>2.4.3</b> Discrete Distribution Framework</a></li>
<li class="chapter" data-level="2.4.4" data-path="distFitting.html"><a href="distFitting.html#pdfmexamples"><i class="fa fa-check"></i><b>2.4.4</b> Illustrative Examples from Appendix @ref(appidm)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
<li class="chapter" data-level="2.6" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mcm.html"><a href="mcm.html"><i class="fa fa-check"></i><b>3</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="kslStatistics.html"><a href="kslStatistics.html"><i class="fa fa-check"></i><b>3.1</b> Collecting Statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="kslStatistics.html"><a href="kslStatistics.html#creating-and-using-a-statistic"><i class="fa fa-check"></i><b>3.1.1</b> Creating and Using a Statistic</a></li>
<li class="chapter" data-level="3.1.2" data-path="kslStatistics.html"><a href="kslStatistics.html#histFreq"><i class="fa fa-check"></i><b>3.1.2</b> Histograms and Frequencies</a></li>
<li class="chapter" data-level="3.1.3" data-path="kslStatistics.html"><a href="kslStatistics.html#ch3batchStats"><i class="fa fa-check"></i><b>3.1.3</b> Batch Statistics</a></li>
<li class="chapter" data-level="3.1.4" data-path="kslStatistics.html"><a href="kslStatistics.html#ch3StatSummary"><i class="fa fa-check"></i><b>3.1.4</b> Statistics Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ssMC.html"><a href="ssMC.html"><i class="fa fa-check"></i><b>3.2</b> Simple Monte Carlo Integration</a></li>
<li class="chapter" data-level="3.3" data-path="ch3StatReview.html"><a href="ch3StatReview.html"><i class="fa fa-check"></i><b>3.3</b> Review of Statistical Concepts</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch3StatReview.html"><a href="ch3StatReview.html#point-estimates-and-confidence-intervals"><i class="fa fa-check"></i><b>3.3.1</b> Point Estimates and Confidence Intervals</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch3StatReview.html"><a href="ch3StatReview.html#ch3SampleSize"><i class="fa fa-check"></i><b>3.3.2</b> Sample Size Determination</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch3StatReview.html"><a href="ch3StatReview.html#determining-the-sample-size-for-a-monte-carlo-simulation-experiment"><i class="fa fa-check"></i><b>3.3.3</b> Determining the Sample Size for a Monte Carlo Simulation Experiment</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="craps.html"><a href="craps.html"><i class="fa fa-check"></i><b>3.4</b> Simulating the Game of Craps</a></li>
<li class="chapter" data-level="3.5" data-path="the-news-vendor-problem.html"><a href="the-news-vendor-problem.html"><i class="fa fa-check"></i><b>3.5</b> The News Vendor Problem</a></li>
<li class="chapter" data-level="3.6" data-path="ch3InsProcess.html"><a href="ch3InsProcess.html"><i class="fa fa-check"></i><b>3.6</b> A Simple Inspection Process</a></li>
<li class="chapter" data-level="3.7" data-path="ch3SAN.html"><a href="ch3SAN.html"><i class="fa fa-check"></i><b>3.7</b> Stochastic Activity Networks</a></li>
<li class="chapter" data-level="3.8" data-path="mcmExperiments.html"><a href="mcmExperiments.html"><i class="fa fa-check"></i><b>3.8</b> Monte-Carlo Experiments</a></li>
<li class="chapter" data-level="3.9" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>3.9</b> Summary</a></li>
<li class="chapter" data-level="3.10" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>3.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introDEDS.html"><a href="introDEDS.html"><i class="fa fa-check"></i><b>4</b> Introduction to Discrete Event Modeling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introDEDSdeds.html"><a href="introDEDSdeds.html"><i class="fa fa-check"></i><b>4.1</b> Discrete-Event Dynamic Systems</a></li>
<li class="chapter" data-level="4.2" data-path="HowDEDSClockWorks.html"><a href="HowDEDSClockWorks.html"><i class="fa fa-check"></i><b>4.2</b> How the Discrete-Event Clock Works</a></li>
<li class="chapter" data-level="4.3" data-path="QHandExample.html"><a href="QHandExample.html"><i class="fa fa-check"></i><b>4.3</b> Simulating a Queueing System By Hand</a></li>
<li class="chapter" data-level="4.4" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html"><i class="fa fa-check"></i><b>4.4</b> Modeling DEDS in the KSL</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#event-scheduling"><i class="fa fa-check"></i><b>4.4.1</b> Event Scheduling</a></li>
<li class="chapter" data-level="4.4.2" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSschedExamples"><i class="fa fa-check"></i><b>4.4.2</b> Simple Event Scheduling Examples</a></li>
<li class="chapter" data-level="4.4.3" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSUpDown"><i class="fa fa-check"></i><b>4.4.3</b> Up and Down Component Example</a></li>
<li class="chapter" data-level="4.4.4" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSPharmacy"><i class="fa fa-check"></i><b>4.4.4</b> Modeling a Simple Queueing System</a></li>
<li class="chapter" data-level="4.4.5" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#more-details-about-the-pharmacy-model-implementation"><i class="fa fa-check"></i><b>4.4.5</b> More Details About the Pharmacy Model Implementation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html"><i class="fa fa-check"></i><b>4.5</b> Enhancing the Drive Through Pharmacy Model</a></li>
<li class="chapter" data-level="4.6" data-path="DTPExpanded.html"><a href="DTPExpanded.html"><i class="fa fa-check"></i><b>4.6</b> More Drive Through Fun</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-a-simple-resource"><i class="fa fa-check"></i><b>4.6.1</b> Modeling a Simple Resource</a></li>
<li class="chapter" data-level="4.6.2" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-a-resource-with-a-waiting-line"><i class="fa fa-check"></i><b>4.6.2</b> Modeling a Resource with a Waiting Line</a></li>
<li class="chapter" data-level="4.6.3" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-the-tandem-queue-of-example-refexmexch4tandemq"><i class="fa fa-check"></i><b>4.6.3</b> Modeling the Tandem Queue of Example @ref(exm:exCh4TandemQ)</a></li>
<li class="chapter" data-level="4.6.4" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-with-the-station-package"><i class="fa fa-check"></i><b>4.6.4</b> Modeling with the Station Package</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="introDEDSSummary.html"><a href="introDEDSSummary.html"><i class="fa fa-check"></i><b>4.7</b> Summary</a></li>
<li class="chapter" data-level="4.8" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>4.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simoa.html"><a href="simoa.html"><i class="fa fa-check"></i><b>5</b> Analyzing and Accessing Simulation Output</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simoadatatypes.html"><a href="simoadatatypes.html"><i class="fa fa-check"></i><b>5.1</b> Types of Statistical Variables</a></li>
<li class="chapter" data-level="5.2" data-path="simoasimtypes.html"><a href="simoasimtypes.html"><i class="fa fa-check"></i><b>5.2</b> Types of Simulation With Respect To Output Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="simoafinhorizon.html"><a href="simoafinhorizon.html"><i class="fa fa-check"></i><b>5.3</b> Analysis of Finite Horizon Simulations</a></li>
<li class="chapter" data-level="5.4" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html"><i class="fa fa-check"></i><b>5.4</b> Capturing Output for a Simple Finite Horizon Simulation</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#simoaCapture"><i class="fa fa-check"></i><b>5.4.1</b> KSL Functionality for Capturing Statistical Results</a></li>
<li class="chapter" data-level="5.4.2" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#additional-remarks"><i class="fa fa-check"></i><b>5.4.2</b> Additional Remarks</a></li>
<li class="chapter" data-level="5.4.3" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#querying-the-ksl-database"><i class="fa fa-check"></i><b>5.4.3</b> Querying the KSL Database</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="simoaseqsampling.html"><a href="simoaseqsampling.html"><i class="fa fa-check"></i><b>5.5</b> Sequential Sampling for Finite Horizon Simulations</a></li>
<li class="chapter" data-level="5.6" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html"><i class="fa fa-check"></i><b>5.6</b> Analysis of Infinite Horizon Simulations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizoninitialbias"><i class="fa fa-check"></i><b>5.6.1</b> Assessing the Effect of Initial Conditions</a></li>
<li class="chapter" data-level="5.6.2" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonrepDeletion"><i class="fa fa-check"></i><b>5.6.2</b> Performing the Method of Replication-Deletion</a></li>
<li class="chapter" data-level="5.6.3" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonbatchmeans"><i class="fa fa-check"></i><b>5.6.3</b> The Method of Batch Means</a></li>
<li class="chapter" data-level="5.6.4" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonjslbatching"><i class="fa fa-check"></i><b>5.6.4</b> Performing the Method of Batch Means</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html"><i class="fa fa-check"></i><b>5.7</b> Comparing System Configurations</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#simoacomparingSystems:two"><i class="fa fa-check"></i><b>5.7.1</b> Comparing Two Systems</a></li>
<li class="chapter" data-level="5.7.2" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#simoacomparingSystemsMCB"><i class="fa fa-check"></i><b>5.7.2</b> Concepts for Comparing Systems</a></li>
<li class="chapter" data-level="5.7.3" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#multiple-comparison-with-the-best-procedures-mcb"><i class="fa fa-check"></i><b>5.7.3</b> Multiple Comparison with the Best Procedures (MCB)</a></li>
<li class="chapter" data-level="5.7.4" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#ch5Screening"><i class="fa fa-check"></i><b>5.7.4</b> Screening Procedures</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html"><i class="fa fa-check"></i><b>5.8</b> Simulating Many Scenarios</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#controlAntns"><i class="fa fa-check"></i><b>5.8.1</b> Control Annotations</a></li>
<li class="chapter" data-level="5.8.2" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#rvParameters"><i class="fa fa-check"></i><b>5.8.2</b> Random Variable Parameters</a></li>
<li class="chapter" data-level="5.8.3" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#kslScenarios"><i class="fa fa-check"></i><b>5.8.3</b> Setting Up and Running Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="simoasummary.html"><a href="simoasummary.html"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
<li class="chapter" data-level="5.10" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>5.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processview.html"><a href="processview.html"><i class="fa fa-check"></i><b>6</b> Process View Modeling Using the KSL</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch6Entities.html"><a href="ch6Entities.html"><i class="fa fa-check"></i><b>6.1</b> What are Entities?</a></li>
<li class="chapter" data-level="6.2" data-path="pvIntro.html"><a href="pvIntro.html"><i class="fa fa-check"></i><b>6.2</b> The Process View</a></li>
<li class="chapter" data-level="6.3" data-path="understanding-ksl-processes-and-entities.html"><a href="understanding-ksl-processes-and-entities.html"><i class="fa fa-check"></i><b>6.3</b> Understanding KSL Processes and Entities</a></li>
<li class="chapter" data-level="6.4" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html"><i class="fa fa-check"></i><b>6.4</b> Examples of Process Modeling</a></li>
<li class="chapter" data-level="6.5" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html"><i class="fa fa-check"></i><b>6.5</b> Modeling a STEM Career Mixer</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html#conceptualizing-the-system"><i class="fa fa-check"></i><b>6.5.1</b> Conceptualizing the System</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html#implementing-the-stem-mixer-model"><i class="fa fa-check"></i><b>6.5.2</b> Implementing the STEM Mixer Model</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="the-tie-dye-t-shirt-model.html"><a href="the-tie-dye-t-shirt-model.html"><i class="fa fa-check"></i><b>6.6</b> The Tie-Dye T-Shirt Model</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="the-tie-dye-t-shirt-model.html"><a href="the-tie-dye-t-shirt-model.html#ch4:TieDyeTShirtsSub1"><i class="fa fa-check"></i><b>6.6.1</b> Implementing the Tie-Dye T-Shirt Model</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="summary-2.html"><a href="summary-2.html"><i class="fa fa-check"></i><b>6.7</b> Summary</a></li>
<li class="chapter" data-level="6.8" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch7AdvModeling.html"><a href="ch7AdvModeling.html"><i class="fa fa-check"></i><b>7</b> Advanced Event and Process View Modeling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html"><i class="fa fa-check"></i><b>7.1</b> Modeling with Processes and Resources</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#modeling-space-with-resources"><i class="fa fa-check"></i><b>7.1.1</b> Modeling Space with Resources</a></li>
<li class="chapter" data-level="7.1.2" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#resource-pools"><i class="fa fa-check"></i><b>7.1.2</b> Resource Pools</a></li>
<li class="chapter" data-level="7.1.3" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#computer-test-and-repair-shop-example"><i class="fa fa-check"></i><b>7.1.3</b> Computer Test and Repair Shop Example</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html"><i class="fa fa-check"></i><b>7.2</b> Modeling Non-Stationary Systems</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#ch7secNSPP"><i class="fa fa-check"></i><b>7.2.1</b> Non-Stationary Arrival Processes</a></li>
<li class="chapter" data-level="7.2.2" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#modeling-resources-under-non-stationary-conditions"><i class="fa fa-check"></i><b>7.2.2</b> Modeling Resources Under Non-Stationary Conditions</a></li>
<li class="chapter" data-level="7.2.3" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#enhancing-the-stem-career-mixer-model"><i class="fa fa-check"></i><b>7.2.3</b> Enhancing the STEM Career Mixer Model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html"><i class="fa fa-check"></i><b>7.3</b> Examples of Advanced Event Models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html#ch6s1sb4sub3"><i class="fa fa-check"></i><b>7.3.1</b> Modeling Balking and Reneging</a></li>
<li class="chapter" data-level="7.3.2" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html#rqModel"><i class="fa fa-check"></i><b>7.3.2</b> Modeling a Reorder Point, Reorder Quantity Inventory Policy</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="summary-3.html"><a href="summary-3.html"><i class="fa fa-check"></i><b>7.4</b> Summary</a></li>
<li class="chapter" data-level="7.5" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>7.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch9AdvMC.html"><a href="ch9AdvMC.html"><i class="fa fa-check"></i><b>8</b> Advanced Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="8.1" data-path="ch9BootStrapping.html"><a href="ch9BootStrapping.html"><i class="fa fa-check"></i><b>8.1</b> Bootstrap Methods</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="ch9BootStrapping.html"><a href="ch9BootStrapping.html#bootstrapping-using-the-ksl"><i class="fa fa-check"></i><b>8.1.1</b> Bootstrapping Using the KSL</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="ch9VRTs.html"><a href="ch9VRTs.html"><i class="fa fa-check"></i><b>8.2</b> Variance Reduction Techniques</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="ch9VRTs.html"><a href="ch9VRTs.html#common-random-numbers-crn"><i class="fa fa-check"></i><b>8.2.1</b> Common Random Numbers (CRN)</a></li>
<li class="chapter" data-level="8.2.2" data-path="ch9VRTs.html"><a href="ch9VRTs.html#antithetic-variates-av"><i class="fa fa-check"></i><b>8.2.2</b> Antithetic Variates (AV)</a></li>
<li class="chapter" data-level="8.2.3" data-path="ch9VRTs.html"><a href="ch9VRTs.html#indirect-estimation"><i class="fa fa-check"></i><b>8.2.3</b> Indirect Estimation</a></li>
<li class="chapter" data-level="8.2.4" data-path="ch9VRTs.html"><a href="ch9VRTs.html#control-variates-cv"><i class="fa fa-check"></i><b>8.2.4</b> Control Variates (CV)</a></li>
<li class="chapter" data-level="8.2.5" data-path="ch9VRTs.html"><a href="ch9VRTs.html#stratified-and-post-stratified-sampling"><i class="fa fa-check"></i><b>8.2.5</b> Stratified and Post Stratified Sampling</a></li>
<li class="chapter" data-level="8.2.6" data-path="ch9VRTs.html"><a href="ch9VRTs.html#conditional-expectation-ce"><i class="fa fa-check"></i><b>8.2.6</b> Conditional Expectation (CE)</a></li>
<li class="chapter" data-level="8.2.7" data-path="ch9VRTs.html"><a href="ch9VRTs.html#importance-sampling-is"><i class="fa fa-check"></i><b>8.2.7</b> Importance Sampling (IS)</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html"><i class="fa fa-check"></i><b>8.3</b> Generating Multi-Variate and Correlated Random Variates</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#generating-from-a-bivariate-normal-distribution"><i class="fa fa-check"></i><b>8.3.1</b> Generating from a Bivariate Normal Distribution</a></li>
<li class="chapter" data-level="8.3.2" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#copulas-and-multi-variate-generation-methods"><i class="fa fa-check"></i><b>8.3.2</b> Copulas and Multi-variate Generation Methods</a></li>
<li class="chapter" data-level="8.3.3" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#autocorrelated-generation"><i class="fa fa-check"></i><b>8.3.3</b> Autocorrelated Generation</a></li>
<li class="chapter" data-level="8.3.4" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#ch9MCMC"><i class="fa fa-check"></i><b>8.3.4</b> Introduction to Markov Chain Monte Carlo Methods</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="summary-4.html"><a href="summary-4.html"><i class="fa fa-check"></i><b>8.4</b> Summary</a></li>
<li class="chapter" data-level="8.5" data-path="exercises-7.html"><a href="exercises-7.html"><i class="fa fa-check"></i><b>8.5</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appRNRV.html"><a href="appRNRV.html"><i class="fa fa-check"></i><b>A</b> Generating Pseudo-Random Numbers and Random Variates</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appRNRVPRN.html"><a href="appRNRVPRN.html"><i class="fa fa-check"></i><b>A.1</b> Pseudo Random Numbers</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appRNRVPRN.html"><a href="appRNRVPRN.html#appRNRVRNGs"><i class="fa fa-check"></i><b>A.1.1</b> Random Number Generators</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="appRNRVs.html"><a href="appRNRVs.html"><i class="fa fa-check"></i><b>A.2</b> Generating Random Variates from Distributions</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="appRNRVs.html"><a href="appRNRVs.html#inverse-transform-method"><i class="fa fa-check"></i><b>A.2.1</b> Inverse Transform Method</a></li>
<li class="chapter" data-level="A.2.2" data-path="appRNRVs.html"><a href="appRNRVs.html#convolution"><i class="fa fa-check"></i><b>A.2.2</b> Convolution</a></li>
<li class="chapter" data-level="A.2.3" data-path="appRNRVs.html"><a href="appRNRVs.html#acceptancerejection"><i class="fa fa-check"></i><b>A.2.3</b> Acceptance/Rejection</a></li>
<li class="chapter" data-level="A.2.4" data-path="appRNRVs.html"><a href="appRNRVs.html#AppRNRVsubsecMTSRV"><i class="fa fa-check"></i><b>A.2.4</b> Mixture Distributions, Truncated Distributions, and Shifted Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="summary-5.html"><a href="summary-5.html"><i class="fa fa-check"></i><b>A.3</b> Summary</a></li>
<li class="chapter" data-level="A.4" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i><b>A.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appidm.html"><a href="appidm.html"><i class="fa fa-check"></i><b>B</b> Probability Distribution Modeling</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appidmsecrvPD.html"><a href="appidmsecrvPD.html"><i class="fa fa-check"></i><b>B.1</b> Random Variables and Probability Distributions</a></li>
<li class="chapter" data-level="B.2" data-path="appidmsecMDD.html"><a href="appidmsecMDD.html"><i class="fa fa-check"></i><b>B.2</b> Modeling with Discrete Distributions</a></li>
<li class="chapter" data-level="B.3" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html"><i class="fa fa-check"></i><b>B.3</b> Fitting Discrete Distributions</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#AppDisFitPoissonFit"><i class="fa fa-check"></i><b>B.3.1</b> Fitting a Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.2" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#visualizing-the-data"><i class="fa fa-check"></i><b>B.3.2</b> Visualizing the Data</a></li>
<li class="chapter" data-level="B.3.3" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#estimating-the-rate-parameter-for-the-poisson-distribution"><i class="fa fa-check"></i><b>B.3.3</b> Estimating the Rate Parameter for the Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.4" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#chi-squared-goodness-of-fit-test-for-poisson-distribution"><i class="fa fa-check"></i><b>B.3.4</b> Chi-Squared Goodness of Fit Test for Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.5" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#subsubchisqGOF"><i class="fa fa-check"></i><b>B.3.5</b> Chi-Squared Goodness of Fit Test</a></li>
<li class="chapter" data-level="B.3.6" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#using-the-fitdistrplus-r-package-on-discrete-data"><i class="fa fa-check"></i><b>B.3.6</b> Using the fitdistrplus R Package on Discrete Data</a></li>
<li class="chapter" data-level="B.3.7" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#fitting-a-discrete-empirical-distribution"><i class="fa fa-check"></i><b>B.3.7</b> Fitting a Discrete Empirical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="appidmsecMCD.html"><a href="appidmsecMCD.html"><i class="fa fa-check"></i><b>B.4</b> Modeling with Continuous Distributions</a></li>
<li class="chapter" data-level="B.5" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html"><i class="fa fa-check"></i><b>B.5</b> Fitting Continuous Distributions</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecvisualizedata"><i class="fa fa-check"></i><b>B.5.1</b> Visualizing the Data</a></li>
<li class="chapter" data-level="B.5.2" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecstatsdata"><i class="fa fa-check"></i><b>B.5.2</b> Statistically Summarize the Data</a></li>
<li class="chapter" data-level="B.5.3" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsechypothDist"><i class="fa fa-check"></i><b>B.5.3</b> Hypothesizing and Testing a Distribution</a></li>
<li class="chapter" data-level="B.5.4" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>B.5.4</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="B.5.5" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecvisFit"><i class="fa fa-check"></i><b>B.5.5</b> Visualizing the Fit</a></li>
<li class="chapter" data-level="B.5.6" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidms2sb3"><i class="fa fa-check"></i><b>B.5.6</b> Using the Input Analyzer</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html"><i class="fa fa-check"></i><b>B.6</b> Testing Uniform (0,1) Pseudo-Random Numbers</a>
<ul>
<li class="chapter" data-level="B.6.1" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#chi-squared-goodness-of-fit-tests-for-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.1</b> Chi-Squared Goodness of Fit Tests for Pseudo-Random Numbers</a></li>
<li class="chapter" data-level="B.6.2" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#higher-dimensional-chi-squared-test"><i class="fa fa-check"></i><b>B.6.2</b> Higher Dimensional Chi-Squared Test</a></li>
<li class="chapter" data-level="B.6.3" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#kolmogorov-smirnov-test-for-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.3</b> Kolmogorov-Smirnov Test for Pseudo-Random Numbers</a></li>
<li class="chapter" data-level="B.6.4" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#testing-for-independence-and-patterns-in-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.4</b> Testing for Independence and Patterns in Pseudo-Random Numbers</a></li>
</ul></li>
<li class="chapter" data-level="B.7" data-path="appdistfitidms2sb4.html"><a href="appdistfitidms2sb4.html"><i class="fa fa-check"></i><b>B.7</b> Additional Distribution Modeling Concepts</a></li>
<li class="chapter" data-level="B.8" data-path="appidmSummary.html"><a href="appidmSummary.html"><i class="fa fa-check"></i><b>B.8</b> Summary</a></li>
<li class="chapter" data-level="B.9" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i><b>B.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="appqtAndInvT.html"><a href="appqtAndInvT.html"><i class="fa fa-check"></i><b>C</b> Queueing Theory</a>
<ul>
<li class="chapter" data-level="C.1" data-path="appqts1.html"><a href="appqts1.html"><i class="fa fa-check"></i><b>C.1</b> Single Line Queueing Stations</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="appqts1.html"><a href="appqts1.html#queueing-notation"><i class="fa fa-check"></i><b>C.1.1</b> Queueing Notation</a></li>
<li class="chapter" data-level="C.1.2" data-path="appqts1.html"><a href="appqts1.html#littles-formula"><i class="fa fa-check"></i><b>C.1.2</b> Little’s Formula</a></li>
<li class="chapter" data-level="C.1.3" data-path="appqts1.html"><a href="appqts1.html#appqts1sb1"><i class="fa fa-check"></i><b>C.1.3</b> Deriving Formulas for Markovian Single Queue Systems</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="appqts1sb2.html"><a href="appqts1sb2.html"><i class="fa fa-check"></i><b>C.2</b> Examples and Applications of Queueing Analysis</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="appqts1sb2.html"><a href="appqts1sb2.html#infinite-queue-examples"><i class="fa fa-check"></i><b>C.2.1</b> Infinite Queue Examples</a></li>
<li class="chapter" data-level="C.2.2" data-path="appqts1sb2.html"><a href="appqts1sb2.html#finite-queue-examples"><i class="fa fa-check"></i><b>C.2.2</b> Finite Queue Examples</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="appqts1sb3.html"><a href="appqts1sb3.html"><i class="fa fa-check"></i><b>C.3</b> Non-Markovian Queues and Approximations</a></li>
<li class="chapter" data-level="C.4" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html"><i class="fa fa-check"></i><b>C.4</b> Summary of Queueing Formulas</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1-queue"><i class="fa fa-check"></i><b>C.4.1</b> M/M/1 Queue</a></li>
<li class="chapter" data-level="C.4.2" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmc-queue"><i class="fa fa-check"></i><b>C.4.2</b> M/M/c Queue</a></li>
<li class="chapter" data-level="C.4.3" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmck-queue"><i class="fa fa-check"></i><b>C.4.3</b> M/M/c/k Queue</a></li>
<li class="chapter" data-level="C.4.4" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mgcc-queue"><i class="fa fa-check"></i><b>C.4.4</b> M/G/c/c Queue</a></li>
<li class="chapter" data-level="C.4.5" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1k-queue"><i class="fa fa-check"></i><b>C.4.5</b> M/M/1/k Queue</a></li>
<li class="chapter" data-level="C.4.6" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmck-queue-1"><i class="fa fa-check"></i><b>C.4.6</b> M/M/c/k Queue</a></li>
<li class="chapter" data-level="C.4.7" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1kk-queue"><i class="fa fa-check"></i><b>C.4.7</b> M/M/1/k/k Queue</a></li>
<li class="chapter" data-level="C.4.8" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmckk-queue"><i class="fa fa-check"></i><b>C.4.8</b> M/M/c/k/k Queue</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="exercises-10.html"><a href="exercises-10.html"><i class="fa fa-check"></i><b>C.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="appUtilities.html"><a href="appUtilities.html"><i class="fa fa-check"></i><b>D</b> KSL Utility Packages</a>
<ul>
<li class="chapter" data-level="D.1" data-path="the-outputdirectory-class-and-ksl-object.html"><a href="the-outputdirectory-class-and-ksl-object.html"><i class="fa fa-check"></i><b>D.1</b> The <code>OutputDirectory</code> Class and <code>KSL</code> Object</a></li>
<li class="chapter" data-level="D.2" data-path="logging-options.html"><a href="logging-options.html"><i class="fa fa-check"></i><b>D.2</b> Logging Options</a></li>
<li class="chapter" data-level="D.3" data-path="the-kslfileutil-object.html"><a href="the-kslfileutil-object.html"><i class="fa fa-check"></i><b>D.3</b> The <code>KSLFileUtil</code> Object</a></li>
<li class="chapter" data-level="D.4" data-path="appDCSVEtc.html"><a href="appDCSVEtc.html"><i class="fa fa-check"></i><b>D.4</b> CSV, Excel, and Tabular Data Files</a></li>
<li class="chapter" data-level="D.5" data-path="dfUtil.html"><a href="dfUtil.html"><i class="fa fa-check"></i><b>D.5</b> The <code>DataFrameUtil</code> Object</a></li>
<li class="chapter" data-level="D.6" data-path="ksl-database-utilities.html"><a href="ksl-database-utilities.html"><i class="fa fa-check"></i><b>D.6</b> KSL Database Utilities</a></li>
<li class="chapter" data-level="D.7" data-path="appUtilitiesArrays.html"><a href="appUtilitiesArrays.html"><i class="fa fa-check"></i><b>D.7</b> Array Utilities</a></li>
<li class="chapter" data-level="D.8" data-path="appPlotting.html"><a href="appPlotting.html"><i class="fa fa-check"></i><b>D.8</b> KSL Plotting Utilities</a></li>
<li class="chapter" data-level="D.9" data-path="appExpDesign.html"><a href="appExpDesign.html"><i class="fa fa-check"></i><b>D.9</b> Experimental Design Utilities</a></li>
<li class="chapter" data-level="D.10" data-path="appUtilitiesMisc.html"><a href="appUtilitiesMisc.html"><i class="fa fa-check"></i><b>D.10</b> Miscellaneous Utilities</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>E</b> Distributions</a>
<ul>
<li class="chapter" data-level="E.1" data-path="appDiscreteDistributions.html"><a href="appDiscreteDistributions.html"><i class="fa fa-check"></i><b>E.1</b> Discrete Distrbutions</a></li>
<li class="chapter" data-level="E.2" data-path="appContinuousDistributions.html"><a href="appContinuousDistributions.html"><i class="fa fa-check"></i><b>E.2</b> Continuous Distrbutions</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="appStatTables.html"><a href="appStatTables.html"><i class="fa fa-check"></i><b>F</b> Statistical Tables</a></li>
<li class="chapter" data-level="G" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>G</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulation Modeling using the Kotlin Simulation Library (KSL)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch9BootStrapping" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Bootstrap Methods<a href="ch9BootStrapping.html#ch9BootStrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Bootstrapping is a statistical procedure that resamples from a sample to create many simulated samples. Although there are some parametric bootstrapping approaches, bootstrapping is generally considered a non-parametric Monte Carlo method that estimates characteristics of a population by resampling. The samples from the original sample are used to make inferences about the population and about the statistical properties computed from the original sample. The intuitions associated with bootstrapping come from a deep understanding of what it means to sample.</p>
<p>The concepts of estimation theory presented in Section <a href="ch3StatReview.html#ch3StatReview">3.3</a> of Chapter <a href="mcm.html#mcm">3</a> are based on having a random sample. Let <span class="math inline">\(x_{i}\)</span> represent the <span class="math inline">\(i^{th}\)</span> observations in a sample, <span class="math inline">\(x_{1}, x_{2},\cdots,x_{n}\)</span> of size <span class="math inline">\(n\)</span>. Represent the <em>random variables</em> in the sample as <span class="math inline">\(X_{1}, X_{2},\cdots,X_{n}\)</span>. The
random variables form a <strong>random sample</strong>, if 1) the <span class="math inline">\(X_{i}\)</span> are independent
random variables and 2) every <span class="math inline">\(X_{i}\)</span> has the same probability distribution. We assume that the random sample comes from some <em>population</em>. In statistical estimation theory, a population is the complete set of items from which we desire to make inferences. We assume that the population represents a set of things that have one or more characteristics in common. A population may be finite or infinite. In the case of a finite population, the size of the population may be so large or it may be too time consuming or costly to enumerate all elements of the population. However, conceptually, for a finite population, we can assign an integer to each element and thus count the elements and the final number of elements will be finite number. In the case of an infinite population, the definition of the underlying characteristics of the items makes enumeration impossible. That is, we cannot represent the number of elements in the population with a finite integer.</p>
<p>The concept of a finite population and an infinite population is sometimes confused with the concepts of discrete and continuous random variables. A continuous random variable has (by the underlying characteristics of its elements) an infinite population. For example, consider a random variable representing the time of arrival, <span class="math inline">\(A_i\)</span>. Since the underlying quantity is <em>time</em>, we note that time (conceptually) is a continuous thing, it is infinitely divisible and has no limit (at least based on our current understand of physics). A discrete random variable can have either a finite or an infinite population. Consider for example, the number of heads within 100 flips of a coin. This random variable is governed by a binomial distribution, and can take on any of the values <span class="math inline">\(0, 1, 2, \cdots, n\)</span> where <span class="math inline">\(n=100\)</span>, the (finite) number of trials. In this case, the population (set of possible values) is finite. However, now consider a geometric random variable. The set of possible values for a geometric random variable <span class="math inline">\(0, 1, 2, \cdots,\)</span>. That is, we could (in theory, however unlikely), wait an “infinite” amount of time until the first success occurs. The population of a geometric random variable (although discrete) is infinite.</p>
<p>Sampling theory and statistical inference are applied to situations involving both finite and infinite populations. In many of the cases of finite populations, it is impractical to enumerate the items. In the case of an infinite population, it is <em>impossible</em> to enumerate the items. Thus, we are forced to sample from the population. That is, select through some mechanism, a subset of the elements of the population. If we select the elements in the sample in such a manner that each element in the sample is equally likely to have come from the population, then we have a random sample.</p>
<p>In essence, bootstrapping takes this notion one step further. In bootstrapping, we <strong>assume</strong> that some original random sample is <em>essentially</em> the population. That is, we assume that a random sample, if large enough, can act as the actual population. Thus, sampling from the sample is, in essence, sampling from the population. This sampling and resampling process can provide information about the properties of statistical quantities computed from the original sample. Bootstrapping assumes that if the original sample is representative of the true population, then statistics generated from samples of the original sample of the population provide observations of the <em>sampling</em> distribution.</p>
<p>Let’s formalize these concepts with some notation and an informal overview of some of the theory associated with bootstrapping. The interested reader should refer to <span class="citation">(<a href="#ref-efron-tibshirani-1986">Efron B. and Tibshirani 1986</a>)</span>, <span class="citation">(<a href="#ref-efron-tibshirani">B. Efron and Tibshirani 1994</a>)</span>, and <span class="citation">(<a href="#ref-davison-hinkley">Davison AC 1997</a>)</span> for more detailed treatments. This presentation follows somewhat the tutorial <span class="citation">(<a href="#ref-wehrens2000">Wehrens and Buydens 2000</a>)</span>. Let the cumulative distribution function of some random variable, <span class="math inline">\(X\)</span>, be denoted as <span class="math inline">\(F.\)</span> Let <span class="math inline">\(x_{1}, x_{2},\cdots,x_{n}\)</span> be a set of observed values of <span class="math inline">\(X\)</span> from <span class="math inline">\(F.\)</span> Suppose that there is some unknown parameter <span class="math inline">\(\theta\)</span> that represents a population parameter of interest. For example, <span class="math inline">\(\theta\)</span> might be the mean, median, correlation, etc. Suppose that <span class="math inline">\(\theta\)</span> can be expressed or computed by some function <span class="math inline">\(t(\cdot)\)</span> applied to the distribution function <span class="math inline">\(F\)</span>. That is, we can write <span class="math inline">\(\theta = t(F)\)</span>. For example, in the case of the population mean, <span class="math inline">\(E[X] =\theta\)</span>, <span class="math inline">\(t(\cdot)\)</span> is the expectation function such that <span class="math inline">\(\theta = \int xdF(x)\)</span>.</p>
<p>In general, because the underlying probabilistic description of the population may not be known, we usually do not know <span class="math inline">\(F\)</span>. However, we are able to sample (through some mechanism) observations <span class="math inline">\(\vec{x}=(x_{1}, x_{2},\cdots,x_{n})\)</span> from <span class="math inline">\(F\)</span> via the random variable <span class="math inline">\(X\)</span>. This sample represents the empirical distribution, <span class="math inline">\(F_n(x)\)</span>, of <span class="math inline">\(F\)</span>. That is, <span class="math inline">\(F_n(x)\)</span> is an estimate of <span class="math inline">\(F\)</span>.</p>
<p>We can either use <span class="math inline">\(F_n(x)\)</span> to estimate <span class="math inline">\(\theta\)</span> or use some function <span class="math inline">\(u(\cdot)\)</span> applied to the sample to estimate <span class="math inline">\(\theta\)</span>. That is, we can formulate an estimator, <span class="math inline">\(\hat{\theta} = t(F_n) = u(\vec{x})\)</span>. For example in the case of the population mean, <span class="math inline">\(E[X] =\theta\)</span>, <span class="math inline">\(u(\cdot)\)</span> is the sample mean, <span class="math inline">\(\bar{X}=\frac{1}{n}\sum_i^n X_i\)</span>. In bootstrapping, this equivalence is called the <em>plug-in principle</em>. As we will see, bootstrapping makes a more explicit use of the empirical distribution, <span class="math inline">\(F_n\)</span>.</p>
<p>Since we have that <span class="math inline">\((x_{1}, x_{2},\cdots,x_{n})\)</span> is a set of observed values of <span class="math inline">\(X\)</span> from <span class="math inline">\(F\)</span>, let’s define <span class="math inline">\(\vec{x}^{*}=(x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> as a set of observations from <span class="math inline">\(F_n\)</span>. That is, define <span class="math inline">\(X^{*}\)</span> to be a possible observation selected at random from <span class="math inline">\((x_{1}, x_{2},\cdots,x_{n})\)</span>. Thus, <span class="math inline">\(F_n(x) = P(X^{*}=x_i)= 1/n\)</span> for <span class="math inline">\(i=1,2,\cdots, n\)</span>. Let <span class="math inline">\(\vec{X}^{*}=(X^{*}_{1}, X^{*}_{2},\cdots,X^{*}_{n})\)</span> be a random sample of size <span class="math inline">\(n\)</span> from <span class="math inline">\(P(X^{*}=x_i)\)</span>. Then, the random variables <span class="math inline">\((X^{*}_{1}, X^{*}_{2},...X^{*}_{n})\)</span> are independent and uniformly distributed over the set <span class="math inline">\((x_{1}, x_{2},\cdots, x_{n})\)</span>. Notice that values within <span class="math inline">\((x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> may be repeated because the sampling is done with replacement (to ensure that they are uniformly likely). Note also that we can form as many samples <span class="math inline">\((x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> as we want by repeating the sampling procedure from <span class="math inline">\(F_n\)</span>.</p>
<p>The empirical distribution, <span class="math inline">\(F_n(x)\)</span>, is an estimator for <span class="math inline">\(F(x)\)</span> and it can be shown that <span class="math inline">\(F_n\)</span> is a sufficient statistic for <span class="math inline">\(F\)</span>. To summarize, <span class="math inline">\(F\)</span> yields random variables <span class="math inline">\(X\)</span> of which we have a sample, which yields <span class="math inline">\(F_n\)</span>. When we sample from <span class="math inline">\(F_n\)</span>, we get random variables <span class="math inline">\(X^{*}\)</span>. These samples from <span class="math inline">\(F_n\)</span> also have an empirical cumulative distribution function (ECDF). Let’s denote the ECDF of <span class="math inline">\(F_n\)</span> as <span class="math inline">\(F^{*}_n\)</span>. Thus, a statistic formed from <span class="math inline">\((x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> will be a <em>possible</em> statistic computed on <span class="math inline">\((X_{1}, X_{2},\cdots,X_{n})\)</span>. Since a statistic computed from <span class="math inline">\((x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> yields a <em>possible</em> statistic computed on <span class="math inline">\((X_{1}, X_{2},\cdots,X_{n})\)</span>, these are possible observations from the sampling distribution of the estimator. This allows for the estimation of some parameter <span class="math inline">\(\theta\)</span> of <span class="math inline">\(F(x)\)</span> and the variability of the estimator by resampling. This is the basis of the bootstrapping principle.</p>
<p>We call the samples <span class="math inline">\((x^{*}_{1}, x^{*}_{2},\cdots,x^{*}_{n})\)</span> bootstrap samples. Let <span class="math inline">\(x^{*(b)}\)</span> be the <span class="math inline">\(b^{th}\)</span> bootstrap sample from <span class="math inline">\(F_n(x)\)</span>, with <span class="math inline">\(b=1,2,\cdots,B\)</span>, where <span class="math inline">\(B\)</span> is the number of bootstrap samples. Let <span class="math inline">\(\hat{\theta}\)</span> be some estimator of <span class="math inline">\(\theta\)</span> and let <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span> be an observation of <span class="math inline">\(\hat{\theta}\)</span> based on the <span class="math inline">\(b^{th}\)</span> bootstrap sample, <span class="math inline">\(x^{*(b)}\)</span>. The quantities, <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span> for <span class="math inline">\(b=1,2,\cdots,B\)</span> are called the bootstrap replicates (of the estimator).</p>
<p>The bootstrap estimate of the sampling distribution of <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span>, <span class="math inline">\(F_{\hat{\theta}^{*}_{b}}(\cdot)\)</span> is the empirical distribution of <span class="math inline">\((\theta^{*}_{1}, \theta^{*}_{2},\cdots,\theta^{*}_{n})\)</span>. Thus, <span class="math inline">\(F_{\hat{\theta}^{*}_{b}}(\cdot)\)</span> provides information on the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span>. The quality of the information depends entirely on the quality of the original sample <span class="math inline">\((x_{1}, x_{2},\cdots,x_{n})\)</span> of <span class="math inline">\(X\)</span> from <span class="math inline">\(F\)</span>. Therefore, <span class="math inline">\(\hat{\theta}\)</span> is a statistic computed from the original sample, and <span class="math inline">\(\hat{\theta}^{*}\)</span> is a statistic computed from the resample. The bootstrap principle assumes that <span class="math inline">\(F^{*}\approx F\)</span> and the variation in <span class="math inline">\(\hat{\theta}\)</span> is well approximated by the variation in <span class="math inline">\(\hat{\theta}^{*}\)</span>.</p>
<p>If the bootstrap principle holds, then we can use the bootstrapping process to develop an estimate of the standard error of our estimator. We have an estimator, <span class="math inline">\(\hat{\theta}\)</span>. It has some variance, <span class="math inline">\(var(\hat{\theta})\)</span> and standard deviation, <span class="math inline">\(\sqrt{var(\hat{\theta})}\)</span>. This quantity is called the standard error of the estimator. That is, <span class="math inline">\(se(\hat{\theta}) = \sqrt{var(\hat{\theta})}\)</span>. The bootstrap estimator of the standard error of the estimator,<span class="math inline">\(\hat{\theta}\)</span>, is:</p>
<p><span class="math display">\[
\widehat{se(\hat{\theta})} = \sqrt{\frac{1}{B-1}\sum_{b=1}^{B}\big(\hat{\theta}^{*}_{b} - \bar{\hat{\theta^{*}}} \big)^2}
\]</span>
where the quantity, <span class="math inline">\(\bar{\hat{\theta^{*}}}\)</span>, is the average over the computed bootstrap estimates of the estimator:</p>
<p><span class="math display">\[
\bar{\hat{\theta^{*}}} =\frac{1}{B}\sum_{b=1}^{B}\hat{\theta}^{*}_{b}
\]</span></p>
<p>As you can see, the bootstrap estimator for the standard error of the estimator, <span class="math inline">\(\widehat{se(\hat{\theta})}\)</span>, is simply the sample standard deviation of the bootstrap replicates.</p>
<p>The bootstrapping process not only provides information about the standard error of the estimator, <span class="math inline">\(\hat{\theta}\)</span>, it can also provide information about the bias of the estimator. If <span class="math inline">\(\hat{\theta}\)</span> is an unbiased estimator of <span class="math inline">\(\theta\)</span> then <span class="math inline">\(E[\hat{\theta}] = \theta\)</span>. Thus, the bias of an estimator, <span class="math inline">\(\hat{\theta}\)</span>, for <span class="math inline">\(\theta\)</span> is:</p>
<p><span class="math display">\[
bias(\hat{\theta}) = E[\hat{\theta} - \theta] = E[\hat{\theta}] - \theta
\]</span>
To estimate the bias, the bootstep process uses the bootstrap replicates of <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span> to estimate the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span> to get:</p>
<p><span class="math display">\[
\widehat{bias}(\hat{\theta}) = \bar{\hat{\theta^{*}}} - \hat{\theta}
\]</span>
where <span class="math inline">\(\hat{\theta}\)</span> is the estimate of <span class="math inline">\(\theta\)</span> computed from the original sample,<span class="math inline">\((x_{1}, x_{2},.\cdots,x_{n})\)</span>. The bias and standard error of the estimator provide information about the accuracy and precision of the estimator. We can also provide confidence intervals for the estimator based on the bootstrapping process.</p>
<p>To derive confidence intervals from the bootstrapping process consider the probability distribution associated with <span class="math inline">\(\hat{\theta} - \theta\)</span>. Suppose <span class="math inline">\(\gamma_{\alpha}\)</span> denotes the <span class="math inline">\(\alpha\)</span>-percentile of the distribution of <span class="math inline">\(\hat{\theta} - \theta\)</span>, then a confidence interval for <span class="math inline">\(\theta\)</span> is based on the probability statement:</p>
<p><span class="math display">\[
P\Bigg( \gamma_{\alpha/2} \leq \hat{\theta} - \theta \leq \gamma_{1-\alpha/2}\Bigg) = 1-\alpha
\]</span>
After rewriting this statement, we have an interval of the form:</p>
<p><span class="math display">\[
\hat{\theta}-  \gamma_{1-\alpha/2} \leq \theta \leq \hat{\theta} - \gamma_{\alpha/2}
\]</span>
Within the bootstrap literature a number of approaches have been developed that provide <em>approximate</em> confidence intervals based on the previously noted form. These include:</p>
<ul>
<li>standard normal bootstrap confidence interval (SNBCI)</li>
<li>basic bootstrap confidence interval (BBCI)</li>
<li>bootstrap percentile confidence interval (BPCI)</li>
<li>bootstrap bias corrected and acceleration adjusted (BCa)</li>
<li>bootstrap-t confidence interval (BTCI), sometimes called the percentile-t confidence interval</li>
</ul>
<p>The standard normal bootstrap confidence interval is useful to consider first because of its simplicity; however, the quality of the confidence intervals can be poor unless its assumptions hold. Based on the central limit theorem, we know that if the estimator, <span class="math inline">\(\hat{\theta}\)</span>, is the sample average, then for large sample sizes, we have:</p>
<p><span class="math display">\[
Z = \frac{\hat{\theta}-E[\hat{\theta}]}{se(\hat{\theta})}
\]</span>
with <span class="math inline">\(Z\approx N(0,1)\)</span>. Therefore if <span class="math inline">\(\hat{\theta}\)</span> is unbiased, an approximate <span class="math inline">\(100\times(1-\alpha)\%\)</span> confidence interval will have the form:</p>
<p><span class="math display">\[
\hat{\theta}-  z_{1-\alpha/2} se(\hat{\theta}) \leq \theta \leq \hat{\theta} + z_{1-\alpha/2}se(\hat{\theta})
\]</span>
To apply bootstrapping to compute this interval, we simply estimate <span class="math inline">\(se(\hat{\theta})\)</span> with the bootstrap estimator of the standard error of the estimator, <span class="math inline">\(\widehat{se(\hat{\theta})}\)</span>.</p>
<p>The basic bootstrap confidence interval (BBCI), is also relatively simple. This confidence interval assumes that the distribution of <span class="math inline">\(\hat{\theta} - \theta\)</span> is <em>approximately</em> the same as <span class="math inline">\(\hat{\theta} - \theta^*\)</span>. Suppose that <span class="math inline">\(\hat{\theta}\)</span> is an estimator for <span class="math inline">\(\theta\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
1-\alpha &amp; \approx P\Bigg( \hat{\theta}^{*}_{\alpha/2} \leq \hat{\theta}^* \leq \hat{\theta}^{*}_{1-\alpha/2}\Bigg)\\
          &amp; = P\Bigg( \hat{\theta}^{*}_{\alpha/2} - \hat{\theta} \leq \hat{\theta}^{*} - \hat{\theta} \leq \hat{\theta}^{*}_{1-\alpha/2} - \hat{\theta}\Bigg)\\
          &amp; =  P\Bigg(  \hat{\theta} - \hat{\theta}^{*}_{\alpha/2}  \geq \hat{\theta} - \hat{\theta}^{*} \geq \hat{\theta} - \hat{\theta}^{*}_{1-\alpha/2} \Bigg)\\
          &amp; \approx P\Bigg(  \hat{\theta} - \hat{\theta}^{*}_{\alpha/2}  \geq \theta - \hat{\theta} \geq \hat{\theta}-\hat{\theta}^{*}_{1-\alpha/2} \Bigg)\\
          &amp; =  P\Bigg(  2\hat{\theta} - \hat{\theta}^{*}_{\alpha/2}  \geq \theta \geq 2\hat{\theta}-\hat{\theta}^{*}_{1-\alpha/2} \Bigg)\\
\end{aligned}
\]</span></p>
<p>Thus, we have the lower limit as <span class="math inline">\(L = 2\hat{\theta}-\hat{\theta}^{*}_{1-\alpha/2}\)</span> and the upper limit as <span class="math inline">\(U = 2\hat{\theta} - \hat{\theta}^{*}_{\alpha/2}\)</span>. We can estimate <span class="math inline">\(\hat{\theta}^{*}_{\alpha/2}\)</span> and <span class="math inline">\(\hat{\theta}^{*}_{1-\alpha/2}\)</span> by the percentiles of the bootstrap replicates distribution, which yields a final BBCI approximate <span class="math inline">\(100\times(1-\alpha)\%\)</span> confidence interval as:</p>
<p><span class="math display">\[
2\hat{\theta}-  \hat{\theta}^{*}_{1-\alpha/2} \leq \theta \leq 2\hat{\theta} -\hat{\theta}^{*}_{\alpha/2}
\]</span>
where <span class="math inline">\(\theta^{*}_{p}\)</span> is the <span class="math inline">\(p^{th}\)</span> sample quantile from the empirical distribution of the bootstrap replicates.</p>
<p>The percentile bootstrap confidence interval (PBCI) uses the empirical distribution of the bootstrap replicates to estimate the quantiles for the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span>. Suppose <span class="math inline">\((\theta^{*}_{1}, \theta^{*}_{2},\cdots,\theta^{*}_{n})\)</span> are the bootstrap replicates of <span class="math inline">\(\hat{\theta}\)</span>. From the empirical distribution of <span class="math inline">\((\theta^{*}_{1}, \theta^{*}_{2},\cdots,\theta^{*}_{n})\)</span> compute the <span class="math inline">\(\alpha/2\)</span> quantile, say <span class="math inline">\(\theta^{*}_{\alpha/2}\)</span> and the <span class="math inline">\(1-\alpha/2\)</span> quantile, <span class="math inline">\(\theta^{*}_{1-\alpha/2}\)</span>. Then, approximate <span class="math inline">\(100\times(1-\alpha)\%\)</span> PBCI confidence interval is:</p>
<p><span class="math display">\[
(\hat{\theta}^{*}_{1-\alpha/2}, \, \hat{\theta}^{*}_{\alpha/2})
\]</span></p>
<p>The bootstrap bias corrected and acceleration adjusted (BCa) interval modifies the percentile bootstrap confidence interval by correcting for bias and adjusting for possible skewness in the sampling distribution of the estimator. The theory and quality of this confidence interval is discussed in <span class="citation">(<a href="#ref-efron-tibshirani">B. Efron and Tibshirani 1994</a>)</span>. An approximate <span class="math inline">\(100\times(1-\alpha)\%\)</span> BCa confidence interval is <span class="math inline">\((\hat{\theta}^{*}_{\alpha_1}, \, \hat{\theta}^{*}_{\alpha_2})\)</span> where <span class="math inline">\(\alpha_1\)</span> and <span class="math inline">\(\alpha_2\)</span> are defined as follows:</p>
<p><span class="math display">\[
\alpha_1 = \Phi\bigg( \hat{z}_0 + \frac{\hat{z}_0 + z_{\alpha/2}}{1-\hat{a}(\hat{z}_0 + z_{\alpha/2})}\bigg)
\]</span></p>
<p><span class="math display">\[
\alpha_2 = \Phi\bigg( \hat{z}_0 + \frac{\hat{z}_0 + z_{1-\alpha/2}}{1-\hat{a}(\hat{z}_0 + z_{1-\alpha/2})}\bigg)
\]</span></p>
<p>where <span class="math inline">\(z_p = \Phi^{-1}(p)\)</span>. The bias correction factor, <span class="math inline">\(z_0\)</span>, is given as follows.</p>
<p><span class="math display">\[
z_0 =  \Phi^{-1}\bigg( \frac{1}{B}\sum_{b=1}^{B}I(\hat{\theta}^{*}_{b} &lt; \hat{\theta})\bigg)
\]</span></p>
<p>where <span class="math inline">\(I(\cdot)\)</span> is an indicator function. The acceleration adjustment factor, <span class="math inline">\(\hat{a}\)</span>, is given as follows.</p>
<p><span class="math display">\[
\hat{a} = \frac{\sum_{i=1}^{n}\big( \bar{\theta}_{(\cdot)} - \theta_{(i)} \big)^3}{6\sum_{i=1}^{n}\bigg(\big( \bar{\theta}_{(\cdot)} - \theta_{(i)} \big)^2\bigg)^{3/2}}
\]</span>
The quantity <span class="math inline">\(\bar{\theta}_{(\cdot)}\)</span> is the mean of the estimates of the leave one out jackknife samples, with:</p>
<p><span class="math display">\[
\bar{\theta}_{(\cdot)} = \frac{1}{n}\sum_{i=1}^{n}\hat{\theta}_{(i)}
\]</span></p>
<p>and <span class="math inline">\(\hat{\theta}_{(i)}\)</span> is the <span class="math inline">\(i^{th}\)</span> jackknife replicate. The jackknife replicates, <span class="math inline">\(\hat{\theta}_{(i)}\)</span> for <span class="math inline">\(i=1,2,\cdots,n\)</span> are computed by applying the estimator, <span class="math inline">\(\hat{\theta} = T_n(x)\)</span> on the jackknife samples. A jackknife sample, <span class="math inline">\(\vec{x}_{(i)}\)</span>, is a subset of <span class="math inline">\((x_{1}, x_{2},\cdots, x_{n})\)</span> that leaves out the <span class="math inline">\(i^{th}\)</span> observation such that:</p>
<p><span class="math display">\[
\vec{x}_{(i)} =(x_{1}, \cdots,x_{i-1},x_{i+1},\cdots, x_{n})
\]</span>
Thus, <span class="math inline">\(\hat{\theta}_{(i)} = T_{n-1}(\vec{x}_{(i)})\)</span> for <span class="math inline">\(i=1,2,\cdots,n\)</span>. Jackknifing is another form of resampling that is often applied to reduce the bias in an estimator. We will not discuss the theory of jackknifing in this text, but we will point out that the KSL has support for the approach.</p>
<p>The bootstrap-t (BTCI) provides an approximate confidence interval by considering the distribution of</p>
<p><span class="math display">\[
\frac{\hat{\theta}-\theta}{se(\hat{\theta})}
\]</span></p>
<p>As we know from basic statistical theory, if <span class="math inline">\(\hat{\theta}\)</span>, is the sample average and the <span class="math inline">\(se(\hat{\theta})\)</span> is estimated by the sample error when the observations are IID normal, then this ratio should have a student-t distribution. In the PTCI approach, does not assume a student-t distribution, but rather uses the bootstrap observations of:</p>
<p><span class="math display">\[
t^{*}_{b} = \frac{\hat{\theta}^{*}_{b}-\hat{\theta}}{\widehat{se}(\hat{\theta}^{*}_{b})}
\]</span></p>
<p>Notice that <span class="math inline">\(\widehat{se}(\hat{\theta}^{*}_{b})\)</span> is the standard error of the <span class="math inline">\(b^{th}\)</span> <em>bootstrap sample</em> and that it may not have a closed form. If <span class="math inline">\(\hat{\theta}\)</span>, is the sample average, then we can use the sample standard error of the <span class="math inline">\(b^{th}\)</span> bootstrap sample, <span class="math inline">\(\vec{x}^{*}_{b} = (x^{*}_{1}, x^{*}_{2},...x^{*}_{n})\)</span>.</p>
<p>In general for this approach, the reference distribution is formed from resamples from the bootstrap sample. As usual, suppose that <span class="math inline">\((x_{1}, x_{2},...x_{n})\)</span> is the original sample. Then, the <span class="math inline">\(100 \times (1-\alpha)\%\)</span> bootstrap t-interval is:</p>
<p><span class="math display">\[
\big( \hat{\theta} - t^{*}_{1-\alpha/2 }\widehat{se}(\hat{\theta}^{*}), \hat{\theta} - t^{*}_{\alpha/2 }\widehat{se}(\hat{\theta}^{*})\big)
\]</span></p>
<p>We compute <span class="math inline">\(\widehat{se}(\hat{\theta}^{*})\)</span>, <span class="math inline">\(t^{*}_{\alpha/2 }\)</span>, and <span class="math inline">\(t^{*}_{1-\alpha/2 }\)</span> as follows:</p>
<ol style="list-style-type: decimal">
<li>Compute <span class="math inline">\(\hat{\theta}\)</span> from <span class="math inline">\(\vec{x}=(x_{1}, x_{2},...x_{n})\)</span></li>
<li>For <span class="math inline">\(b = 1 \; \text{to} \;  B\)</span></li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>Sample from <span class="math inline">\(\vec{x}^{*}_{b}\)</span> with replacement from <span class="math inline">\(\vec{x}\)</span>.</li>
<li>Compute <span class="math inline">\(\theta^{*}_{b}\)</span> from <span class="math inline">\(\vec{x}^{*}_{b}\)</span>.</li>
<li>Estimate the standard error <span class="math inline">\(\widehat{se}(\hat{\theta}^{*}_b)\)</span> from sampling from <span class="math inline">\(\vec{x}^{*}_{b}\)</span>. In the case of <span class="math inline">\(\hat{\theta}\)</span> being the mean, then the standard error of the bootstrap sample can be directly computed, without sampling.</li>
<li>Compute
<span class="math display">\[
  t^{*}_b = \frac{\theta^{*}_{b}-\hat{\theta}}{\widehat{se}(\hat{\theta}^{*}_b)}
  \]</span></li>
</ol>
<ol start="3" style="list-style-type: decimal">
<li>The sample <span class="math inline">\((t^{*}_1, t^{*}_2, \cdots, t^{*}_B)\)</span> is the reference distribution for the bootstrap t-statistic. From these observations, find <span class="math inline">\(t^{*}_{\alpha/2 }\)</span>, and <span class="math inline">\(t^{*}_{1-\alpha/2 }\)</span>.</li>
<li>Compute <span class="math inline">\(\widehat{se}(\hat{\theta}^{*})\)</span> as the sample standard deviation of the <span class="math inline">\(\theta^{*}_{b}\)</span> for <span class="math inline">\(b=1,2,\cdots, B\)</span></li>
<li>Compute the confidence intervals</li>
</ol>
<p><span class="math display">\[
\big( \hat{\theta} - t^{*}_{1-\alpha/2 }\widehat{se}(\hat{\theta}^{*}), \hat{\theta} - t^{*}_{\alpha/2 }\widehat{se}(\hat{\theta}^{*})\big)
\]</span></p>
<p><span class="citation">(<a href="#ref-efron-tibshirani-1986">Efron B. and Tibshirani 1986</a>)</span> discuss many of the characteristics of the different bootstrap confidence intervals. Of the five presented here, the bootstrap percentile confidence interval is often utilized; however, because the BCa essentially corrects for bias and skewness issues for the BPCI, we would recommend utilizing the BCa. The next recommended confidence interval would be the bootstrap-t; however, because it often requires an extra bootstrapping step to estimate <span class="math inline">\(\widehat{se}(\hat{\theta}^{*}_b)\)</span> it can require a substantial amount of extra computation. Thus, the bootstrap-t has not found wide acceptance in practice, except in the case of when the estimator is the sample average.</p>
<div id="bootstrapping-using-the-ksl" class="section level3 hasAnchor" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Bootstrapping Using the KSL<a href="ch9BootStrapping.html#bootstrapping-using-the-ksl" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will explore how the KSL supports the application of bootstrapping. First, we will illustrate how to do bootstrapping using basic KSL constructs. This is intended to illustrate the overall bootstrapping process. Then we will discuss KSL constructs that encapsulate the bootstrapping process within classes. In essence, bootstrapping is just sampling again and again from some discrete population. Thus, the KSL <code>DPopulation</code> class can serve as a starting point. Alternatively, the KSL <code>EmpiricalRV</code> class can be used. Let’s start with a simple example that has an original sample size of 10 elements. For example, assume through some sampling process we have selected 10 students (at random) and counted the number of books in their backpack. The following code illustrates placing the data in an array and computing some basic statistics related to the sample.</p>
<div class="example">
<p><span id="exm:exBS1" class="example"><strong>Example 8.1  (Bootstraping Example 1) </strong></span>This example defines a population of values within an array. Then, the example uses the <code>DPopulation</code> class to sample from the population. Statistics on the samples are captured and used to form a confidence interval.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb294-1"><a href="ch9BootStrapping.html#cb294-1" tabindex="-1"></a><span class="co">// make a population for illustrating bootstrapping</span></span>
<span id="cb294-2"><a href="ch9BootStrapping.html#cb294-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">mainSample</span> <span class="op">=</span> doubleArrayOf<span class="op">(</span><span class="fl">6.0</span><span class="op">,</span> <span class="fl">7.0</span><span class="op">,</span> <span class="fl">5.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">4.0</span><span class="op">,</span> <span class="fl">6.0</span><span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">6.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb294-3"><a href="ch9BootStrapping.html#cb294-3" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;Sample of size 10 from original population&quot;</span><span class="op">)</span></span>
<span id="cb294-4"><a href="ch9BootStrapping.html#cb294-4" tabindex="-1"></a>println<span class="op">(</span>mainSample<span class="op">.</span>joinToString<span class="op">())</span></span>
<span id="cb294-5"><a href="ch9BootStrapping.html#cb294-5" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb294-6"><a href="ch9BootStrapping.html#cb294-6" tabindex="-1"></a><span class="co">// compute statistics on main sample</span></span>
<span id="cb294-7"><a href="ch9BootStrapping.html#cb294-7" tabindex="-1"></a><span class="kw">val</span> <span class="va">mainSampleStats</span> <span class="op">=</span> Statistic<span class="op">(</span>mainSample<span class="op">)</span></span>
<span id="cb294-8"><a href="ch9BootStrapping.html#cb294-8" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;Main Sample&quot;</span><span class="op">)</span></span>
<span id="cb294-9"><a href="ch9BootStrapping.html#cb294-9" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;average = </span><span class="ss">${</span>mainSampleStats<span class="op">.</span>average<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb294-10"><a href="ch9BootStrapping.html#cb294-10" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;90% CI = </span><span class="ss">${</span>mainSampleStats<span class="op">.</span>confidenceInterval<span class="op">(</span><span class="fl">.90</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb294-11"><a href="ch9BootStrapping.html#cb294-11" tabindex="-1"></a>println<span class="op">()</span></span></code></pre></div>
</div>
<p>Running this code results in the following:</p>
<pre><code>Sample of size 10 from original population
6.0, 7.0, 5.0, 1.0, 0.0, 4.0, 6.0, 0.0, 6.0, 1.0

Main Sample
average = 3.599999999999999
90% CI = [1.978733917471777, 5.221266082528222]</code></pre>
<p>In the notation that we have been using <span class="math inline">\(\bar{x} = \hat{\theta} = 3.5\bar{9}\)</span>. The sample size is small and it is very unlikely that the distribution of the number books in a student’s backpack would be normally distributed. Therefore, the reported confidence interval is certainly approximate. The KSL <code>Statistic</code> class reports its confidence interval assuming a Student-T distribution. We would like to use bootstrapping to produce a confidence interval. We can get started by treating our original sample as if it is the population and sampling from it. Here is some KSL code to illustrate this process.</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb296-1"><a href="ch9BootStrapping.html#cb296-1" tabindex="-1"></a><span class="co">// make the sample our pseudo-population</span></span>
<span id="cb296-2"><a href="ch9BootStrapping.html#cb296-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">samplePopulation</span> <span class="op">=</span> DPopulation<span class="op">(</span>mainSample<span class="op">)</span></span>
<span id="cb296-3"><a href="ch9BootStrapping.html#cb296-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">bootStrapAverages</span> <span class="op">=</span> mutableListOf<span class="op">&lt;</span><span class="kw">Double</span><span class="op">&gt;()</span></span>
<span id="cb296-4"><a href="ch9BootStrapping.html#cb296-4" tabindex="-1"></a><span class="co">// illustrate 10 bootstrap samples</span></span>
<span id="cb296-5"><a href="ch9BootStrapping.html#cb296-5" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;BootStrap Samples:&quot;</span><span class="op">)</span></span>
<span id="cb296-6"><a href="ch9BootStrapping.html#cb296-6" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>i <span class="kw">in</span> <span class="fl">1..10</span><span class="op">){</span></span>
<span id="cb296-7"><a href="ch9BootStrapping.html#cb296-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">bootStrapSample</span> <span class="op">=</span> samplePopulation<span class="op">.</span>sample<span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb296-8"><a href="ch9BootStrapping.html#cb296-8" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">avg</span> <span class="op">=</span> bootStrapSample<span class="op">.</span>average<span class="op">()</span></span>
<span id="cb296-9"><a href="ch9BootStrapping.html#cb296-9" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;sample_</span><span class="ss">$i</span><span class="st">  = (</span><span class="ss">${</span>bootStrapSample<span class="op">.</span>joinToString<span class="op">()</span><span class="ss">}</span><span class="st">) with average = </span><span class="ss">$avg</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb296-10"><a href="ch9BootStrapping.html#cb296-10" tabindex="-1"></a>   bootStrapAverages<span class="op">.</span>add<span class="op">(</span>avg<span class="op">)</span></span>
<span id="cb296-11"><a href="ch9BootStrapping.html#cb296-11" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb296-12"><a href="ch9BootStrapping.html#cb296-12" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb296-13"><a href="ch9BootStrapping.html#cb296-13" tabindex="-1"></a><span class="kw">val</span> <span class="va">lcl</span> <span class="op">=</span> Statistic<span class="op">.</span>percentile<span class="op">(</span>bootStrapAverages<span class="op">.</span>toDoubleArray<span class="op">(),</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span id="cb296-14"><a href="ch9BootStrapping.html#cb296-14" tabindex="-1"></a><span class="kw">val</span> <span class="va">ucl</span> <span class="op">=</span> Statistic<span class="op">.</span>percentile<span class="op">(</span>bootStrapAverages<span class="op">.</span>toDoubleArray<span class="op">(),</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span id="cb296-15"><a href="ch9BootStrapping.html#cb296-15" tabindex="-1"></a><span class="kw">val</span> <span class="va">ci</span> <span class="op">=</span> Interval<span class="op">(</span>lcl<span class="op">,</span> ucl<span class="op">)</span></span>
<span id="cb296-16"><a href="ch9BootStrapping.html#cb296-16" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;Percentile based 90% ci = </span><span class="ss">$ci</span><span class="st">&quot;</span><span class="op">)</span></span></code></pre></div>
<p>In this code, we first create an instance of <code>DPopulation</code> using the array of observations of the book count data. Then, a list is created to hold the averages of each bootstrap sample. The loop creates 10 bootstrap samples and captures the average of each sample. Notice that the <code>DPopulation</code> is used to sample <em>with replacement</em> a sample of size 10. It is important that the sample size, 10, be the same as the size of the original sample because our confidence statements are about the original sample (with size 10). Given the bootstrap averages are captured in a list, <code>bootStrapAverages,</code> we can then use the percentile method to get the lower and upper limits for the confidence interval based on the bootstrap reference distribution.</p>
<pre><code>BootStrap Samples:
sample_1  = (0.0, 1.0, 1.0, 7.0, 1.0, 1.0, 1.0, 0.0, 1.0, 1.0) with average = 1.4
sample_2  = (5.0, 1.0, 1.0, 6.0, 4.0, 7.0, 0.0, 1.0, 5.0, 6.0) with average = 3.6
sample_3  = (0.0, 5.0, 4.0, 6.0, 1.0, 4.0, 7.0, 0.0, 1.0, 6.0) with average = 3.4
sample_4  = (6.0, 5.0, 0.0, 1.0, 6.0, 6.0, 6.0, 1.0, 6.0, 1.0) with average = 3.8
sample_5  = (5.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 6.0, 6.0, 6.0) with average = 2.5
sample_6  = (4.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0) with average = 2.0
sample_7  = (5.0, 6.0, 1.0, 6.0, 0.0, 6.0, 6.0, 1.0, 5.0, 7.0) with average = 4.3
sample_8  = (7.0, 6.0, 4.0, 1.0, 1.0, 1.0, 6.0, 1.0, 7.0, 6.0) with average = 4.0
sample_9  = (0.0, 6.0, 1.0, 6.0, 6.0, 5.0, 7.0, 4.0, 1.0, 1.0) with average = 3.7
sample_10  = (5.0, 6.0, 7.0, 0.0, 6.0, 6.0, 5.0, 0.0, 1.0, 0.0) with average = 3.6

Bootstrap sample averages
1.4, 3.6, 3.4, 3.8, 2.5, 2.0, 4.3, 4.0, 3.7, 3.6

Percentile based 90% ci = [1.4, 4.3]</code></pre>
<p>The results show 10 bootstrap samples. Notice that due to sampling with replacement, we can have values in the bootstrap samples that repeat and that it is clearly possible that some observations within the original sample, do not appear in the bootstrap samples. It is important to note that this bootstrap confidence interval is for our original estimate, <span class="math inline">\(\bar{x} = \hat{\theta} = 3.5\bar{9}\)</span>. The bootstrap sample averages, <span class="math inline">\((1.4, 3.6, 3.4, 3.8, 2.5, 2.0, 4.3, 4.0, 3.7, 3.6)\)</span> represent the bootstrap estimate of the sampling distribution of <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span>, <span class="math inline">\(F_{\hat{\theta}^{*}_{b}}(\cdot)\)</span>, which we are using as an approximation for the sampling distribution of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p>The idea of repeatedly sampling from a given population has been implemented into a set of classes within the KSL that will perform the bootstrapping process and compute a variety of quantities (including confidence intervals) based on the bootstrap samples. Figure <a href="ch9BootStrapping.html#fig:BootstrapFig">8.1</a> presents the <code>BootstrapEstimateIfc</code> interface, the main implementation of this interface (<code>Bootstrap</code>), and a data class, <code>BootstrapEstimate,</code> that is useful when building approaches that require bootstrapping.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:BootstrapFig"></span>
<img src="figures2/ch9/Bootstrap.png" alt="KSL Bootstrap Classes" width="90%" height="90%" />
<p class="caption">
Figure 8.1: KSL Bootstrap Classes
</p>
</div>
<p>The <code>Bootstrap</code> class requires an array of doubles that represents the original data from which resampling will occur. While implementing the <code>BootstrapEstimateIfc</code> interface, the <code>Bootstrap</code> class also implements the <code>RNStreamControlIfc,</code> and <code>RNStreamChangeIfc</code> interfaces, which allow for the control of the underlying random numbers used within the sampling. It is useful to review the constructor of the <code>Bootstrap</code> class.</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb298-1"><a href="ch9BootStrapping.html#cb298-1" tabindex="-1"></a><span class="kw">open</span> <span class="kw">class</span> Bootstrap<span class="op">(</span></span>
<span id="cb298-2"><a href="ch9BootStrapping.html#cb298-2" tabindex="-1"></a>    <span class="va">originalData</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">,</span></span>
<span id="cb298-3"><a href="ch9BootStrapping.html#cb298-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">estimator</span><span class="op">:</span> <span class="dt">BSEstimatorIfc</span> <span class="op">=</span> BSEstimatorIfc<span class="op">.</span>Average<span class="op">(),</span></span>
<span id="cb298-4"><a href="ch9BootStrapping.html#cb298-4" tabindex="-1"></a>    <span class="va">stream</span><span class="op">:</span> <span class="dt">RNStreamIfc</span> <span class="op">=</span> KSLRandom<span class="op">.</span>nextRNStream<span class="op">(),</span></span>
<span id="cb298-5"><a href="ch9BootStrapping.html#cb298-5" tabindex="-1"></a>    <span class="va">name</span><span class="op">:</span> <span class="dt">String</span><span class="op">?</span> <span class="op">=</span> null</span>
<span id="cb298-6"><a href="ch9BootStrapping.html#cb298-6" tabindex="-1"></a><span class="op">)</span> <span class="op">:</span> <span class="dt">IdentityIfc</span> <span class="kw">by</span> Identity<span class="op">(</span>name<span class="op">),</span> RNStreamControlIfc<span class="op">,</span> RNStreamChangeIfc<span class="op">,</span> BootstrapEstimateIfc</span></code></pre></div>
<p>As noted in the constructor, the class requires an array holding the original data, an instance of the <code>BSEstimatorIfc</code> interface, the stream for the random sampling and an optional name. The <code>BSEstimatorIfc</code> interface is a functional interface with an <code>estimate()</code> function. Thus, this implementation assumes that the estimate can be computed from a uni-variate array of data and produces a single estimated quantity. The KSL also supports multiple estimated quantities from a uni-variate array of data.</p>
<p>As can be noted from the default parameter for the estimator, the <code>BSEstimatorIfc</code> interface provides some basic statistical estimators (average, variance, median, minimum, maximum). Of course, the user should be able to implement others as needed.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb299-1"><a href="ch9BootStrapping.html#cb299-1" tabindex="-1"></a><span class="kw">fun</span> <span class="kw">interface</span> <span class="fu">BSEstimatorIfc</span> <span class="op">{</span></span>
<span id="cb299-2"><a href="ch9BootStrapping.html#cb299-2" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">estimate</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">):</span> <span class="dt">Double</span></span>
<span id="cb299-3"><a href="ch9BootStrapping.html#cb299-3" tabindex="-1"></a>}</span></code></pre></div>
<p>According to Figure <a href="ch9BootStrapping.html#fig:BootstrapFig">8.1</a>, the <code>Bootstrap</code> class also will compute the following:</p>
<ul>
<li>the bootstrap replicates, <span class="math inline">\(\hat{\theta}^{*}_{b}\)</span></li>
<li>the bootstrap differences, <span class="math inline">\(\hat{\theta}^{*}_{b} - \hat{\theta}\)</span></li>
<li>across bootstrap statistics, statistics on the replicates</li>
<li>statistics for each bootstrap sample</li>
<li>boot strap bias estimate</li>
<li>boot strap standard error estimate</li>
<li>normal bootstrap confidence interval</li>
<li>basic bootstrap confidence interval</li>
<li>percentile bootstrap confidence interval</li>
<li>BCa bootstrap confidence interval</li>
<li>bootstrap-t confidence interval</li>
</ul>
<p>Once constructing an instance of the <code>Bootstrap</code> class is complete, you can call the <code>generateSamples()</code> function. The following code shows the <code>generateSamples()</code> function. The function requires the number of bootstrap samples to generate, and optionally, you can have the bootstrap samples saved, and indicate if the bootstrap-t samples are required.</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb300-1"><a href="ch9BootStrapping.html#cb300-1" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">generateSamples</span><span class="op">(</span><span class="va">numBootstrapSamples</span><span class="op">:</span> <span class="dt">Int</span><span class="op">,</span> <span class="va">saveBootstrapSamples</span><span class="op">:</span> <span class="dt">Boolean</span> <span class="op">=</span> false<span class="op">,</span></span>
<span id="cb300-2"><a href="ch9BootStrapping.html#cb300-2" tabindex="-1"></a>        <span class="va">numBootstrapTSamples</span><span class="op">:</span> <span class="dt">Int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb300-3"><a href="ch9BootStrapping.html#cb300-3" tabindex="-1"></a>    <span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-4"><a href="ch9BootStrapping.html#cb300-4" tabindex="-1"></a>        require<span class="op">(</span>numBootstrapSamples <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="st">&quot;The number of bootstrap samples must be greater than 1&quot;</span> <span class="op">}</span></span>
<span id="cb300-5"><a href="ch9BootStrapping.html#cb300-5" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>numBootstrapTSamples <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-6"><a href="ch9BootStrapping.html#cb300-6" tabindex="-1"></a>            require<span class="op">(</span>numBootstrapTSamples <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="st">&quot;The number of bootstrap-t samples must be greater than 1&quot;</span> <span class="op">}</span></span>
<span id="cb300-7"><a href="ch9BootStrapping.html#cb300-7" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb300-8"><a href="ch9BootStrapping.html#cb300-8" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span>numBootstrapSamples <span class="op">=</span> numBootstrapSamples</span>
<span id="cb300-9"><a href="ch9BootStrapping.html#cb300-9" tabindex="-1"></a>        myAcrossBSStat<span class="op">.</span>reset<span class="op">()</span></span>
<span id="cb300-10"><a href="ch9BootStrapping.html#cb300-10" tabindex="-1"></a>        myBSEstimates<span class="op">.</span>clearData<span class="op">()</span></span>
<span id="cb300-11"><a href="ch9BootStrapping.html#cb300-11" tabindex="-1"></a>        myStudentizedTValues<span class="op">.</span>clearData<span class="op">()</span></span>
<span id="cb300-12"><a href="ch9BootStrapping.html#cb300-12" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>s <span class="kw">in</span> myBSArrayList<span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-13"><a href="ch9BootStrapping.html#cb300-13" tabindex="-1"></a>            s<span class="op">.</span>clearData<span class="op">()</span></span>
<span id="cb300-14"><a href="ch9BootStrapping.html#cb300-14" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb300-15"><a href="ch9BootStrapping.html#cb300-15" tabindex="-1"></a>        myBSArrayList<span class="op">.</span>clear<span class="op">()</span></span>
<span id="cb300-16"><a href="ch9BootStrapping.html#cb300-16" tabindex="-1"></a>        originalDataEstimate <span class="op">=</span> estimator<span class="op">.</span>estimate<span class="op">(</span>myOriginalData<span class="op">)</span></span>
<span id="cb300-17"><a href="ch9BootStrapping.html#cb300-17" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>i <span class="kw">in</span> <span class="dv">0</span> until numBootstrapSamples<span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-18"><a href="ch9BootStrapping.html#cb300-18" tabindex="-1"></a>            <span class="kw">val</span> <span class="va">sample</span><span class="op">:</span> DoubleArray <span class="op">=</span> myOriginalPop<span class="op">.</span>sample<span class="op">(</span>myOriginalPop<span class="op">.</span>size<span class="op">())</span></span>
<span id="cb300-19"><a href="ch9BootStrapping.html#cb300-19" tabindex="-1"></a>            <span class="kw">val</span> <span class="va">x</span> <span class="op">=</span> estimator<span class="op">.</span>estimate<span class="op">(</span>sample<span class="op">)</span></span>
<span id="cb300-20"><a href="ch9BootStrapping.html#cb300-20" tabindex="-1"></a>            myAcrossBSStat<span class="op">.</span>collect<span class="op">(</span>x<span class="op">)</span></span>
<span id="cb300-21"><a href="ch9BootStrapping.html#cb300-21" tabindex="-1"></a>            myBSEstimates<span class="op">.</span>save<span class="op">(</span>x<span class="op">)</span></span>
<span id="cb300-22"><a href="ch9BootStrapping.html#cb300-22" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>saveBootstrapSamples<span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-23"><a href="ch9BootStrapping.html#cb300-23" tabindex="-1"></a>                <span class="kw">val</span> <span class="va">das</span> <span class="op">=</span> DoubleArraySaver<span class="op">()</span></span>
<span id="cb300-24"><a href="ch9BootStrapping.html#cb300-24" tabindex="-1"></a>                das<span class="op">.</span>save<span class="op">(</span>sample<span class="op">)</span></span>
<span id="cb300-25"><a href="ch9BootStrapping.html#cb300-25" tabindex="-1"></a>                myBSArrayList<span class="op">.</span>add<span class="op">(</span>das<span class="op">)</span></span>
<span id="cb300-26"><a href="ch9BootStrapping.html#cb300-26" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb300-27"><a href="ch9BootStrapping.html#cb300-27" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>numBootstrapTSamples <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb300-28"><a href="ch9BootStrapping.html#cb300-28" tabindex="-1"></a>                bootstrapTSampling<span class="op">(</span>numBootstrapTSamples<span class="op">,</span> x<span class="op">,</span> sample<span class="op">)</span></span>
<span id="cb300-29"><a href="ch9BootStrapping.html#cb300-29" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb300-30"><a href="ch9BootStrapping.html#cb300-30" tabindex="-1"></a>            innerBoot<span class="op">(</span>x<span class="op">,</span> sample<span class="op">)</span></span>
<span id="cb300-31"><a href="ch9BootStrapping.html#cb300-31" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb300-32"><a href="ch9BootStrapping.html#cb300-32" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>This code is rather straightforward, having a loop to implement the sampling. In essence, it is not much different conceptually than the previously code using the <code>DPopulation</code> class.</p>
<div class="example">
<p><span id="exm:exBS2" class="example"><strong>Example 8.2  (Bootstraping Example 2) </strong></span>To setup and run bootstrapping using the <code>Bootstrap</code> class, we have the following code:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb301-1"><a href="ch9BootStrapping.html#cb301-1" tabindex="-1"></a>    <span class="co">// make a population for illustrating bootstrapping</span></span>
<span id="cb301-2"><a href="ch9BootStrapping.html#cb301-2" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">mainSample</span> <span class="op">=</span> doubleArrayOf<span class="op">(</span><span class="fl">6.0</span><span class="op">,</span> <span class="fl">7.0</span><span class="op">,</span> <span class="fl">5.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">4.0</span><span class="op">,</span> <span class="fl">6.0</span><span class="op">,</span> <span class="fl">0.0</span><span class="op">,</span> <span class="fl">6.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb301-3"><a href="ch9BootStrapping.html#cb301-3" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Sample of size 10 from original population&quot;</span><span class="op">)</span></span>
<span id="cb301-4"><a href="ch9BootStrapping.html#cb301-4" tabindex="-1"></a>    println<span class="op">(</span>mainSample<span class="op">.</span>joinToString<span class="op">())</span></span>
<span id="cb301-5"><a href="ch9BootStrapping.html#cb301-5" tabindex="-1"></a>    println<span class="op">()</span></span>
<span id="cb301-6"><a href="ch9BootStrapping.html#cb301-6" tabindex="-1"></a>    <span class="co">// compute statistics on main sample</span></span>
<span id="cb301-7"><a href="ch9BootStrapping.html#cb301-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">mainSampleStats</span> <span class="op">=</span> Statistic<span class="op">(</span>mainSample<span class="op">)</span></span>
<span id="cb301-8"><a href="ch9BootStrapping.html#cb301-8" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;Main Sample&quot;</span><span class="op">)</span></span>
<span id="cb301-9"><a href="ch9BootStrapping.html#cb301-9" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;average = </span><span class="ss">${</span>mainSampleStats<span class="op">.</span>average<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb301-10"><a href="ch9BootStrapping.html#cb301-10" tabindex="-1"></a>    println<span class="op">(</span><span class="st">&quot;90% CI = </span><span class="ss">${</span>mainSampleStats<span class="op">.</span>confidenceInterval<span class="op">(</span><span class="fl">.90</span><span class="op">)</span><span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb301-11"><a href="ch9BootStrapping.html#cb301-11" tabindex="-1"></a>    println<span class="op">()</span></span>
<span id="cb301-12"><a href="ch9BootStrapping.html#cb301-12" tabindex="-1"></a>    <span class="co">// now to the bootstrapping</span></span>
<span id="cb301-13"><a href="ch9BootStrapping.html#cb301-13" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">bs</span> <span class="op">=</span> Bootstrap<span class="op">(</span>mainSample<span class="op">,</span> estimator <span class="op">=</span> BSEstimatorIfc<span class="op">.</span>Average<span class="op">(),</span> KSLRandom<span class="op">.</span>rnStream<span class="op">(</span><span class="dv">3</span><span class="op">))</span></span>
<span id="cb301-14"><a href="ch9BootStrapping.html#cb301-14" tabindex="-1"></a>    bs<span class="op">.</span>generateSamples<span class="op">(</span><span class="dv">400</span><span class="op">,</span> numBootstrapTSamples <span class="op">=</span> <span class="dv">399</span><span class="op">)</span></span>
<span id="cb301-15"><a href="ch9BootStrapping.html#cb301-15" tabindex="-1"></a>    println<span class="op">(</span>bs<span class="op">)</span></span></code></pre></div>
</div>
<p>Running this code results in the following:</p>
<pre><code>Sample of size 10 from original population
6.0, 7.0, 5.0, 1.0, 0.0, 4.0, 6.0, 0.0, 6.0, 1.0

Main Sample
average = 3.5999999999999996
90% CI = [1.978733917471777, 5.221266082528222]

------------------------------------------------------
Bootstrap statistical results:
label = ID_4
------------------------------------------------------
statistic name = ID_4
number of bootstrap samples = 400
size of original sample = 10
original estimate = 3.5999999999999996
bias estimate = -0.05175000000000063
across bootstrap average = 3.548249999999999
bootstrap std. err. estimate = 0.04007502167379812
default c.i. level = 0.95
norm c.i. = [3.5214544007763693, 3.67854559922363]
basic c.i. = [2.002500000000003, 5.2974999999999985]
percentile c.i. = [1.902500000000001, 5.197499999999996]
BCa c.i. = [1.9000000000000001, 5.062949171806798]
bootstrap-t c.i. = [1.9000000000000001, 5.062949171806798]
------------------------------------------------------</code></pre>
<p>In these results, it just happens that the BCa and bootstrap-t result in the same intervals. The main question that comes up when bootstrapping is what value should be used for the number of bootstrap samples, <span class="math inline">\(B\)</span>. <span class="citation">(<a href="#ref-efron-tibshirani">B. Efron and Tibshirani 1994</a>)</span> provide some guidance indicating a range at least starting in the hundreds. There has been some work that suggests the the quality of the process is a function of <span class="math inline">\(n\)</span>, the size of the original sample. The work suggests that larger <span class="math inline">\(n\)</span> requires larger <span class="math inline">\(B\)</span>. The relationship <span class="math inline">\(B \approx 40n\)</span> has been suggested.</p>
<p>As previously mentioned, the KSL also supports the estimation of multiple quantities from the sample. This functionality is used extensively within the distribution modeling functionality of the KSL to provide confidence intervals on the parameters of distributions. Figure <a href="ch9BootStrapping.html#fig:MVBootstrapFig">8.2</a> presents the <code>BootstrapSampler</code> class, which will compute multiple estimators on a sample using the <code>MVBSEstimatorIfc</code> interface.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:MVBootstrapFig"></span>
<img src="figures2/ch9/BootstrapSampler.png" alt="KSL BootstrapSampler Classes" width="80%" height="80%" />
<p class="caption">
Figure 8.2: KSL BootstrapSampler Classes
</p>
</div>
<p>As shown in the following code, the <code>MVBSEstimatorIfc</code> interface defines a function that takes in a sample and returns many estimated quantities.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb303-1"><a href="ch9BootStrapping.html#cb303-1" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb303-2"><a href="ch9BootStrapping.html#cb303-2" tabindex="-1"></a><span class="co"> *  Given some data, produce multiple estimated statistics</span></span>
<span id="cb303-3"><a href="ch9BootStrapping.html#cb303-3" tabindex="-1"></a><span class="co"> *  from the data and store the estimated quantities in</span></span>
<span id="cb303-4"><a href="ch9BootStrapping.html#cb303-4" tabindex="-1"></a><span class="co"> *  the returned array. It is up to the user to interpret</span></span>
<span id="cb303-5"><a href="ch9BootStrapping.html#cb303-5" tabindex="-1"></a><span class="co"> *  the array values appropriately.</span></span>
<span id="cb303-6"><a href="ch9BootStrapping.html#cb303-6" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb303-7"><a href="ch9BootStrapping.html#cb303-7" tabindex="-1"></a><span class="kw">interface</span> MVBSEstimatorIfc <span class="op">{</span></span>
<span id="cb303-8"><a href="ch9BootStrapping.html#cb303-8" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb303-9"><a href="ch9BootStrapping.html#cb303-9" tabindex="-1"></a><span class="co">     * The name to associate with each dimension of the</span></span>
<span id="cb303-10"><a href="ch9BootStrapping.html#cb303-10" tabindex="-1"></a><span class="co">     * array that is returned by estimate(). The names</span></span>
<span id="cb303-11"><a href="ch9BootStrapping.html#cb303-11" tabindex="-1"></a><span class="co">     * should be unique. The order of the list of names should</span></span>
<span id="cb303-12"><a href="ch9BootStrapping.html#cb303-12" tabindex="-1"></a><span class="co">     * match the order of elements in the returned array.</span></span>
<span id="cb303-13"><a href="ch9BootStrapping.html#cb303-13" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb303-14"><a href="ch9BootStrapping.html#cb303-14" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">names</span><span class="op">:</span> List<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;</span></span>
<span id="cb303-15"><a href="ch9BootStrapping.html#cb303-15" tabindex="-1"></a></span>
<span id="cb303-16"><a href="ch9BootStrapping.html#cb303-16" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">estimate</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">):</span> <span class="dt">DoubleArray</span></span>
<span id="cb303-17"><a href="ch9BootStrapping.html#cb303-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="example">
<p><span id="exm:exBS3" class="example"><strong>Example 8.3  (Illustrating the BootstrapSampler Class) </strong></span>The following code illustrates the use of the <code>BootstrapSampler</code> class. This provides bootstrap estimates for basic statistics.</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb304-1"><a href="ch9BootStrapping.html#cb304-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">ed</span> <span class="op">=</span> ExponentialRV<span class="op">(</span><span class="fl">10.0</span><span class="op">)</span></span>
<span id="cb304-2"><a href="ch9BootStrapping.html#cb304-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> ed<span class="op">.</span>sample<span class="op">(</span><span class="dv">50</span><span class="op">)</span></span>
<span id="cb304-3"><a href="ch9BootStrapping.html#cb304-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">stat</span> <span class="op">=</span> Statistic<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb304-4"><a href="ch9BootStrapping.html#cb304-4" tabindex="-1"></a>println<span class="op">(</span>stat<span class="op">)</span></span>
<span id="cb304-5"><a href="ch9BootStrapping.html#cb304-5" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb304-6"><a href="ch9BootStrapping.html#cb304-6" tabindex="-1"></a><span class="kw">val</span> <span class="va">bss</span> <span class="op">=</span> BootstrapSampler<span class="op">(</span><span class="kw">data</span><span class="op">,</span> BasicStatistics<span class="op">())</span></span>
<span id="cb304-7"><a href="ch9BootStrapping.html#cb304-7" tabindex="-1"></a><span class="kw">val</span> <span class="va">estimates</span> <span class="op">=</span> bss<span class="op">.</span>bootStrapEstimates<span class="op">(</span><span class="dv">300</span><span class="op">)</span></span>
<span id="cb304-8"><a href="ch9BootStrapping.html#cb304-8" tabindex="-1"></a><span class="cf">for</span><span class="op">(</span>e <span class="kw">in</span> estimates<span class="op">){</span></span>
<span id="cb304-9"><a href="ch9BootStrapping.html#cb304-9" tabindex="-1"></a>  println<span class="op">(</span>e<span class="op">.</span>asString<span class="op">())</span></span>
<span id="cb304-10"><a href="ch9BootStrapping.html#cb304-10" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<p>This code samples from an exponential distribution to get the initial sample and then uses the <code>BootstrapSampler</code> class to provide bootstrap estimates for the basic statistics. The <code>BasicStatistics</code> class is just a simple implementation of the <code>MVBSEstimatorIfc</code> interface that computes the average, variance, minimum, maximum, skewness, kurtosis, lag-1 correlation, and lag-1 covariance.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb305-1"><a href="ch9BootStrapping.html#cb305-1" tabindex="-1"></a><span class="kw">class</span> BasicStatistics <span class="op">:</span> <span class="dt">MVBSEstimatorIfc</span><span class="op">{</span></span>
<span id="cb305-2"><a href="ch9BootStrapping.html#cb305-2" tabindex="-1"></a></span>
<span id="cb305-3"><a href="ch9BootStrapping.html#cb305-3" tabindex="-1"></a>    <span class="kw">private</span> <span class="kw">val</span> <span class="va">stat</span> <span class="op">=</span> Statistic<span class="op">()</span></span>
<span id="cb305-4"><a href="ch9BootStrapping.html#cb305-4" tabindex="-1"></a></span>
<span id="cb305-5"><a href="ch9BootStrapping.html#cb305-5" tabindex="-1"></a>    <span class="kw">override</span> <span class="kw">val</span> <span class="va">names</span><span class="op">:</span> List<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;</span> <span class="op">=</span> listOf<span class="op">(</span></span>
<span id="cb305-6"><a href="ch9BootStrapping.html#cb305-6" tabindex="-1"></a>        <span class="st">&quot;average&quot;</span><span class="op">,</span> <span class="st">&quot;variance&quot;</span><span class="op">,</span> <span class="st">&quot;min&quot;</span><span class="op">,</span> <span class="st">&quot;max&quot;</span><span class="op">,</span> <span class="st">&quot;skewness&quot;</span><span class="op">,</span> <span class="st">&quot;kurtosis&quot;</span><span class="op">,</span></span>
<span id="cb305-7"><a href="ch9BootStrapping.html#cb305-7" tabindex="-1"></a>        <span class="st">&quot;lag1Correlation&quot;</span><span class="op">,</span> <span class="st">&quot;lag1Covariance&quot;</span><span class="op">)</span></span>
<span id="cb305-8"><a href="ch9BootStrapping.html#cb305-8" tabindex="-1"></a></span>
<span id="cb305-9"><a href="ch9BootStrapping.html#cb305-9" tabindex="-1"></a>    <span class="kw">override</span> <span class="kw">fun</span> <span class="fu">estimate</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">):</span> <span class="dt">DoubleArray</span> <span class="op">{</span></span>
<span id="cb305-10"><a href="ch9BootStrapping.html#cb305-10" tabindex="-1"></a>        stat<span class="op">.</span>reset<span class="op">()</span></span>
<span id="cb305-11"><a href="ch9BootStrapping.html#cb305-11" tabindex="-1"></a>        stat<span class="op">.</span>collect<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb305-12"><a href="ch9BootStrapping.html#cb305-12" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">array</span> <span class="op">=</span> DoubleArray<span class="op">(</span><span class="dv">8</span><span class="op">)</span></span>
<span id="cb305-13"><a href="ch9BootStrapping.html#cb305-13" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>average</span>
<span id="cb305-14"><a href="ch9BootStrapping.html#cb305-14" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>variance</span>
<span id="cb305-15"><a href="ch9BootStrapping.html#cb305-15" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>min</span>
<span id="cb305-16"><a href="ch9BootStrapping.html#cb305-16" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>max</span>
<span id="cb305-17"><a href="ch9BootStrapping.html#cb305-17" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>skewness</span>
<span id="cb305-18"><a href="ch9BootStrapping.html#cb305-18" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>kurtosis</span>
<span id="cb305-19"><a href="ch9BootStrapping.html#cb305-19" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>lag1Correlation</span>
<span id="cb305-20"><a href="ch9BootStrapping.html#cb305-20" tabindex="-1"></a>        array<span class="op">[</span><span class="dv">7</span><span class="op">]</span> <span class="op">=</span> stat<span class="op">.</span>lag1Covariance</span>
<span id="cb305-21"><a href="ch9BootStrapping.html#cb305-21" tabindex="-1"></a>        <span class="kw">return</span> array</span>
<span id="cb305-22"><a href="ch9BootStrapping.html#cb305-22" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb305-23"><a href="ch9BootStrapping.html#cb305-23" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>This same approach could be used to add additional statistics. The output from the sampling can be quite extensive and thus is not provided here. For a final discussion of bootstrapping, we discuss the KSL capabilities for bootstrapping cases and illustrate its application to bootstrapping a simple regression model.</p>
<p>The previous KSL bootstrapping functionality focused on uni-variate data. The same concepts can also be applied to multi-variate data. Since the data structures to hold multi-variate data can be complex, we focus on representing the population of items via identifiers. That is, we assume that each item in the population can be assigned a unique label and that the sampling and resampling process takes place on the set of identifiers. The sampled identifiers then can be used to index into some complex data structure to select the sampled items. Then from each item, a set of values are observed. Thus, each sampled item, <span class="math inline">\(i\)</span>, results in a set of observations <span class="math inline">\(\vec{x_i}=x_1, x_2, \cdots, x_m\)</span>, where <span class="math inline">\(m\)</span> is the number of attributes observed about each item. In some bootstrapping literature, the set of sampled items is called the cases, with each item called a case. Thus, in this situation, the bootstrapping process is sometimes called case based bootstrapping.</p>
<p>Within a programming context, we can represent each item with an object, which has some attributes. The attributes represent the data observed about the object. Placing the objects into a collection, permits sampling from the collection. For example, the cases could be the rows in a regression data set. The data could be stored in arrays, in data frames, database tables, etc. As long as each item the population can be uniquely labeled, we can sample the labels, and then select the items based on their identifiers.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:CaseBootstrapFig"></span>
<img src="figures2/ch9/CaseBootstrapSampler.png" alt="KSL CaseBootstrapSampler Classes" width="80%" height="80%" />
<p class="caption">
Figure 8.3: KSL CaseBootstrapSampler Classes
</p>
</div>
<p>Figure <a href="ch9BootStrapping.html#fig:CaseBootstrapFig">8.3</a> presents the <code>CaseBootstrapSampler</code> class, which will compute multiple estimators using case based sample via the <code>CaseBootEstimatorIfc</code> interface. This sampler has similar functionality as the <code>BootstrapSampler</code> class. As in the <code>BootstrapSampler</code> situation, we assume that the estimation process may result in one or more estimated quantities; however, in this situation, the estimation process requires a set of items from which the quantities will be computed.</p>
<p>It should be instructive to review the associated interfaces in Figure <a href="ch9BootStrapping.html#fig:CaseBootstrapFig">8.3</a>. The <code>CaseBootstrapSampler</code> class requires an instance of the <code>CaseBootEstimatorIfc</code> interface. The <code>CaseBootEstimatorIfc</code> interface does not define the data structure associated with the sampling process. Instead, it defines a list of identifiers that represent the finite sample from which bootstrap sampling occurs.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb306-1"><a href="ch9BootStrapping.html#cb306-1" tabindex="-1"></a><span class="kw">interface</span> CaseBootEstimatorIfc <span class="op">{</span></span>
<span id="cb306-2"><a href="ch9BootStrapping.html#cb306-2" tabindex="-1"></a></span>
<span id="cb306-3"><a href="ch9BootStrapping.html#cb306-3" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb306-4"><a href="ch9BootStrapping.html#cb306-4" tabindex="-1"></a><span class="co">     * The name to associate with each dimension of the</span></span>
<span id="cb306-5"><a href="ch9BootStrapping.html#cb306-5" tabindex="-1"></a><span class="co">     * array that is returned by estimate(). The names</span></span>
<span id="cb306-6"><a href="ch9BootStrapping.html#cb306-6" tabindex="-1"></a><span class="co">     * should be unique. The order of the list of names should</span></span>
<span id="cb306-7"><a href="ch9BootStrapping.html#cb306-7" tabindex="-1"></a><span class="co">     * match the order of elements in the returned array. This</span></span>
<span id="cb306-8"><a href="ch9BootStrapping.html#cb306-8" tabindex="-1"></a><span class="co">     * list is used to label the elements that are estimated.</span></span>
<span id="cb306-9"><a href="ch9BootStrapping.html#cb306-9" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb306-10"><a href="ch9BootStrapping.html#cb306-10" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">names</span><span class="op">:</span> List<span class="op">&lt;</span><span class="kw">String</span><span class="op">&gt;</span></span>
<span id="cb306-11"><a href="ch9BootStrapping.html#cb306-11" tabindex="-1"></a></span>
<span id="cb306-12"><a href="ch9BootStrapping.html#cb306-12" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb306-13"><a href="ch9BootStrapping.html#cb306-13" tabindex="-1"></a><span class="co">     *  The estimates from the estimator based on the original (not resampled) data.</span></span>
<span id="cb306-14"><a href="ch9BootStrapping.html#cb306-14" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb306-15"><a href="ch9BootStrapping.html#cb306-15" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">originalEstimates</span><span class="op">:</span> DoubleArray</span>
<span id="cb306-16"><a href="ch9BootStrapping.html#cb306-16" tabindex="-1"></a></span>
<span id="cb306-17"><a href="ch9BootStrapping.html#cb306-17" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb306-18"><a href="ch9BootStrapping.html#cb306-18" tabindex="-1"></a><span class="co">     *  The set of case identifiers. This set must hold unique</span></span>
<span id="cb306-19"><a href="ch9BootStrapping.html#cb306-19" tabindex="-1"></a><span class="co">     *  integers that serve as the sampling population. Elements (cases)</span></span>
<span id="cb306-20"><a href="ch9BootStrapping.html#cb306-20" tabindex="-1"></a><span class="co">     *  are sampled with replacement from this set to specify</span></span>
<span id="cb306-21"><a href="ch9BootStrapping.html#cb306-21" tabindex="-1"></a><span class="co">     *  the data that will be used in the estimation process.</span></span>
<span id="cb306-22"><a href="ch9BootStrapping.html#cb306-22" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb306-23"><a href="ch9BootStrapping.html#cb306-23" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">caseIdentifiers</span><span class="op">:</span> List<span class="op">&lt;</span><span class="kw">Int</span><span class="op">&gt;</span></span>
<span id="cb306-24"><a href="ch9BootStrapping.html#cb306-24" tabindex="-1"></a></span>
<span id="cb306-25"><a href="ch9BootStrapping.html#cb306-25" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb306-26"><a href="ch9BootStrapping.html#cb306-26" tabindex="-1"></a><span class="co">     *  The [caseIndices] array contains the case identifiers that</span></span>
<span id="cb306-27"><a href="ch9BootStrapping.html#cb306-27" tabindex="-1"></a><span class="co">     *  should be used to select the data on which the estimation</span></span>
<span id="cb306-28"><a href="ch9BootStrapping.html#cb306-28" tabindex="-1"></a><span class="co">     *  process should be executed. The function produces an</span></span>
<span id="cb306-29"><a href="ch9BootStrapping.html#cb306-29" tabindex="-1"></a><span class="co">     *  array of estimates during the estimation process, which</span></span>
<span id="cb306-30"><a href="ch9BootStrapping.html#cb306-30" tabindex="-1"></a><span class="co">     *  are associated with the labels in the names list. The</span></span>
<span id="cb306-31"><a href="ch9BootStrapping.html#cb306-31" tabindex="-1"></a><span class="co">     *  case indices array may have repeated case identifiers</span></span>
<span id="cb306-32"><a href="ch9BootStrapping.html#cb306-32" tabindex="-1"></a><span class="co">     *  due to sampling with replacement.</span></span>
<span id="cb306-33"><a href="ch9BootStrapping.html#cb306-33" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb306-34"><a href="ch9BootStrapping.html#cb306-34" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">caseIndices</span><span class="op">:</span> <span class="dt">IntArray</span><span class="op">):</span> <span class="dt">DoubleArray</span></span>
<span id="cb306-35"><a href="ch9BootStrapping.html#cb306-35" tabindex="-1"></a>}</span></code></pre></div>
<p>As we can see from the previous Kotlin code, the <code>names</code> and <code>originalEstimates</code> properties have a similar functionality as in the <code>BootstrapSampler</code> class. The names are the labels for the things estimated from the sample.</p>
<p>The property, <code>caseIdentifiers</code> is a list holding the identifiers for the cases. For example, if the cases are rows in a regression dataset, then the list might hold the values <span class="math inline">\((0,1,2,\cdots,n-1)\)</span>, where <span class="math inline">\(n\)</span> is the number of rows. That is, the list holds the <em>indices</em> of the rows. The sampling process will sample from the identifier population and use the identifiers to access the actual items. This approach necessitates a different <code>estimate()</code> function. Here, the estimation process, requires an array of integers that represent the identifiers of the cases selected to be included in the estimation process. Note that because the sampling is with replacement, the same item can be selected multiple times (or not at all) during the bootstrap sampling. Conceptually, this is no different from what we have previously illustrated, but now our population is simply a set of identifiers.</p>
<p>The class <code>MatrixBootEstimator</code> is simply an implementation of the <code>CaseBootEstimatorIfc</code> interface designed to work with a rectangular array (i.e. a matrix) of data, where the rows are the cases. The interface <code>MatrixEstimatorIfc</code> is a convenience interface for directly computing the statistical quantities from a supplied matrix. The selection process for <code>MatrixBootEstimator</code> is simply to select the rows as shown in the following code.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb307-1"><a href="ch9BootStrapping.html#cb307-1" tabindex="-1"></a>    <span class="kw">override</span> <span class="kw">fun</span> <span class="fu">estimate</span><span class="op">(</span><span class="va">caseIndices</span><span class="op">:</span> <span class="dt">IntArray</span><span class="op">):</span> <span class="dt">DoubleArray</span> <span class="op">{</span></span>
<span id="cb307-2"><a href="ch9BootStrapping.html#cb307-2" tabindex="-1"></a>        <span class="co">// select the rows of the matrix from the supplied indices</span></span>
<span id="cb307-3"><a href="ch9BootStrapping.html#cb307-3" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">m</span> <span class="op">=</span> Array<span class="op">(</span>matrix<span class="op">.</span>size<span class="op">)</span> <span class="op">{</span> matrix<span class="op">[</span>caseIndices<span class="op">[</span>it<span class="op">]]</span> <span class="op">}</span></span>
<span id="cb307-4"><a href="ch9BootStrapping.html#cb307-4" tabindex="-1"></a>        <span class="kw">return</span> matrixEstimator<span class="op">.</span>estimate<span class="op">(</span>m<span class="op">)</span></span>
<span id="cb307-5"><a href="ch9BootStrapping.html#cb307-5" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>The <code>CaseBootstrapSampler</code> class samples the indices (<code>mySample</code>) in the following code, which is then supplied to the <code>estimate(caseIndices: IntArray)</code> function.</p>
<div class="sourceCode" id="cb308"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb308-1"><a href="ch9BootStrapping.html#cb308-1" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">sampleCases</span><span class="op">():</span> <span class="dt">IntArray</span> <span class="op">{</span></span>
<span id="cb308-2"><a href="ch9BootStrapping.html#cb308-2" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>i <span class="kw">in</span> myOriginalPopulation<span class="op">.</span>indices<span class="op">)</span> <span class="op">{</span></span>
<span id="cb308-3"><a href="ch9BootStrapping.html#cb308-3" tabindex="-1"></a>            <span class="kw">val</span> <span class="va">index</span> <span class="op">=</span> rnStream<span class="op">.</span>randInt<span class="op">(</span><span class="dv">0</span><span class="op">,</span> myOriginalPopulation<span class="op">.</span>size <span class="op">-</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb308-4"><a href="ch9BootStrapping.html#cb308-4" tabindex="-1"></a>            mySample<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> myOriginalPopulation<span class="op">[</span>index<span class="op">]</span></span>
<span id="cb308-5"><a href="ch9BootStrapping.html#cb308-5" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb308-6"><a href="ch9BootStrapping.html#cb308-6" tabindex="-1"></a>        <span class="kw">return</span> mySample</span>
<span id="cb308-7"><a href="ch9BootStrapping.html#cb308-7" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
<p>Finally, the object <code>OLSBootEstimator,</code> in Figure <a href="ch9BootStrapping.html#fig:CaseBootstrapFig">8.3</a>, is an object that implements the <code>MatrixEstimatorIfc</code> interface an computes the regression coefficients by assuming that the first column of the matrix is the regressor, <span class="math inline">\(Y\)</span>, and the remaining columns represent the predictor matrix <span class="math inline">\(X\)</span>. Because of the fact that we use the ordinary least squares estimation routines from the <a href="https://hipparchus.org/">Hipparchus library</a>, the <span class="math inline">\(X\)</span> matrix does not need to include the column for estimating the intercept term.</p>
<p>Putting all of these concepts together, we can illustrate the bootstrapping of a regression estimation process. As shown in the following code, we generate some regression data. For simplicity, we assume normally distributed predictors and error.</p>
<div class="example">
<p><span id="exm:exBS4" class="example"><strong>Example 8.4  (Illustrating Case Based Bootstrapping) </strong></span>This example illustrates case based bootstrapping for a linear regression model.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb309-1"><a href="ch9BootStrapping.html#cb309-1" tabindex="-1"></a>    <span class="co">// first make some data for the example</span></span>
<span id="cb309-2"><a href="ch9BootStrapping.html#cb309-2" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">n1</span> <span class="op">=</span> NormalRV<span class="op">(</span><span class="fl">10.0</span><span class="op">,</span> <span class="fl">3.0</span><span class="op">)</span></span>
<span id="cb309-3"><a href="ch9BootStrapping.html#cb309-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">n2</span> <span class="op">=</span> NormalRV<span class="op">(</span><span class="fl">5.0</span><span class="op">,</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span id="cb309-4"><a href="ch9BootStrapping.html#cb309-4" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">e</span> <span class="op">=</span> NormalRV<span class="op">()</span></span>
<span id="cb309-5"><a href="ch9BootStrapping.html#cb309-5" tabindex="-1"></a>    <span class="co">// make a simple linear model with some error</span></span>
<span id="cb309-6"><a href="ch9BootStrapping.html#cb309-6" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> Array<span class="op">&lt;</span>DoubleArray<span class="op">&gt;(</span><span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb309-7"><a href="ch9BootStrapping.html#cb309-7" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">x1</span> <span class="op">=</span> n1<span class="op">.</span>value</span>
<span id="cb309-8"><a href="ch9BootStrapping.html#cb309-8" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">x2</span> <span class="op">=</span> n2<span class="op">.</span>value</span>
<span id="cb309-9"><a href="ch9BootStrapping.html#cb309-9" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">y</span> <span class="op">=</span> <span class="fl">10.0</span> <span class="op">+</span> <span class="fl">2.0</span><span class="op">*</span>x1 <span class="op">+</span> <span class="fl">5.0</span><span class="op">*</span>x2 <span class="op">+</span> e<span class="op">.</span>value</span>
<span id="cb309-10"><a href="ch9BootStrapping.html#cb309-10" tabindex="-1"></a>        doubleArrayOf<span class="op">(</span>y<span class="op">,</span> x1<span class="op">,</span> x2<span class="op">)</span></span>
<span id="cb309-11"><a href="ch9BootStrapping.html#cb309-11" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb309-12"><a href="ch9BootStrapping.html#cb309-12" tabindex="-1"></a>    <span class="co">//data.write()</span></span>
<span id="cb309-13"><a href="ch9BootStrapping.html#cb309-13" tabindex="-1"></a>    <span class="co">// apply bootstrapping to get bootstrap confidence intervals on regression parameters</span></span>
<span id="cb309-14"><a href="ch9BootStrapping.html#cb309-14" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">cbs</span> <span class="op">=</span> CaseBootstrapSampler<span class="op">(</span>MatrixBootEstimator<span class="op">(</span><span class="kw">data</span><span class="op">,</span> OLSBootEstimator<span class="op">))</span></span>
<span id="cb309-15"><a href="ch9BootStrapping.html#cb309-15" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">estimates</span> <span class="op">=</span> cbs<span class="op">.</span>bootStrapEstimates<span class="op">(</span><span class="dv">399</span><span class="op">)</span></span>
<span id="cb309-16"><a href="ch9BootStrapping.html#cb309-16" tabindex="-1"></a>    <span class="co">// print out the bootstrap estimates</span></span>
<span id="cb309-17"><a href="ch9BootStrapping.html#cb309-17" tabindex="-1"></a>    <span class="cf">for</span><span class="op">(</span>be <span class="kw">in</span> estimates<span class="op">){</span></span>
<span id="cb309-18"><a href="ch9BootStrapping.html#cb309-18" tabindex="-1"></a>        println<span class="op">(</span>be<span class="op">)</span></span>
<span id="cb309-19"><a href="ch9BootStrapping.html#cb309-19" tabindex="-1"></a>    <span class="op">}</span></span></code></pre></div>
</div>
<p>The results of the bootstrapping process are as follows. As we can see, the confidence intervals for the known regression coefficients <span class="math inline">\((\beta_0=10.0, \beta_1=2.0, \beta_2=5.0\)</span>) do a reasonable job of covering the known quantities.</p>
<pre><code>------------------------------------------------------
Bootstrap statistical results:
------------------------------------------------------
statistic name = b0
number of bootstrap samples = 399
size of original sample = 100
original estimate = 10.997223980092517
bias estimate = 0.09157195462246293
across bootstrap average = 11.08879593471498
bootstrap std. err. estimate = 0.04090939870934704
default c.i. level = 0.95
norm c.i. = [10.917043031928365, 11.07740492825667]
basic c.i. = [9.052998742918017, 12.427568666255603]
percentile c.i. = [9.566879293929432, 12.941449217267017]

------------------------------------------------------
Bootstrap statistical results:
------------------------------------------------------
statistic name = b1
number of bootstrap samples = 399
size of original sample = 100
original estimate = 1.9494963162125691
bias estimate = -0.0037025407662301113
across bootstrap average = 1.945793775446339
bootstrap std. err. estimate = 0.002936548908845975
default c.i. level = 0.95
norm c.i. = [1.9437407861077505, 1.9552518463173878]
basic c.i. = [1.84302999325699, 2.0787441726888636]
percentile c.i. = [1.8202484597362747, 2.0559626391681483]

------------------------------------------------------
Bootstrap statistical results:
------------------------------------------------------
statistic name = b2
number of bootstrap samples = 399
size of original sample = 100
original estimate = 4.9390811206920375
bias estimate = -0.010600231082452005
across bootstrap average = 4.9284808896095855
bootstrap std. err. estimate = 0.004055345194183637
default c.i. level = 0.95
norm c.i. = [4.931132790160152, 4.947029451223923]
basic c.i. = [4.794185241695615, 5.111679266251416]
percentile c.i. = [4.766482975132659, 5.08397699968846]</code></pre>
<p>For more of the theory and methods of bootstrapping within the context of regression, we refer the interested reader to the text, <span class="citation">(<a href="#ref-fox2018r">Fox and Weisberg 2018</a>)</span>. Since the purpose of this section was to illustrate how the KSL facilitates bootstrapping, the interested reader may want to explore more of the theory. From that standpoint, the books by <span class="citation">(<a href="#ref-efron-tibshirani">B. Efron and Tibshirani 1994</a>)</span> and <span class="citation">(<a href="#ref-davison-hinkley">Davison AC 1997</a>)</span> are good starting points. See also the paper <span class="citation">(<a href="#ref-efron-tibshirani-1986">Efron B. and Tibshirani 1986</a>)</span>.</p>
</div>
</div>
<h3><span class="header-section-number">G</span> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-davison-hinkley" class="csl-entry">
Davison AC, Hinkley DV. 1997. <em>Bootstrap Methods and Their Application</em>. Cambridge University Press.
</div>
<div id="ref-efron-tibshirani-1986" class="csl-entry">
Efron, B., and R. Tibshirani. 1986. <span>“Bootstrap Methods for Standard Errors, Confidence Intervals, and Other Measures of Statistical Accuracy.”</span> <em>Statistical Science</em> 1 (1): 54–75.
</div>
<div id="ref-efron-tibshirani" class="csl-entry">
Efron, B., and R. Tibshirani. 1994. <em>An Introduction to the Bootstrap</em>. CRC Press.
</div>
<div id="ref-fox2018r" class="csl-entry">
Fox, J., and S. Weisberg. 2018. <em>An r Companion to Applied Regression</em>. SAGE Publications.
</div>
<div id="ref-wehrens2000" class="csl-entry">
Wehrens, Hein Putter, Ron, and Lutgarde M. C Buydens. 2000. <span>“The Bootstrap: A Tutorial.”</span> <em>Chemometrics and Intelligent Laboratory Systems</em> 54 (1): 35–52.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch9AdvMC.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch9VRTs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
