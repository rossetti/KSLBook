<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Distribution Fitting Using the KSL | Simulation Modeling using the Kotlin Simulation Library (KSL)</title>
  <meta name="description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Distribution Fitting Using the KSL | Simulation Modeling using the Kotlin Simulation Library (KSL)" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Distribution Fitting Using the KSL | Simulation Modeling using the Kotlin Simulation Library (KSL)" />
  
  <meta name="twitter:description" content="A book that illustrates the basics of using the KSL. The output format for this book is bookdown::gitbook." />
  

<meta name="author" content="Manuel D. Rossetti" />


<meta name="date" content="2025-09-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probModels.html"/>
<link rel="next" href="summary.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Simulation Modeling using the Kotlin Simulation Library (KSL)</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="release-history.html"><a href="release-history.html"><i class="fa fa-check"></i>Release History</a></li>
<li class="chapter" data-level="" data-path="ksl-project-page.html"><a href="ksl-project-page.html"><i class="fa fa-check"></i>KSL Project Page</a></li>
<li class="chapter" data-level="" data-path="book-support-files.html"><a href="book-support-files.html"><i class="fa fa-check"></i>Book Support Files</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="" data-path="intended-audience.html"><a href="intended-audience.html"><i class="fa fa-check"></i>Intended Audience</a></li>
<li class="chapter" data-level="" data-path="organization-of-the-book.html"><a href="organization-of-the-book.html"><i class="fa fa-check"></i>Organization of the Book</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="ch1.html"><a href="ch1.html"><i class="fa fa-check"></i><b>1</b> Simulation Modeling</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulation-modeling.html"><a href="simulation-modeling.html"><i class="fa fa-check"></i><b>1.1</b> Simulation Modeling</a></li>
<li class="chapter" data-level="1.2" data-path="why-simulate.html"><a href="why-simulate.html"><i class="fa fa-check"></i><b>1.2</b> Why Simulate?</a></li>
<li class="chapter" data-level="1.3" data-path="types-of-systems-and-simulation-models.html"><a href="types-of-systems-and-simulation-models.html"><i class="fa fa-check"></i><b>1.3</b> Types of Systems and Simulation Models</a></li>
<li class="chapter" data-level="1.4" data-path="simulation-descriptive-or-prescriptive-modeling.html"><a href="simulation-descriptive-or-prescriptive-modeling.html"><i class="fa fa-check"></i><b>1.4</b> Simulation: Descriptive or Prescriptive Modeling?</a></li>
<li class="chapter" data-level="1.5" data-path="randomness-in-simulation.html"><a href="randomness-in-simulation.html"><i class="fa fa-check"></i><b>1.5</b> Randomness in Simulation</a></li>
<li class="chapter" data-level="1.6" data-path="simulation-languages.html"><a href="simulation-languages.html"><i class="fa fa-check"></i><b>1.6</b> Simulation Languages</a></li>
<li class="chapter" data-level="1.7" data-path="ch1secsimMeth.html"><a href="ch1secsimMeth.html"><i class="fa fa-check"></i><b>1.7</b> Simulation Methodology</a></li>
<li class="chapter" data-level="1.8" data-path="overview-of-the-kotlin-simulation-library.html"><a href="overview-of-the-kotlin-simulation-library.html"><i class="fa fa-check"></i><b>1.8</b> Overview of the Kotlin Simulation Library</a></li>
<li class="chapter" data-level="1.9" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch2rng.html"><a href="ch2rng.html"><i class="fa fa-check"></i><b>2</b> Modeling Randomness</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch2generator.html"><a href="ch2generator.html"><i class="fa fa-check"></i><b>2.1</b> Random Number Generator</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="ch2generator.html"><a href="ch2generator.html#ch2randompkg"><i class="fa fa-check"></i><b>2.1.1</b> Random Package</a></li>
<li class="chapter" data-level="2.1.2" data-path="ch2generator.html"><a href="ch2generator.html#ch2creatingStreams"><i class="fa fa-check"></i><b>2.1.2</b> Creating and Using Streams</a></li>
<li class="chapter" data-level="2.1.3" data-path="ch2generator.html"><a href="ch2generator.html#ch2crn"><i class="fa fa-check"></i><b>2.1.3</b> Common Random Numbers</a></li>
<li class="chapter" data-level="2.1.4" data-path="ch2generator.html"><a href="ch2generator.html#ch2antitheticStreams"><i class="fa fa-check"></i><b>2.1.4</b> Creating and Using Antithetic Streams</a></li>
<li class="chapter" data-level="2.1.5" data-path="ch2generator.html"><a href="ch2generator.html#ch2rnFAQ"><i class="fa fa-check"></i><b>2.1.5</b> Frequently Asked Questions about Random Numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="rvg.html"><a href="rvg.html"><i class="fa fa-check"></i><b>2.2</b> Random Variate Generation</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="rvg.html"><a href="rvg.html#basic-random-variate-generation"><i class="fa fa-check"></i><b>2.2.1</b> Basic Random Variate Generation</a></li>
<li class="chapter" data-level="2.2.2" data-path="rvg.html"><a href="rvg.html#rvg_dists"><i class="fa fa-check"></i><b>2.2.2</b> Continuous and Discrete Random Variables</a></li>
<li class="chapter" data-level="2.2.3" data-path="rvg.html"><a href="rvg.html#rvguse"><i class="fa fa-check"></i><b>2.2.3</b> Creating and Using Random Variables</a></li>
<li class="chapter" data-level="2.2.4" data-path="rvg.html"><a href="rvg.html#functions-of-random-variables"><i class="fa fa-check"></i><b>2.2.4</b> Functions of Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="probModels.html"><a href="probModels.html"><i class="fa fa-check"></i><b>2.3</b> Probability Distribution Models</a></li>
<li class="chapter" data-level="2.4" data-path="distFitting.html"><a href="distFitting.html"><i class="fa fa-check"></i><b>2.4</b> Distribution Fitting Using the KSL</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="distFitting.html"><a href="distFitting.html#estimating-distribution-parameters"><i class="fa fa-check"></i><b>2.4.1</b> Estimating Distribution Parameters</a></li>
<li class="chapter" data-level="2.4.2" data-path="distFitting.html"><a href="distFitting.html#continuous-distribution-recommendation-framework"><i class="fa fa-check"></i><b>2.4.2</b> Continuous Distribution Recommendation Framework</a></li>
<li class="chapter" data-level="2.4.3" data-path="distFitting.html"><a href="distFitting.html#discrete-distribution-framework"><i class="fa fa-check"></i><b>2.4.3</b> Discrete Distribution Framework</a></li>
<li class="chapter" data-level="2.4.4" data-path="distFitting.html"><a href="distFitting.html#pdfmexamples"><i class="fa fa-check"></i><b>2.4.4</b> Illustrative Examples from Appendix @ref(appidm)</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>2.5</b> Summary</a></li>
<li class="chapter" data-level="2.6" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>2.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="mcm.html"><a href="mcm.html"><i class="fa fa-check"></i><b>3</b> Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="kslStatistics.html"><a href="kslStatistics.html"><i class="fa fa-check"></i><b>3.1</b> Collecting Statistics</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="kslStatistics.html"><a href="kslStatistics.html#creating-and-using-a-statistic"><i class="fa fa-check"></i><b>3.1.1</b> Creating and Using a Statistic</a></li>
<li class="chapter" data-level="3.1.2" data-path="kslStatistics.html"><a href="kslStatistics.html#histFreq"><i class="fa fa-check"></i><b>3.1.2</b> Histograms and Frequencies</a></li>
<li class="chapter" data-level="3.1.3" data-path="kslStatistics.html"><a href="kslStatistics.html#ch3batchStats"><i class="fa fa-check"></i><b>3.1.3</b> Batch Statistics</a></li>
<li class="chapter" data-level="3.1.4" data-path="kslStatistics.html"><a href="kslStatistics.html#ch3StatSummary"><i class="fa fa-check"></i><b>3.1.4</b> Statistics Summary</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="ssMC.html"><a href="ssMC.html"><i class="fa fa-check"></i><b>3.2</b> Simple Monte Carlo Integration</a></li>
<li class="chapter" data-level="3.3" data-path="ch3StatReview.html"><a href="ch3StatReview.html"><i class="fa fa-check"></i><b>3.3</b> Review of Statistical Concepts</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch3StatReview.html"><a href="ch3StatReview.html#point-estimates-and-confidence-intervals"><i class="fa fa-check"></i><b>3.3.1</b> Point Estimates and Confidence Intervals</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch3StatReview.html"><a href="ch3StatReview.html#ch3SampleSize"><i class="fa fa-check"></i><b>3.3.2</b> Sample Size Determination</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch3StatReview.html"><a href="ch3StatReview.html#determining-the-sample-size-for-a-monte-carlo-simulation-experiment"><i class="fa fa-check"></i><b>3.3.3</b> Determining the Sample Size for a Monte Carlo Simulation Experiment</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="craps.html"><a href="craps.html"><i class="fa fa-check"></i><b>3.4</b> Simulating the Game of Craps</a></li>
<li class="chapter" data-level="3.5" data-path="the-news-vendor-problem.html"><a href="the-news-vendor-problem.html"><i class="fa fa-check"></i><b>3.5</b> The News Vendor Problem</a></li>
<li class="chapter" data-level="3.6" data-path="ch3InsProcess.html"><a href="ch3InsProcess.html"><i class="fa fa-check"></i><b>3.6</b> A Simple Inspection Process</a></li>
<li class="chapter" data-level="3.7" data-path="ch3SAN.html"><a href="ch3SAN.html"><i class="fa fa-check"></i><b>3.7</b> Stochastic Activity Networks</a></li>
<li class="chapter" data-level="3.8" data-path="mcmExperiments.html"><a href="mcmExperiments.html"><i class="fa fa-check"></i><b>3.8</b> Monte-Carlo Experiments</a></li>
<li class="chapter" data-level="3.9" data-path="summary-1.html"><a href="summary-1.html"><i class="fa fa-check"></i><b>3.9</b> Summary</a></li>
<li class="chapter" data-level="3.10" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>3.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="introDEDS.html"><a href="introDEDS.html"><i class="fa fa-check"></i><b>4</b> Introduction to Discrete Event Modeling</a>
<ul>
<li class="chapter" data-level="4.1" data-path="introDEDSdeds.html"><a href="introDEDSdeds.html"><i class="fa fa-check"></i><b>4.1</b> Discrete-Event Dynamic Systems</a></li>
<li class="chapter" data-level="4.2" data-path="HowDEDSClockWorks.html"><a href="HowDEDSClockWorks.html"><i class="fa fa-check"></i><b>4.2</b> How the Discrete-Event Clock Works</a></li>
<li class="chapter" data-level="4.3" data-path="QHandExample.html"><a href="QHandExample.html"><i class="fa fa-check"></i><b>4.3</b> Simulating a Queueing System By Hand</a></li>
<li class="chapter" data-level="4.4" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html"><i class="fa fa-check"></i><b>4.4</b> Modeling DEDS in the KSL</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#event-scheduling"><i class="fa fa-check"></i><b>4.4.1</b> Event Scheduling</a></li>
<li class="chapter" data-level="4.4.2" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSschedExamples"><i class="fa fa-check"></i><b>4.4.2</b> Simple Event Scheduling Examples</a></li>
<li class="chapter" data-level="4.4.3" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSUpDown"><i class="fa fa-check"></i><b>4.4.3</b> Up and Down Component Example</a></li>
<li class="chapter" data-level="4.4.4" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#introDEDSPharmacy"><i class="fa fa-check"></i><b>4.4.4</b> Modeling a Simple Queueing System</a></li>
<li class="chapter" data-level="4.4.5" data-path="introDEDSdedsKSL.html"><a href="introDEDSdedsKSL.html#more-details-about-the-pharmacy-model-implementation"><i class="fa fa-check"></i><b>4.4.5</b> More Details About the Pharmacy Model Implementation</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html"><i class="fa fa-check"></i><b>4.5</b> Enhancing the Drive Through Pharmacy Model</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html#modeling-a-simple-resource"><i class="fa fa-check"></i><b>4.5.1</b> Modeling a Simple Resource</a></li>
<li class="chapter" data-level="4.5.2" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html#modeling-a-queue-with-statistical-collection"><i class="fa fa-check"></i><b>4.5.2</b> Modeling a Queue with Statistical Collection</a></li>
<li class="chapter" data-level="4.5.3" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html#modeling-a-repeating-event-pattern"><i class="fa fa-check"></i><b>4.5.3</b> Modeling a Repeating Event Pattern</a></li>
<li class="chapter" data-level="4.5.4" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html#collecting-more-detailed-statistics"><i class="fa fa-check"></i><b>4.5.4</b> Collecting More Detailed Statistics</a></li>
<li class="chapter" data-level="4.5.5" data-path="enhancing-the-drive-through-pharmacy-model.html"><a href="enhancing-the-drive-through-pharmacy-model.html#implementing-the-enhanced-pharmacy-model"><i class="fa fa-check"></i><b>4.5.5</b> Implementing the Enhanced Pharmacy Model</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="DTPExpanded.html"><a href="DTPExpanded.html"><i class="fa fa-check"></i><b>4.6</b> More Drive Through Fun</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-a-resource-with-a-waiting-line"><i class="fa fa-check"></i><b>4.6.1</b> Modeling a Resource with a Waiting Line</a></li>
<li class="chapter" data-level="4.6.2" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-the-tandem-queue-of-example-refexmexch4tandemq"><i class="fa fa-check"></i><b>4.6.2</b> Modeling the Tandem Queue of Example @ref(exm:exCh4TandemQ)</a></li>
<li class="chapter" data-level="4.6.3" data-path="DTPExpanded.html"><a href="DTPExpanded.html#modeling-with-the-station-package"><i class="fa fa-check"></i><b>4.6.3</b> Modeling with the Station Package</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="introDEDSSummary.html"><a href="introDEDSSummary.html"><i class="fa fa-check"></i><b>4.7</b> Summary</a></li>
<li class="chapter" data-level="4.8" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>4.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simoa.html"><a href="simoa.html"><i class="fa fa-check"></i><b>5</b> Analyzing and Accessing Simulation Output</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simoadatatypes.html"><a href="simoadatatypes.html"><i class="fa fa-check"></i><b>5.1</b> Types of Statistical Variables</a></li>
<li class="chapter" data-level="5.2" data-path="simoasimtypes.html"><a href="simoasimtypes.html"><i class="fa fa-check"></i><b>5.2</b> Types of Simulation With Respect To Output Analysis</a></li>
<li class="chapter" data-level="5.3" data-path="simoafinhorizon.html"><a href="simoafinhorizon.html"><i class="fa fa-check"></i><b>5.3</b> Analysis of Finite Horizon Simulations</a></li>
<li class="chapter" data-level="5.4" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html"><i class="fa fa-check"></i><b>5.4</b> Capturing Output for a Simple Finite Horizon Simulation</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#simoaCapture"><i class="fa fa-check"></i><b>5.4.1</b> KSL Functionality for Capturing Statistical Results</a></li>
<li class="chapter" data-level="5.4.2" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#additional-remarks"><i class="fa fa-check"></i><b>5.4.2</b> Additional Remarks</a></li>
<li class="chapter" data-level="5.4.3" data-path="simoafinhorizonex.html"><a href="simoafinhorizonex.html#querying-the-ksl-database"><i class="fa fa-check"></i><b>5.4.3</b> Querying the KSL Database</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="simoaseqsampling.html"><a href="simoaseqsampling.html"><i class="fa fa-check"></i><b>5.5</b> Sequential Sampling for Finite Horizon Simulations</a></li>
<li class="chapter" data-level="5.6" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html"><i class="fa fa-check"></i><b>5.6</b> Analysis of Infinite Horizon Simulations</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizoninitialbias"><i class="fa fa-check"></i><b>5.6.1</b> Assessing the Effect of Initial Conditions</a></li>
<li class="chapter" data-level="5.6.2" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonrepDeletion"><i class="fa fa-check"></i><b>5.6.2</b> Performing the Method of Replication-Deletion</a></li>
<li class="chapter" data-level="5.6.3" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonbatchmeans"><i class="fa fa-check"></i><b>5.6.3</b> The Method of Batch Means</a></li>
<li class="chapter" data-level="5.6.4" data-path="simoainfhorizon.html"><a href="simoainfhorizon.html#simoainfhorizonjslbatching"><i class="fa fa-check"></i><b>5.6.4</b> Performing the Method of Batch Means</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html"><i class="fa fa-check"></i><b>5.7</b> Comparing System Configurations</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#simoacomparingSystems:two"><i class="fa fa-check"></i><b>5.7.1</b> Comparing Two Systems</a></li>
<li class="chapter" data-level="5.7.2" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#simoacomparingSystemsMCB"><i class="fa fa-check"></i><b>5.7.2</b> Concepts for Comparing Systems</a></li>
<li class="chapter" data-level="5.7.3" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#multiple-comparison-with-the-best-procedures-mcb"><i class="fa fa-check"></i><b>5.7.3</b> Multiple Comparison with the Best Procedures (MCB)</a></li>
<li class="chapter" data-level="5.7.4" data-path="simoacomparingSystems.html"><a href="simoacomparingSystems.html#ch5Screening"><i class="fa fa-check"></i><b>5.7.4</b> Screening Procedures</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html"><i class="fa fa-check"></i><b>5.8</b> Simulating Many Scenarios</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#controlAntns"><i class="fa fa-check"></i><b>5.8.1</b> Control Annotations</a></li>
<li class="chapter" data-level="5.8.2" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#rvParameters"><i class="fa fa-check"></i><b>5.8.2</b> Random Variable Parameters</a></li>
<li class="chapter" data-level="5.8.3" data-path="ch5Scenarios.html"><a href="ch5Scenarios.html#kslScenarios"><i class="fa fa-check"></i><b>5.8.3</b> Setting Up and Running Multiple Scenarios</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="simoasummary.html"><a href="simoasummary.html"><i class="fa fa-check"></i><b>5.9</b> Summary</a></li>
<li class="chapter" data-level="5.10" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>5.10</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="processview.html"><a href="processview.html"><i class="fa fa-check"></i><b>6</b> Process View Modeling Using the KSL</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch6Entities.html"><a href="ch6Entities.html"><i class="fa fa-check"></i><b>6.1</b> What are Entities?</a></li>
<li class="chapter" data-level="6.2" data-path="pvIntro.html"><a href="pvIntro.html"><i class="fa fa-check"></i><b>6.2</b> The Process View</a></li>
<li class="chapter" data-level="6.3" data-path="understanding-ksl-processes-and-entities.html"><a href="understanding-ksl-processes-and-entities.html"><i class="fa fa-check"></i><b>6.3</b> Understanding KSL Processes and Entities</a></li>
<li class="chapter" data-level="6.4" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html"><i class="fa fa-check"></i><b>6.4</b> Examples of Process Modeling</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html#holding-entities-in-a-queue-holdqueue-class"><i class="fa fa-check"></i><b>6.4.1</b> Holding Entities in a Queue: <code>HoldQueue</code> Class</a></li>
<li class="chapter" data-level="6.4.2" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html#signaling-entities"><i class="fa fa-check"></i><b>6.4.2</b> Signaling Entities</a></li>
<li class="chapter" data-level="6.4.3" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html#understanding-blocking-queues"><i class="fa fa-check"></i><b>6.4.3</b> Understanding Blocking Queues</a></li>
<li class="chapter" data-level="6.4.4" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html#allowing-entities-to-wait-for-a-process"><i class="fa fa-check"></i><b>6.4.4</b> Allowing Entities to Wait for a Process</a></li>
<li class="chapter" data-level="6.4.5" data-path="examples-of-process-modeling.html"><a href="examples-of-process-modeling.html#processinteraction"><i class="fa fa-check"></i><b>6.4.5</b> Process Interaction</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html"><i class="fa fa-check"></i><b>6.5</b> Modeling a STEM Career Mixer</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html#conceptualizing-the-system"><i class="fa fa-check"></i><b>6.5.1</b> Conceptualizing the System</a></li>
<li class="chapter" data-level="6.5.2" data-path="modeling-a-stem-career-mixer.html"><a href="modeling-a-stem-career-mixer.html#implementing-the-stem-mixer-model"><i class="fa fa-check"></i><b>6.5.2</b> Implementing the STEM Mixer Model</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="the-tie-dye-t-shirt-model.html"><a href="the-tie-dye-t-shirt-model.html"><i class="fa fa-check"></i><b>6.6</b> The Tie-Dye T-Shirt Model</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="the-tie-dye-t-shirt-model.html"><a href="the-tie-dye-t-shirt-model.html#ch4:TieDyeTShirtsSub1"><i class="fa fa-check"></i><b>6.6.1</b> Implementing the Tie-Dye T-Shirt Model</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="summary-2.html"><a href="summary-2.html"><i class="fa fa-check"></i><b>6.7</b> Summary</a></li>
<li class="chapter" data-level="6.8" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch7AdvModeling.html"><a href="ch7AdvModeling.html"><i class="fa fa-check"></i><b>7</b> Advanced Event and Process View Modeling</a>
<ul>
<li class="chapter" data-level="7.1" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html"><i class="fa fa-check"></i><b>7.1</b> Modeling with Processes and Resources</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#modeling-space-with-resources"><i class="fa fa-check"></i><b>7.1.1</b> Modeling Space with Resources</a></li>
<li class="chapter" data-level="7.1.2" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#secResourcePools"><i class="fa fa-check"></i><b>7.1.2</b> Resource Pools</a></li>
<li class="chapter" data-level="7.1.3" data-path="modeling-with-processes-and-resources.html"><a href="modeling-with-processes-and-resources.html#secTestAndRepair"><i class="fa fa-check"></i><b>7.1.3</b> Computer Test and Repair Shop Example</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html"><i class="fa fa-check"></i><b>7.2</b> Modeling Non-Stationary Systems</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#ch7secNSPP"><i class="fa fa-check"></i><b>7.2.1</b> Non-Stationary Arrival Processes</a></li>
<li class="chapter" data-level="7.2.2" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#modeling-resources-under-non-stationary-conditions"><i class="fa fa-check"></i><b>7.2.2</b> Modeling Resources Under Non-Stationary Conditions</a></li>
<li class="chapter" data-level="7.2.3" data-path="modeling-non-stationary-systems.html"><a href="modeling-non-stationary-systems.html#enhancing-the-stem-career-mixer-model"><i class="fa fa-check"></i><b>7.2.3</b> Enhancing the STEM Career Mixer Model</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html"><i class="fa fa-check"></i><b>7.3</b> Examples of Advanced Event Models</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html#ch6s1sb4sub3"><i class="fa fa-check"></i><b>7.3.1</b> Modeling Balking and Reneging</a></li>
<li class="chapter" data-level="7.3.2" data-path="examples-of-advanced-event-models.html"><a href="examples-of-advanced-event-models.html#rqModel"><i class="fa fa-check"></i><b>7.3.2</b> Modeling a Reorder Point, Reorder Quantity Inventory Policy</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="ch7VandV.html"><a href="ch7VandV.html"><i class="fa fa-check"></i><b>7.4</b> Applying Queueing Theory Results to Verify and Validate a Simulation</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="ch7VandV.html"><a href="ch7VandV.html#analyzing-the-preparation-station"><i class="fa fa-check"></i><b>7.4.1</b> Analyzing the Preparation Station</a></li>
<li class="chapter" data-level="7.4.2" data-path="ch7VandV.html"><a href="ch7VandV.html#analyzing-the-build-lines"><i class="fa fa-check"></i><b>7.4.2</b> Analyzing the Build Lines</a></li>
<li class="chapter" data-level="7.4.3" data-path="ch7VandV.html"><a href="ch7VandV.html#analyzing-the-packaging-station"><i class="fa fa-check"></i><b>7.4.3</b> Analyzing the Packaging Station</a></li>
<li class="chapter" data-level="7.4.4" data-path="ch7VandV.html"><a href="ch7VandV.html#analyzing-the-palletizing-station"><i class="fa fa-check"></i><b>7.4.4</b> Analyzing the Palletizing Station</a></li>
<li class="chapter" data-level="7.4.5" data-path="ch7VandV.html"><a href="ch7VandV.html#analyzing-the-total-system-time"><i class="fa fa-check"></i><b>7.4.5</b> Analyzing the Total System Time</a></li>
<li class="chapter" data-level="7.4.6" data-path="ch7VandV.html"><a href="ch7VandV.html#other-issues-for-verification-and-validation"><i class="fa fa-check"></i><b>7.4.6</b> Other Issues for Verification and Validation</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="summary-3.html"><a href="summary-3.html"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
<li class="chapter" data-level="7.6" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>7.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chEntityMovement.html"><a href="chEntityMovement.html"><i class="fa fa-check"></i><b>8</b> Modeling Entity Movement</a>
<ul>
<li class="chapter" data-level="8.1" data-path="secRCT.html"><a href="secRCT.html"><i class="fa fa-check"></i><b>8.1</b> Resource Constrained Transfer</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="secRCT.html"><a href="secRCT.html#secTestRepairRCT"><i class="fa fa-check"></i><b>8.1.1</b> Test and Repair with Resource Constrained Transfer</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="movableResources.html"><a href="movableResources.html"><i class="fa fa-check"></i><b>8.2</b> Constrained Transfer with Movable Resources</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="movableResources.html"><a href="movableResources.html#spatial-models"><i class="fa fa-check"></i><b>8.2.1</b> Spatial Models</a></li>
<li class="chapter" data-level="8.2.2" data-path="movableResources.html"><a href="movableResources.html#secMovableResources"><i class="fa fa-check"></i><b>8.2.2</b> Movable Resources</a></li>
<li class="chapter" data-level="8.2.3" data-path="movableResources.html"><a href="movableResources.html#secTQMWM"><i class="fa fa-check"></i><b>8.2.3</b> Tandem Queue Model With Movement</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="secTestAndRepairMovableResources.html"><a href="secTestAndRepairMovableResources.html"><i class="fa fa-check"></i><b>8.3</b> Modeling the Test and Repair System with Movable Resources</a></li>
<li class="chapter" data-level="8.4" data-path="secConveyors.html"><a href="secConveyors.html"><i class="fa fa-check"></i><b>8.4</b> Modeling Systems with Conveyors</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="secConveyors.html"><a href="secConveyors.html#ksl-conveyor-constructs"><i class="fa fa-check"></i><b>8.4.1</b> KSL Conveyor Constructs</a></li>
<li class="chapter" data-level="8.4.2" data-path="secConveyors.html"><a href="secConveyors.html#tandem-queue-system-with-conveyors"><i class="fa fa-check"></i><b>8.4.2</b> Tandem Queue System with Conveyors</a></li>
<li class="chapter" data-level="8.4.3" data-path="secConveyors.html"><a href="secConveyors.html#secTestAndRepairConveyors"><i class="fa fa-check"></i><b>8.4.3</b> Test and Repair via Conveyors</a></li>
<li class="chapter" data-level="8.4.4" data-path="secConveyors.html"><a href="secConveyors.html#secMiscConveyor"><i class="fa fa-check"></i><b>8.4.4</b> Miscellaneous Concepts in Conveyor Modeling</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="summary-of-new-concepts.html"><a href="summary-of-new-concepts.html"><i class="fa fa-check"></i><b>8.5</b> Summary of New Concepts</a></li>
<li class="chapter" data-level="8.6" data-path="exercises-7.html"><a href="exercises-7.html"><i class="fa fa-check"></i><b>8.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch9AdvMC.html"><a href="ch9AdvMC.html"><i class="fa fa-check"></i><b>9</b> Advanced Monte Carlo Methods</a>
<ul>
<li class="chapter" data-level="9.1" data-path="ch9BootStrapping.html"><a href="ch9BootStrapping.html"><i class="fa fa-check"></i><b>9.1</b> Bootstrap Methods</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="ch9BootStrapping.html"><a href="ch9BootStrapping.html#bootstrapping-using-the-ksl"><i class="fa fa-check"></i><b>9.1.1</b> Bootstrapping Using the KSL</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="ch9VRTs.html"><a href="ch9VRTs.html"><i class="fa fa-check"></i><b>9.2</b> Variance Reduction Techniques</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="ch9VRTs.html"><a href="ch9VRTs.html#common-random-numbers-crn"><i class="fa fa-check"></i><b>9.2.1</b> Common Random Numbers (CRN)</a></li>
<li class="chapter" data-level="9.2.2" data-path="ch9VRTs.html"><a href="ch9VRTs.html#antithetic-variates-av"><i class="fa fa-check"></i><b>9.2.2</b> Antithetic Variates (AV)</a></li>
<li class="chapter" data-level="9.2.3" data-path="ch9VRTs.html"><a href="ch9VRTs.html#indirect-estimation"><i class="fa fa-check"></i><b>9.2.3</b> Indirect Estimation</a></li>
<li class="chapter" data-level="9.2.4" data-path="ch9VRTs.html"><a href="ch9VRTs.html#control-variates-cv"><i class="fa fa-check"></i><b>9.2.4</b> Control Variates (CV)</a></li>
<li class="chapter" data-level="9.2.5" data-path="ch9VRTs.html"><a href="ch9VRTs.html#stratified-and-post-stratified-sampling"><i class="fa fa-check"></i><b>9.2.5</b> Stratified and Post Stratified Sampling</a></li>
<li class="chapter" data-level="9.2.6" data-path="ch9VRTs.html"><a href="ch9VRTs.html#conditional-expectation-ce"><i class="fa fa-check"></i><b>9.2.6</b> Conditional Expectation (CE)</a></li>
<li class="chapter" data-level="9.2.7" data-path="ch9VRTs.html"><a href="ch9VRTs.html#importance-sampling-is"><i class="fa fa-check"></i><b>9.2.7</b> Importance Sampling (IS)</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html"><i class="fa fa-check"></i><b>9.3</b> Generating Multi-Variate and Correlated Random Variates</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#generating-from-a-bivariate-normal-distribution"><i class="fa fa-check"></i><b>9.3.1</b> Generating from a Bivariate Normal Distribution</a></li>
<li class="chapter" data-level="9.3.2" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#copulas-and-multi-variate-generation-methods"><i class="fa fa-check"></i><b>9.3.2</b> Copulas and Multi-variate Generation Methods</a></li>
<li class="chapter" data-level="9.3.3" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#autocorrelated-generation"><i class="fa fa-check"></i><b>9.3.3</b> Autocorrelated Generation</a></li>
<li class="chapter" data-level="9.3.4" data-path="ch9GMVRVs.html"><a href="ch9GMVRVs.html#ch9MCMC"><i class="fa fa-check"></i><b>9.3.4</b> Introduction to Markov Chain Monte Carlo Methods</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="summary-4.html"><a href="summary-4.html"><i class="fa fa-check"></i><b>9.4</b> Summary</a></li>
<li class="chapter" data-level="9.5" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch10eo.html"><a href="ch10eo.html"><i class="fa fa-check"></i><b>10</b> Experimental Design and Simulation Optimization Methods</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ch10doe.html"><a href="ch10doe.html"><i class="fa fa-check"></i><b>10.1</b> Experimental Design Methods</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="ch10doe.html"><a href="ch10doe.html#ch10factors"><i class="fa fa-check"></i><b>10.1.1</b> Defining Factors</a></li>
<li class="chapter" data-level="10.1.2" data-path="ch10doe.html"><a href="ch10doe.html#ch10designs"><i class="fa fa-check"></i><b>10.1.2</b> Defining Experimental Designs</a></li>
<li class="chapter" data-level="10.1.3" data-path="ch10doe.html"><a href="ch10doe.html#ch10exp"><i class="fa fa-check"></i><b>10.1.3</b> Executing a Designed Experiment</a></li>
<li class="chapter" data-level="10.1.4" data-path="ch10doe.html"><a href="ch10doe.html#ch10analysis"><i class="fa fa-check"></i><b>10.1.4</b> Analyzing a Designed Experiment</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="ch10simOpt.html"><a href="ch10simOpt.html"><i class="fa fa-check"></i><b>10.2</b> Simulation Optimization Methods</a></li>
<li class="chapter" data-level="10.3" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html"><i class="fa fa-check"></i><b>10.3</b> Defining Simulation Optimization Problems</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html#specifying-penalty-functions"><i class="fa fa-check"></i><b>10.3.1</b> Specifying Penalty Functions</a></li>
<li class="chapter" data-level="10.3.2" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html#inputvariables"><i class="fa fa-check"></i><b>10.3.2</b> Defining Input Variables</a></li>
<li class="chapter" data-level="10.3.3" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html#linear-and-functional-constraints"><i class="fa fa-check"></i><b>10.3.3</b> Linear and Functional Constraints</a></li>
<li class="chapter" data-level="10.3.4" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html#response-constraints"><i class="fa fa-check"></i><b>10.3.4</b> Response Constraints</a></li>
<li class="chapter" data-level="10.3.5" data-path="ch10ProbDefn.html"><a href="ch10ProbDefn.html#ch10ProbDefnExample"><i class="fa fa-check"></i><b>10.3.5</b> Setting Up a Problem Definition</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="representing-the-simulation-oracle.html"><a href="representing-the-simulation-oracle.html"><i class="fa fa-check"></i><b>10.4</b> Representing the Simulation Oracle</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="representing-the-simulation-oracle.html"><a href="representing-the-simulation-oracle.html#requesting-simulation-evaluations"><i class="fa fa-check"></i><b>10.4.1</b> Requesting Simulation Evaluations</a></li>
<li class="chapter" data-level="10.4.2" data-path="representing-the-simulation-oracle.html"><a href="representing-the-simulation-oracle.html#representing-model-inputs"><i class="fa fa-check"></i><b>10.4.2</b> Representing Model Inputs</a></li>
<li class="chapter" data-level="10.4.3" data-path="representing-the-simulation-oracle.html"><a href="representing-the-simulation-oracle.html#representing-model-outputs"><i class="fa fa-check"></i><b>10.4.3</b> Representing Model Outputs</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="characterizing-simulation-optimization-algorithms.html"><a href="characterizing-simulation-optimization-algorithms.html"><i class="fa fa-check"></i><b>10.5</b> Characterizing Simulation Optimization Algorithms</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="characterizing-simulation-optimization-algorithms.html"><a href="characterizing-simulation-optimization-algorithms.html#structure-of-the-iterative-process"><i class="fa fa-check"></i><b>10.5.1</b> Structure of the Iterative Process</a></li>
<li class="chapter" data-level="10.5.2" data-path="characterizing-simulation-optimization-algorithms.html"><a href="characterizing-simulation-optimization-algorithms.html#solver-plug-in-behavior"><i class="fa fa-check"></i><b>10.5.2</b> Solver Plug-in Behavior</a></li>
<li class="chapter" data-level="10.5.3" data-path="characterizing-simulation-optimization-algorithms.html"><a href="characterizing-simulation-optimization-algorithms.html#miscellaneous-concepts-in-the-solver-class"><i class="fa fa-check"></i><b>10.5.3</b> Miscellaneous Concepts in the <code>Solver</code> Class</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="implemented-solvers.html"><a href="implemented-solvers.html"><i class="fa fa-check"></i><b>10.6</b> Implemented Solvers</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="implemented-solvers.html"><a href="implemented-solvers.html#simulated-annealing"><i class="fa fa-check"></i><b>10.6.1</b> Simulated Annealing</a></li>
<li class="chapter" data-level="10.6.2" data-path="implemented-solvers.html"><a href="implemented-solvers.html#cross-entropy"><i class="fa fa-check"></i><b>10.6.2</b> Cross Entropy</a></li>
<li class="chapter" data-level="10.6.3" data-path="implemented-solvers.html"><a href="implemented-solvers.html#r-spline"><i class="fa fa-check"></i><b>10.6.3</b> R-SPLINE</a></li>
<li class="chapter" data-level="10.6.4" data-path="implemented-solvers.html"><a href="implemented-solvers.html#randomized-restart-solvers"><i class="fa fa-check"></i><b>10.6.4</b> Randomized Restart Solvers</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="secApplySolver.html"><a href="secApplySolver.html"><i class="fa fa-check"></i><b>10.7</b> Using a Solver on a Problem</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="secApplySolver.html"><a href="secApplySolver.html#applyCE"><i class="fa fa-check"></i><b>10.7.1</b> Illustrating the Cross-Entropy Solver</a></li>
<li class="chapter" data-level="10.7.2" data-path="secApplySolver.html"><a href="secApplySolver.html#illustrating-simulated-annealing-with-random-restarts"><i class="fa fa-check"></i><b>10.7.2</b> Illustrating Simulated Annealing with Random Restarts</a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="summary-5.html"><a href="summary-5.html"><i class="fa fa-check"></i><b>10.8</b> Summary</a></li>
<li class="chapter" data-level="10.9" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i><b>10.9</b> Exercises</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="appRNRV.html"><a href="appRNRV.html"><i class="fa fa-check"></i><b>A</b> Generating Pseudo-Random Numbers and Random Variates</a>
<ul>
<li class="chapter" data-level="A.1" data-path="appRNRVPRN.html"><a href="appRNRVPRN.html"><i class="fa fa-check"></i><b>A.1</b> Pseudo Random Numbers</a>
<ul>
<li class="chapter" data-level="A.1.1" data-path="appRNRVPRN.html"><a href="appRNRVPRN.html#appRNRVRNGs"><i class="fa fa-check"></i><b>A.1.1</b> Random Number Generators</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="appRNRVs.html"><a href="appRNRVs.html"><i class="fa fa-check"></i><b>A.2</b> Generating Random Variates from Distributions</a>
<ul>
<li class="chapter" data-level="A.2.1" data-path="appRNRVs.html"><a href="appRNRVs.html#inverse-transform-method"><i class="fa fa-check"></i><b>A.2.1</b> Inverse Transform Method</a></li>
<li class="chapter" data-level="A.2.2" data-path="appRNRVs.html"><a href="appRNRVs.html#convolution"><i class="fa fa-check"></i><b>A.2.2</b> Convolution</a></li>
<li class="chapter" data-level="A.2.3" data-path="appRNRVs.html"><a href="appRNRVs.html#acceptancerejection"><i class="fa fa-check"></i><b>A.2.3</b> Acceptance/Rejection</a></li>
<li class="chapter" data-level="A.2.4" data-path="appRNRVs.html"><a href="appRNRVs.html#AppRNRVsubsecMTSRV"><i class="fa fa-check"></i><b>A.2.4</b> Mixture Distributions, Truncated Distributions, and Shifted Random Variables</a></li>
</ul></li>
<li class="chapter" data-level="A.3" data-path="summary-6.html"><a href="summary-6.html"><i class="fa fa-check"></i><b>A.3</b> Summary</a></li>
<li class="chapter" data-level="A.4" data-path="exercises-10.html"><a href="exercises-10.html"><i class="fa fa-check"></i><b>A.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appidm.html"><a href="appidm.html"><i class="fa fa-check"></i><b>B</b> Probability Distribution Modeling</a>
<ul>
<li class="chapter" data-level="B.1" data-path="appidmsecrvPD.html"><a href="appidmsecrvPD.html"><i class="fa fa-check"></i><b>B.1</b> Random Variables and Probability Distributions</a></li>
<li class="chapter" data-level="B.2" data-path="appidmsecMDD.html"><a href="appidmsecMDD.html"><i class="fa fa-check"></i><b>B.2</b> Modeling with Discrete Distributions</a></li>
<li class="chapter" data-level="B.3" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html"><i class="fa fa-check"></i><b>B.3</b> Fitting Discrete Distributions</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#AppDisFitPoissonFit"><i class="fa fa-check"></i><b>B.3.1</b> Fitting a Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.2" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#visualizing-the-data"><i class="fa fa-check"></i><b>B.3.2</b> Visualizing the Data</a></li>
<li class="chapter" data-level="B.3.3" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#estimating-the-rate-parameter-for-the-poisson-distribution"><i class="fa fa-check"></i><b>B.3.3</b> Estimating the Rate Parameter for the Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.4" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#chi-squared-goodness-of-fit-test-for-poisson-distribution"><i class="fa fa-check"></i><b>B.3.4</b> Chi-Squared Goodness of Fit Test for Poisson Distribution</a></li>
<li class="chapter" data-level="B.3.5" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#subsubchisqGOF"><i class="fa fa-check"></i><b>B.3.5</b> Chi-Squared Goodness of Fit Test</a></li>
<li class="chapter" data-level="B.3.6" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#using-the-fitdistrplus-r-package-on-discrete-data"><i class="fa fa-check"></i><b>B.3.6</b> Using the fitdistrplus R Package on Discrete Data</a></li>
<li class="chapter" data-level="B.3.7" data-path="appidmsecfitDiscrete.html"><a href="appidmsecfitDiscrete.html#fitting-a-discrete-empirical-distribution"><i class="fa fa-check"></i><b>B.3.7</b> Fitting a Discrete Empirical Distribution</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="appidmsecMCD.html"><a href="appidmsecMCD.html"><i class="fa fa-check"></i><b>B.4</b> Modeling with Continuous Distributions</a></li>
<li class="chapter" data-level="B.5" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html"><i class="fa fa-check"></i><b>B.5</b> Fitting Continuous Distributions</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecvisualizedata"><i class="fa fa-check"></i><b>B.5.1</b> Visualizing the Data</a></li>
<li class="chapter" data-level="B.5.2" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecstatsdata"><i class="fa fa-check"></i><b>B.5.2</b> Statistically Summarize the Data</a></li>
<li class="chapter" data-level="B.5.3" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsechypothDist"><i class="fa fa-check"></i><b>B.5.3</b> Hypothesizing and Testing a Distribution</a></li>
<li class="chapter" data-level="B.5.4" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#kolmogorov-smirnov-test"><i class="fa fa-check"></i><b>B.5.4</b> Kolmogorov-Smirnov Test</a></li>
<li class="chapter" data-level="B.5.5" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidmsubsecvisFit"><i class="fa fa-check"></i><b>B.5.5</b> Visualizing the Fit</a></li>
<li class="chapter" data-level="B.5.6" data-path="appidmsecfitContinuous.html"><a href="appidmsecfitContinuous.html#appidms2sb3"><i class="fa fa-check"></i><b>B.5.6</b> Using the Input Analyzer</a></li>
</ul></li>
<li class="chapter" data-level="B.6" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html"><i class="fa fa-check"></i><b>B.6</b> Testing Uniform (0,1) Pseudo-Random Numbers</a>
<ul>
<li class="chapter" data-level="B.6.1" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#chi-squared-goodness-of-fit-tests-for-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.1</b> Chi-Squared Goodness of Fit Tests for Pseudo-Random Numbers</a></li>
<li class="chapter" data-level="B.6.2" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#higher-dimensional-chi-squared-test"><i class="fa fa-check"></i><b>B.6.2</b> Higher Dimensional Chi-Squared Test</a></li>
<li class="chapter" data-level="B.6.3" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#kolmogorov-smirnov-test-for-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.3</b> Kolmogorov-Smirnov Test for Pseudo-Random Numbers</a></li>
<li class="chapter" data-level="B.6.4" data-path="appdistfittestU01.html"><a href="appdistfittestU01.html#testing-for-independence-and-patterns-in-pseudo-random-numbers"><i class="fa fa-check"></i><b>B.6.4</b> Testing for Independence and Patterns in Pseudo-Random Numbers</a></li>
</ul></li>
<li class="chapter" data-level="B.7" data-path="appdistfitidms2sb4.html"><a href="appdistfitidms2sb4.html"><i class="fa fa-check"></i><b>B.7</b> Additional Distribution Modeling Concepts</a></li>
<li class="chapter" data-level="B.8" data-path="appidmSummary.html"><a href="appidmSummary.html"><i class="fa fa-check"></i><b>B.8</b> Summary</a></li>
<li class="chapter" data-level="B.9" data-path="exercises-11.html"><a href="exercises-11.html"><i class="fa fa-check"></i><b>B.9</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="appqtAndInvT.html"><a href="appqtAndInvT.html"><i class="fa fa-check"></i><b>C</b> Queueing Theory</a>
<ul>
<li class="chapter" data-level="C.1" data-path="appqts1.html"><a href="appqts1.html"><i class="fa fa-check"></i><b>C.1</b> Single Line Queueing Stations</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="appqts1.html"><a href="appqts1.html#queueing-notation"><i class="fa fa-check"></i><b>C.1.1</b> Queueing Notation</a></li>
<li class="chapter" data-level="C.1.2" data-path="appqts1.html"><a href="appqts1.html#littles-formula"><i class="fa fa-check"></i><b>C.1.2</b> Little’s Formula</a></li>
<li class="chapter" data-level="C.1.3" data-path="appqts1.html"><a href="appqts1.html#appqts1sb1"><i class="fa fa-check"></i><b>C.1.3</b> Deriving Formulas for Markovian Single Queue Systems</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="appqts1sb2.html"><a href="appqts1sb2.html"><i class="fa fa-check"></i><b>C.2</b> Examples and Applications of Queueing Analysis</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="appqts1sb2.html"><a href="appqts1sb2.html#infinite-queue-examples"><i class="fa fa-check"></i><b>C.2.1</b> Infinite Queue Examples</a></li>
<li class="chapter" data-level="C.2.2" data-path="appqts1sb2.html"><a href="appqts1sb2.html#finite-queue-examples"><i class="fa fa-check"></i><b>C.2.2</b> Finite Queue Examples</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="appqts1sb3.html"><a href="appqts1sb3.html"><i class="fa fa-check"></i><b>C.3</b> Non-Markovian Queues and Approximations</a></li>
<li class="chapter" data-level="C.4" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html"><i class="fa fa-check"></i><b>C.4</b> Summary of Queueing Formulas</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1-queue"><i class="fa fa-check"></i><b>C.4.1</b> M/M/1 Queue</a></li>
<li class="chapter" data-level="C.4.2" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmc-queue"><i class="fa fa-check"></i><b>C.4.2</b> M/M/c Queue</a></li>
<li class="chapter" data-level="C.4.3" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmck-queue"><i class="fa fa-check"></i><b>C.4.3</b> M/M/c/k Queue</a></li>
<li class="chapter" data-level="C.4.4" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mgcc-queue"><i class="fa fa-check"></i><b>C.4.4</b> M/G/c/c Queue</a></li>
<li class="chapter" data-level="C.4.5" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1k-queue"><i class="fa fa-check"></i><b>C.4.5</b> M/M/1/k Queue</a></li>
<li class="chapter" data-level="C.4.6" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmck-queue-1"><i class="fa fa-check"></i><b>C.4.6</b> M/M/c/k Queue</a></li>
<li class="chapter" data-level="C.4.7" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mm1kk-queue"><i class="fa fa-check"></i><b>C.4.7</b> M/M/1/k/k Queue</a></li>
<li class="chapter" data-level="C.4.8" data-path="appqtsecformulas.html"><a href="appqtsecformulas.html#mmckk-queue"><i class="fa fa-check"></i><b>C.4.8</b> M/M/c/k/k Queue</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="exercises-12.html"><a href="exercises-12.html"><i class="fa fa-check"></i><b>C.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="D" data-path="appUtilities.html"><a href="appUtilities.html"><i class="fa fa-check"></i><b>D</b> KSL Utility Packages</a>
<ul>
<li class="chapter" data-level="D.1" data-path="the-outputdirectory-class-and-ksl-object.html"><a href="the-outputdirectory-class-and-ksl-object.html"><i class="fa fa-check"></i><b>D.1</b> The <code>OutputDirectory</code> Class and <code>KSL</code> Object</a></li>
<li class="chapter" data-level="D.2" data-path="logging-options.html"><a href="logging-options.html"><i class="fa fa-check"></i><b>D.2</b> Logging Options</a></li>
<li class="chapter" data-level="D.3" data-path="the-kslfileutil-object.html"><a href="the-kslfileutil-object.html"><i class="fa fa-check"></i><b>D.3</b> The <code>KSLFileUtil</code> Object</a></li>
<li class="chapter" data-level="D.4" data-path="appDCSVEtc.html"><a href="appDCSVEtc.html"><i class="fa fa-check"></i><b>D.4</b> CSV, Excel, and Tabular Data Files</a></li>
<li class="chapter" data-level="D.5" data-path="dfUtil.html"><a href="dfUtil.html"><i class="fa fa-check"></i><b>D.5</b> The <code>DataFrameUtil</code> Object</a></li>
<li class="chapter" data-level="D.6" data-path="ksl-database-utilities.html"><a href="ksl-database-utilities.html"><i class="fa fa-check"></i><b>D.6</b> KSL Database Utilities</a></li>
<li class="chapter" data-level="D.7" data-path="appUtilitiesArrays.html"><a href="appUtilitiesArrays.html"><i class="fa fa-check"></i><b>D.7</b> Array Utilities</a></li>
<li class="chapter" data-level="D.8" data-path="appPlotting.html"><a href="appPlotting.html"><i class="fa fa-check"></i><b>D.8</b> KSL Plotting Utilities</a></li>
<li class="chapter" data-level="D.9" data-path="appUtilitiesMisc.html"><a href="appUtilitiesMisc.html"><i class="fa fa-check"></i><b>D.9</b> Miscellaneous Utilities</a></li>
</ul></li>
<li class="chapter" data-level="E" data-path="distributions.html"><a href="distributions.html"><i class="fa fa-check"></i><b>E</b> Distributions</a>
<ul>
<li class="chapter" data-level="E.1" data-path="appDiscreteDistributions.html"><a href="appDiscreteDistributions.html"><i class="fa fa-check"></i><b>E.1</b> Discrete Distrbutions</a></li>
<li class="chapter" data-level="E.2" data-path="appContinuousDistributions.html"><a href="appContinuousDistributions.html"><i class="fa fa-check"></i><b>E.2</b> Continuous Distrbutions</a></li>
</ul></li>
<li class="chapter" data-level="F" data-path="appStatTables.html"><a href="appStatTables.html"><i class="fa fa-check"></i><b>F</b> Statistical Tables</a></li>
<li class="chapter" data-level="G" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>G</b> References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="_blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulation Modeling using the Kotlin Simulation Library (KSL)</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="distFitting" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Distribution Fitting Using the KSL<a href="distFitting.html#distFitting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This section describes how to apply the methods discussed in Appendix <a href="appidm.html#appidm">B</a> to fit probability distributions using the KSL. The package <code>ksl.utilities.distributions.fitting</code> contains classes that facilitate the estimation of the parameters of discrete and continuous probability distributions. In addition, the quality of the estimated parameters can be examined based on a number of metrics that measure the goodness of fit of the probability model to the data. Finally, there is functionality that will automatically fit a set of possible distributions to a data set and recommend the best distribution based on a combination of metrics. This section will first describe the organization of the functionality related to parameter estimation. Then, the scoring models for measuring the quality of fit will be presented. Finally, a number of examples will illustrate the use of the classes on the data from the examples discussed in Appendix <a href="appidm.html#appidm">B</a>.</p>
<div id="estimating-distribution-parameters" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Estimating Distribution Parameters<a href="distFitting.html#estimating-distribution-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As discussed in Appendix <a href="appidm.html#appidm">B</a> a key step in the distribution fitting process is estimating the parameters of the hypothesized probability model. For example, if we want to fit a normal distribution to the data, we must estimate the mean (<span class="math inline">\(\mu\)</span>) and the variance (<span class="math inline">\(\sigma^2\)</span>) of the associated distribution. Each distribution may be specified by different parameters. For example, the gamma distribution is specified by the shape (<span class="math inline">\(\alpha\)</span>) and scale (<span class="math inline">\(\beta\)</span>) parameters. Appendix <a href="appDiscreteDistributions.html#appDiscreteDistributions">E.1</a> and <a href="appContinuousDistributions.html#appContinuousDistributions">E.2</a> provide a listing of many common distributions and their parameters.</p>
<p>The estimation of the parameters of a distribution requires the execution of an algorithm. As mentioned in Appendix <a href="appidm.html#appidm">B</a>, the maximum likelihood estimation method is commonly used because it often produces estimates that have desirable statistical properties. However, the maximum likelihood method may require the solving of a non-linear optimization problem. The method of moments is also a common algorithm that is used to estimate the parameters of various distributions. In the method of moments, the theoretical moment equations are matched with the statistically computed moments resulting in a set of equations that must be solved to form the parameter estimators. In some cases, the method of moments results in simple equations, but for some distributions it may result in the need to solve a system of non-linear equations. Many other methods of parameter estimation exist, such as the percentile method, which may be general or targeted to specific distributions. The KSL facilitates the development of routines to estimate parameters by providing a well-defined parameter estimation interface. By implementing the <code>ParameterEstimatorIfc</code> interface, KSL users can incorporate additional distributions and estimation methods into the estimation framework.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ParameterEstimatorLabel"></span>
<img src="figures2/ch2/ParameterEstimatorIfc.png" alt="Important Classes for Parameter Estimation" width="80%" height="80%" />
<p class="caption">
Figure 2.7: Important Classes for Parameter Estimation
</p>
</div>
<p>Figure <a href="distFitting.html#fig:ParameterEstimatorLabel">2.7</a> illustrates some of the key classes and interfaces involved in the parameter estimation framework. The functionality starts with the <code>ParameterEstimatorIfc</code> interface, which requires the implementation of the estimation routine and a property (<code>checkRange</code>) to indicate if the data should be checked for shifting onto the domain of the distribution. The <code>ParameterEstimatorIfc</code> interface defines a general function that uses a 1-dimensional data array, and estimates the parameters of an hypothesized uni-variate distribution via some estimation algorithm. It is important to note that a distribution may have more than one method for estimating its parameters. In the figure, the maximum likelihood estimator for the gamma distribution is illustrated; however, for example, there is also a method of moments estimator for the gamma distribution implemented within the KSL distribution fitting framework.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb39-1"><a href="distFitting.html#cb39-1" tabindex="-1"></a><span class="kw">interface</span> ParameterEstimatorIfc <span class="op">{</span></span>
<span id="cb39-2"><a href="distFitting.html#cb39-2" tabindex="-1"></a></span>
<span id="cb39-3"><a href="distFitting.html#cb39-3" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb39-4"><a href="distFitting.html#cb39-4" tabindex="-1"></a><span class="co">     *  Indicates if the estimator requires that the range of the data be checked for a shift</span></span>
<span id="cb39-5"><a href="distFitting.html#cb39-5" tabindex="-1"></a><span class="co">     *  before the estimation process.</span></span>
<span id="cb39-6"><a href="distFitting.html#cb39-6" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb39-7"><a href="distFitting.html#cb39-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">checkRange</span><span class="op">:</span> <span class="kw">Boolean</span></span>
<span id="cb39-8"><a href="distFitting.html#cb39-8" tabindex="-1"></a></span>
<span id="cb39-9"><a href="distFitting.html#cb39-9" tabindex="-1"></a>    <span class="co">/**</span></span>
<span id="cb39-10"><a href="distFitting.html#cb39-10" tabindex="-1"></a><span class="co">     *  Estimates the parameters associated with some distribution. The returned [EstimationResult]</span></span>
<span id="cb39-11"><a href="distFitting.html#cb39-11" tabindex="-1"></a><span class="co">     *  needs to be consistent with the intent of the desired distribution.</span></span>
<span id="cb39-12"><a href="distFitting.html#cb39-12" tabindex="-1"></a><span class="co">     *  Note the meaning of the fields associated with [EstimationResult]</span></span>
<span id="cb39-13"><a href="distFitting.html#cb39-13" tabindex="-1"></a><span class="co">     */</span></span>
<span id="cb39-14"><a href="distFitting.html#cb39-14" tabindex="-1"></a>    <span class="kw">fun</span> <span class="fu">estimateParameters</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">,</span> <span class="va">statistics</span><span class="op">:</span> <span class="dt">StatisticIfc</span> <span class="op">=</span> Statistic<span class="op">(</span>data<span class="op">)):</span> <span class="dt">EstimationResult</span></span>
<span id="cb39-15"><a href="distFitting.html#cb39-15" tabindex="-1"></a>}</span></code></pre></div>
<p>The basic contract for the estimation process is that the returned <code>EstimationResult</code> is consistent with the required parameter estimation. The data class <code>EstimationResult</code> stores information about the estimation process to be returned as a result of its application on the supplied data. The key property is the <code>success</code> property, which indicates whether the parameter estimation process was successful. Given that many estimation processes may require advanced optimization methods, the estimation process might not converge or some other problem might have occurred. If the <code>success</code> property is true, then the results should be meaningful. The <code>EstimationResult</code> also returns the estimator that was used (<code>MVBSestimatorIfc</code>) in a form that can be used within KSL bootstrapping constructs, the estimated parameters as an instance of <code>RVParameters,</code> a message concerning the estimation process, a text (string) representation of the distribution and its parameters, the original data (<code>originalData</code>), the shifted data if shifted, the statistics associated with the original data, and data that is suitable for testing for goodness of fit (<code>testData</code>). The <code>MVBSestimatorIfc</code> interface defines a method that takes in an array of data and produces a (double) array that holds the estimated parameters. In addition, the interface defines a list of the names to use for the parameters. This form for the estimation results facilitates performing a bootstrapping process that can provide confidence intervals for the estimated parameters.</p>
<div class="example">
<p><span id="exm:ch2ex23" class="example"><strong>Example 2.23  (Parameter Estimation) </strong></span>The following code illustrates the estimation of the parameters for a normal distribution.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb40-1"><a href="distFitting.html#cb40-1" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">(){</span></span>
<span id="cb40-2"><a href="distFitting.html#cb40-2" tabindex="-1"></a>    <span class="co">// define a normal random variable,</span></span>
<span id="cb40-3"><a href="distFitting.html#cb40-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">x</span> <span class="op">=</span> NormalRV<span class="op">(</span><span class="fl">2.0</span><span class="op">,</span> <span class="fl">5.0</span><span class="op">,</span> streamNum <span class="op">=</span> <span class="dv">1</span><span class="op">)</span></span>
<span id="cb40-4"><a href="distFitting.html#cb40-4" tabindex="-1"></a>    <span class="co">// generate some data</span></span>
<span id="cb40-5"><a href="distFitting.html#cb40-5" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> x<span class="op">.</span>sample<span class="op">(</span><span class="dv">100</span><span class="op">)</span></span>
<span id="cb40-6"><a href="distFitting.html#cb40-6" tabindex="-1"></a>    <span class="co">// create the estimator</span></span>
<span id="cb40-7"><a href="distFitting.html#cb40-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">ne</span> <span class="op">=</span> NormalMLEParameterEstimator</span>
<span id="cb40-8"><a href="distFitting.html#cb40-8" tabindex="-1"></a>    <span class="co">// estimate the parameters</span></span>
<span id="cb40-9"><a href="distFitting.html#cb40-9" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">result</span> <span class="op">=</span> ne<span class="op">.</span>estimateParameters<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb40-10"><a href="distFitting.html#cb40-10" tabindex="-1"></a>    println<span class="op">(</span>result<span class="op">)</span></span>
<span id="cb40-11"><a href="distFitting.html#cb40-11" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">bss</span> <span class="op">=</span> BootstrapSampler<span class="op">(</span><span class="kw">data</span><span class="op">,</span> ne<span class="op">)</span></span>
<span id="cb40-12"><a href="distFitting.html#cb40-12" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">list</span> <span class="op">=</span> bss<span class="op">.</span>bootStrapEstimates<span class="op">(</span><span class="dv">400</span><span class="op">)</span></span>
<span id="cb40-13"><a href="distFitting.html#cb40-13" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>element <span class="kw">in</span> list<span class="op">)</span> <span class="op">{</span></span>
<span id="cb40-14"><a href="distFitting.html#cb40-14" tabindex="-1"></a>        println<span class="op">(</span>element<span class="op">.</span>toString<span class="op">())</span></span>
<span id="cb40-15"><a href="distFitting.html#cb40-15" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb40-16"><a href="distFitting.html#cb40-16" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<p>The results of this estimation process are show here. Notice that the estimation process was successful and the summary statistics were reported. The data was not shifted for the estimation process and the estimated parameters were <span class="math inline">\(\mu = 2.4138851463671918\)</span> and <span class="math inline">\(\sigma^2 = 5.571943618235626\)</span>. The bootstrapping process, see Section <a href="ch9BootStrapping.html#ch9BootStrapping">9.1</a> of Chapter <a href="ch9AdvMC.html#ch9AdvMC">9</a> was used to provide confidence intervals on the estimated parameters. This functionality is available for any of the distributions and the estimation routines that have been defined within the KSL.</p>
<pre><code>Estimation Results:
The estimation was a SUCCESS!
Estimation message:
The normal parameters were estimated successfully using a MLE technique

Statistics for the data:
ID 4
Name Statistic_1
Number 100.0
Average 2.0892468525989156
Standard Deviation 2.123930458872048
Standard Error 0.2123930458872048
Half-width 0.4214338787318177
Confidence Level 0.95
Confidence Interval [1.667812973867098, 2.5106807313307336]
Minimum -4.430752220590554
Maximum 6.493367339631967
Sum 208.92468525989156
Variance 4.5110805941244285
Deviation Sum of Squares 446.5969788183184
Last value collected 3.5738686354135556
Kurtosis -0.2314557519668217
Skewness -0.2890094690738773
Lag 1 Covariance -0.40973073091033607
Lag 1 Correlation -0.09174507449523522
Von Neumann Lag 1 Test Statistic -0.8229876116312043
Number of missing observations 0.0
Lead-Digit Rule(1) -1


Shift estimation results:
null

Estimated parameters:
RV Type = Normal
Double Parameters {mean=2.0892468525989156, variance=4.5110805941244285}

------------------------------------------------------
Bootstrap statistical results:
------------------------------------------------------
statistic name = mean
number of bootstrap samples = 400
size of original sample = 100
original estimate = 2.0892468525989156
bias estimate = -0.01587415275757076
across bootstrap average = 2.073372699841345
bootstrap std. err. estimate = 0.21341609857688634
default c.i. level = 0.95
norm c.i. = [1.670958985329941, 2.5075347198678903]
basic c.i. = [1.6728521695280434, 2.506080452483194]
percentile c.i. = [1.6724132527146374, 2.505641535669788]

------------------------------------------------------
Bootstrap statistical results:
------------------------------------------------------
statistic name = variance
number of bootstrap samples = 400
size of original sample = 100
original estimate = 4.5110805941244285
bias estimate = -0.013680373758844233
across bootstrap average = 4.497400220365584
bootstrap std. err. estimate = 0.6474490755210855
default c.i. level = 0.95
norm c.i. = [3.2421037232562866, 5.78005746499257]
basic c.i. = [3.163271658068438, 5.717662725018807]
percentile c.i. = [3.3044984632300505, 5.858889530180419]</code></pre>
<p>The parameters of the following distributions can be estimated from data using the KSL.</p>
<ul>
<li>Beta - via <code>BetaMOMParameterEstimator</code></li>
<li>Binomial - via <code>BinomialMaxParameterEstimator</code> or <code>BinomialMOMParameterEstimator</code></li>
<li>Exponential - via <code>ExponentialMLEEstimator</code></li>
<li>Gamma - via <code>GammaMLEParameterEstimator</code> or <code>GammaMOMParameterEstimator</code></li>
<li>Generalized Beta - via <code>GeneralizedBetaMOMParameterEstimator</code></li>
<li>Laplace - via <code>LaplaceMLEParameterEstimator</code></li>
<li>Logistic - via <code>LogisticMOMParameterEstimator</code></li>
<li>Lognormal - via <code>LognormalMLEParameterEstimator</code></li>
<li>Negative Binomial - via <code>NegBinomialMOMParameterEstimator</code></li>
<li>Normal - via <code>NormalMLEParameterEstimator</code></li>
<li>Pearson Type 5 - via <code>PearsonType5MLEParameterEstimator</code></li>
<li>Poisson - via <code>PoissonMLEParameterEstimator</code></li>
<li>Triangular - via <code>TriangularParameterEstimator</code></li>
<li>Uniform - via <code>UniformParameterEstimator</code></li>
<li>Weibull - via <code>WeibullMLEParameterEstimator</code> or <code>WeibullPercentileParameterEstimator</code></li>
</ul>
<p>Again, by implementing the concepts illustrated in Figure <a href="distFitting.html#fig:ParameterEstimatorLabel">2.7</a>, a KSL user can implement additional distribution parameter estimation methods. If you need to fit a distribution that is not modeled within the KSL, then you need to implement the distribution’s parameter estimation procedure. In addition, you will also need to implement a class representing the distribution. Depending on the type of distribution, this may involve implementing the requirements of the <code>ContinuousDistributionIfc</code> interface or the <code>DiscreteDistributionIfc</code> interface for the underlying probability model.</p>
</div>
<div id="continuous-distribution-recommendation-framework" class="section level3 hasAnchor" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Continuous Distribution Recommendation Framework<a href="distFitting.html#continuous-distribution-recommendation-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As described in Appendix <a href="appidm.html#appidm">B</a>, the distribution modeling process may require that the parameters of many distributions be estimated and the quality of those probability models examined to recommend an overall distribution. This process normally involves statistical tests or metrics (e.g. square error criterion) to assess how well the probability model represents the data.</p>
<p>Rather than relying on statistical tests, the KSL’s distribution recommendation framework defines a set of criteria for assessing the quality of the probability model’s representation. These criteria are called <em>scoring models</em>. Figure <a href="distFitting.html#fig:ScoringModelLabel">2.8</a> illustrates the scoring models that the KSL uses within its automated fitting process. To implement your own scoring model, you need to sub-class from the abstract base class <code>PDFScoringModel.</code></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ScoringModelLabel"></span>
<img src="figures2/ch2/PDFScoringModel.png" alt="Important Classes for PDF Scoring" width="80%" height="80%" />
<p class="caption">
Figure 2.8: Important Classes for PDF Scoring
</p>
</div>
<p>The primary method that needs to be implemented is the abstract <code>score()</code> function.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb42-1"><a href="distFitting.html#cb42-1" tabindex="-1"></a><span class="kw">abstract</span> <span class="kw">fun</span> <span class="fu">score</span><span class="op">(</span><span class="kw">data</span><span class="op">:</span> <span class="dt">DoubleArray</span><span class="op">,</span> <span class="va">cdf</span><span class="op">:</span> <span class="dt">ContinuousDistributionIfc</span><span class="op">)</span> <span class="op">:</span> <span class="dt">Score</span></span></code></pre></div>
<p>The contract for this function is that it will return a numerical value that measures the quality of the distribution fit given the observed data and a hypothesized continuous distribution function. In addition, the function, <code>badScore(),</code> should return the worse possible score for the metric. The <code>badScore()</code> function should be used if there is some error or issue that prevents the scoring procedure from determining a score for the fit. A <code>Score</code> is a data class that indicates whether the score is <code>valid</code> or not and provides the metric that determined the score. You can think of the metric as the units of measure. The metric defines the domain (or set of legal values) for the metric and its direction. By direction, we mean whether bigger scores are better than smaller scores or vice versa. This information is used when a set of scores are combined into an overall score.</p>
<p>The KSL has many pre-defined scoring models. The user can specify the criteria to use for the scoring evaluation process or accept the defaults. Two of the scoring models are based on a histogram summary of the data. This involves dividing the range of observations via break points <span class="math inline">\(b_j\)</span> and tabulating frequencies or proportions of the data falling with the defined intervals or bins. The KSL does not use arbitrary break points from a histogram binning process. Instead the KSL attempts to define the break points for the intervals such that each interval has the <em>same</em> probability of occurrence. This ensures that the expected number of observations within each interval is the same. The theoretical basis for this approach can be found in <span class="citation">(<a href="#ref-CAWilliams1950">Williams 1950</a>)</span>.</p>
<p>The scoring criteria based on a binning process are the sum of squared errors (SSE), Chi-Squared (CSQ), and the Mallows L2 (ML2) criterion. For these models, let <span class="math inline">\(c_{j}\)</span> be the observed count of the <span class="math inline">\(x\)</span> values contained in
the <span class="math inline">\(j^{th}\)</span> interval <span class="math inline">\(\left(b_{j-1}, b_{j} \right]\)</span>, let <span class="math inline">\(h_j = c_j/n\)</span> be the relative frequency for the <span class="math inline">\(j^{th}\)</span> interval, and let <span class="math inline">\(p_j\)</span> be defined as:</p>
<p><span class="math display">\[
p_j = P\{b_{j-1} \leq X \leq b_{j}\} = \int\limits_{b_{j-1}}^{b_{j}} f(x) \mathrm{d}x
\]</span>
Thus, we can define SSE, CSQ, and ML2 as follows:</p>
<ul>
<li>Sum of Squared Error (SSE) criterion - The squared error is defined as the sum over the intervals of the squared difference between the relative frequency and the theoretical probability associated with each interval:</li>
</ul>
<p><span class="math display">\[
\text{SSE} = \sum_{j = 1}^k (h_j - p_j)^2
\]</span></p>
<ul>
<li>Chi-Squared criterion (CSQ) - The chi-squared criterion is the <span class="math inline">\(\chi^{2}\)</span> test statistic value that compares the observed counts <span class="math inline">\(c_j\)</span> to the expected counts <span class="math inline">\(np_j\)</span> over the intervals.</li>
</ul>
<p><span class="math display">\[
\chi^{2}_{0} = \sum\limits_{j=1}^{k} \frac{\left( c_{j} - np_{j} \right)^{2}}{np_{j}}
\]</span></p>
<ul>
<li>Mallows L2 Criterion - <span class="citation">(<a href="#ref-levina-bickel2001">Levina and Bickel 2001</a>)</span> provide the definition of the Mallows L2 distance, also known as the earthmovers distance. In terms of <span class="math inline">\(p_j\)</span> and <span class="math inline">\(h_j\)</span>, this is:</li>
</ul>
<p><span class="math display">\[
M_{L_2} = \Bigg( \frac{1}{k} \sum_{j=1}^{k}(h_j - p_j)^2\Bigg)^{\frac{1}{2}}
\]</span></p>
<p>Note that under the specification of the breakpoints resulting in intervals with equal probabilities, we have <span class="math inline">\(p_j = p\)</span> and <span class="math inline">\(p = k/n\)</span>. This allows the SSE criterion to be simplified as follows:</p>
<p><span class="math display">\[
\text{SSE} = \sum_{j = 1}^k (h_j - p_j)^2  = \sum_{j = 1}^k (h_j - p)^2
\]</span></p>
<p>In addition, the Mallows criterion can be written in terms of the SSE as follows:</p>
<p><span class="math display">\[
M_{L_2} = \Bigg( \frac{1}{k} \sum_{j=1}^{k}(h_j - p_j)^2\Bigg)^{\frac{1}{2}} = \Bigg( \frac{\text{SSE} }{k} \Bigg)^{\frac{1}{2}}
\]</span></p>
<p>Thus, we have <span class="math inline">\(M^2_{L_2} = \frac{\text{SSE} }{k}\)</span>. Finally, notice that the chi-squared criterion (CSQ) under the assumption that <span class="math inline">\(p_j = p\)</span> can be simplified as:</p>
<p><span class="math display">\[
\chi^{2}_{0} = \sum\limits_{j=1}^{k} \frac{\left( c_{j} - np_{j} \right)^{2}}{np_{j}}= n \sum\limits_{j=1}^{k} \frac{\left( h_{j} - p_{j} \right)^{2}}{p_{j}} = \frac{n}{p}\sum\limits_{j=1}^{k} \left( h_{j} - p \right)^{2} = \frac{n}{p}\text{SSE}
\]</span></p>
<p>Therefore, under the assumption that <span class="math inline">\(p_j = p\)</span>, that is equally probable intervals, we have that:</p>
<p><span class="math display">\[
\chi^{2}_{0} = \frac{n^2}{k}\text{SSE}=n^2M^2_{L_2}
\]</span>
The relationships between CSQ, SSE, and ML2 are important to note because during the scoring process, the metrics are converted to a common scale. If a linear transformation is chosen for the transformation (which is the default), then the resulting values for CSQ, SSE, and ML2 will be the same in terms of their <em>scaled</em> values. Thus, under a linear transformation, only one of CSQ, SSE, and ML2 should be included in the evaluation process.</p>
<p>The metrics that do not depend on a histogram binning process include the Kolmogorov-Smirnov (KS) criterion, Cramer Von Mises (CVM) criterion, Anderson-Darling (AD) criterion, P-P plot sum of squared errors (PPSSE), P-P plot correlation (PPC), Q-Q plot sum of squared errors (QQSSE), Q-Q plot correlation (QQC), Bayesian Information Criterion (BIC), and the Akaike Information Criterion (AIC). These scoring metrics are defined as follows:</p>
<ul>
<li>Kolmogorov-Smirnov criterion - The Kolmogorov-Smirnov (KS) criterion is based on the K-S test statistic, where, <span class="math inline">\(D_{n} = \max \lbrace D^{+}_{n}, D^{-}_{n} \rbrace\)</span>, represents the largest vertical
distance between the hypothesized distribution and the empirical
distribution over the range of the distribution.</li>
</ul>
<p><span class="math display">\[
\begin{aligned}
D^{+}_{n} &amp; = \underset{1 \leq i \leq n}{\max} \Bigl\lbrace \tilde{F}_{n} \left( x_{(i)} \right) -  \hat{F}(x_{(i)}) \Bigr\rbrace \\
  &amp; = \underset{1 \leq i \leq n}{\max} \Bigl\lbrace \frac{i}{n} -  \hat{F}(x_{(i)}) \Bigr\rbrace \end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
D^{-}_{n} &amp; = \underset{1 \leq i \leq n}{\max} \Bigl\lbrace \hat{F}(x_{(i)}) - \tilde{F}_{n} \left( x_{(i-1)} \right) \Bigr\rbrace \\
  &amp; = \underset{1 \leq i \leq n}{\max} \Bigl\lbrace \hat{F}(x_{(i)}) - \frac{i-1}{n} \Bigr\rbrace
\end{aligned}
\]</span></p>
<ul>
<li>Cramer Von Mises criterion (CVM) - The Cramer Von Mises criterion is a distance measure used to compare the goodness of fit of a cumulative distribution function, <span class="math inline">\(F(x)\)</span> to the empirical distribution, <span class="math inline">\(F_n(x)\)</span>. The distance is defined as:</li>
</ul>
<p><span class="math display">\[\begin{equation}
\omega^2 = \int_{-\infty}^{+\infty}\Big[ F_n(x) - F(x) \Big]^2\,dF(x)
\end{equation}\]</span></p>
<p>The CVM metric can be computed from data sorted in ascending order (<span class="math inline">\(x_1, x_2, \cdots, x_n\)</span>), i.e. the order statistics, as:</p>
<p><span class="math display">\[\begin{equation}
T = n\omega^2 = \frac{1}{12n} + \sum_{i=1}^{n}\Big[ \frac{2i-1}{2n} - F(x_i) \Big]^2
\end{equation}\]</span></p>
<ul>
<li>Anderson Darling criterion (AD) - The Anderson-Darling criterion is similar in spirit to the Cramer Von Mises test statistic except that it is designed to detect discrepancies in the tails of the distribution.</li>
</ul>
<p><span class="math display">\[\begin{equation}
A^2 = n\int_{-\infty}^{+\infty}\frac{\Big[ F_n(x) - F(x) \Big]^2}{F(x)(1-F(x))}\,dF(x)
\end{equation}\]</span></p>
<p>The AD metric can be computed from data sorted in ascending order (<span class="math inline">\(x_1, x_2, \cdots, x_n\)</span>), i.e. the order statistics, as:</p>
<p><span class="math display">\[\begin{equation}
A^2 = -n - \sum_{i=1}^{n}\frac{2i-1}{n}\Big[ \ln(F(x_i)) + \ln(1-F(x_{n+1-i})) \Big]
\end{equation}\]</span></p>
<ul>
<li>P-P Plot Sum of Squared Errors (PPSSE) - Based on the concepts found in <span class="citation">(<a href="#ref-gan-koehler">Gan and Koehler 1990</a>)</span>, the sum of squared error related to the P-P plot of the theoretical distribution versus the empirical distribution was developed as a scoring criterion. Let <span class="math inline">\((x_{(1)}, x_{(2)}, \ldots x_{(n)})\)</span> be the order statistics. Let the theoretical distribution be represented with <span class="math inline">\(\hat{F}(x_{(i)})\)</span> for <span class="math inline">\(i= 1, 2, \ldots n\)</span> where <span class="math inline">\(\hat{F}\)</span> is the CDF of the hypothesized distribution. Define the empirical distribution as</li>
</ul>
<p><span class="math display">\[\tilde{F}_n(x_{(i)}) = \dfrac{i - 0.5}{n}\]</span></p>
<p>Then, the P-P Plot sum of squared error (PPSSE) criterion is defined as:</p>
<p><span class="math display">\[
\text{PP Squared Error} = \sum_{i = 1}^n (\tilde{F}_n(x_{(i)}) - \hat{F}(x_{(i)}))^2
\]</span></p>
<p>Notice that the Cramer-Von-Mises criterion and the PPSSE criterion are related as follows:</p>
<p><span class="math display">\[
T = \frac{1}{12n} + \text{PPSSE}
\]</span></p>
<p>Therefore, under a linear transformation, it is not recommended to include both PPSSE and CVM in the evaluation process.</p>
<ul>
<li><p>P-P Correlation (PPC) - Based on the concepts found in <span class="citation">(<a href="#ref-gan-koehler">Gan and Koehler 1990</a>)</span>, the P-P correlation scoring model computes the Pearson correlation associated with a P-P plot. That is, the scoring model computes the correlation between <span class="math inline">\((\tilde{F}_n(x_{(i)}), \hat{F}(x_{(i)}))\)</span> for <span class="math inline">\(i= 1, 2, \ldots n\)</span>.</p></li>
<li><p>Q-Q Plot Sum of Squared Error (QQSSE) - Again, based on the concepts found in <span class="citation">(<a href="#ref-gan-koehler">Gan and Koehler 1990</a>)</span>, the sum of squared error related to the Q-Q plot of the theoretical quantiles versus the empirical quantiles was developed as a scoring criterion. For a Q-Q plot define <span class="math inline">\(q_i = (i - 0.5)/n\)</span>, for <span class="math inline">\(i= 1, 2, \ldots n\)</span> and <span class="math inline">\(x_{q_i} = \hat{F}^{-1} (q_i)\)</span> where <span class="math inline">\(\hat{F}^{-1}(\cdot)\)</span> is the inverse CDF of the hypothesized distribution. Finally, let <span class="math inline">\((x_{(1}, x_{(2)}, \ldots x_{(n)})\)</span> be the order statistics. Then, the QQSSE is the sum of the squared error as follows:</p></li>
</ul>
<p><span class="math display">\[
\text{QQSSE} = \sum_{i = 1}^n (x_{(i)} - x_{q_i})^2
\]</span></p>
<ul>
<li><p>Q-Q Plot Correlation (QQC) - Similar to PPC, the Q-Q plot correlation criterion is the Pearson correlation of <span class="math inline">\((x_{(i)},x_{q_i})\)</span> for <span class="math inline">\(i= 1, 2, \ldots n\)</span>, with values closer to 1.0 indicating a good fit.</p></li>
<li><p>Bayesian Information Criterion (BIC) - Developed by <span class="citation">(<a href="#ref-schwarz1978">Schwarz 1978</a>)</span>, the BIC is used for model selection where models with lower BIC are preferred. The BIC is based on the log-likelihood function. Let <span class="math inline">\(f(x;\vec{\theta})\)</span> be the theoretical probability density function with parameters <span class="math inline">\(\vec{\theta}\)</span>. The likelihood function of a sample of <span class="math inline">\(\vec{x} = (x_1,x_2, \cdots, x_n)\)</span> is:</p></li>
</ul>
<p><span class="math display">\[
L(\vec{\theta};\vec{x}) = \prod_{i=1}^{n}f(x_i;\vec{\theta})
\]</span>
The likelihood function of the sample, measures the likelihood that the sample came from the distribution with the given parameters. The log-likelihood function for an observation <span class="math inline">\(x_i\)</span> is <span class="math inline">\(\ln \big(f(x_i;\vec{\theta}\big)\)</span>. Thus, the log-likelihood function for the sample is:</p>
<p><span class="math display">\[
\text{LL}(\vec{\theta};\vec{x}) = \sum_{i=1}^{n}ln(f(x_i;\vec{\theta}))
\]</span>
The BIC is defined in terms of the value of the log-likelihood of the sample as follows:</p>
<p><span class="math display">\[
\text{BIC} = k\ln(n) - 2\text{LL}(\hat{\vec{\theta}};\vec{x})
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the sample size, <span class="math inline">\(k\)</span> is the number of parameters estimated for the model, <span class="math inline">\(\hat{\vec{\theta}}\)</span> are the estimated parameter values.</p>
<ul>
<li>Akaike Information Criterion (AIC) - Developed by <span class="citation">(<a href="#ref-akaike74">Akaike 1974</a>)</span>, the AIC is used for model selection where models with lower AIC are preferred. Like the BIC, the AIC is defined in terms of the log-likelihood function of the sample. The KSL uses the formulation described in <span class="citation">(<a href="#ref-vose2010">Vose 2010</a>)</span> as follows:</li>
</ul>
<p><span class="math display">\[
\text{AIC} = \Bigg( \frac{n-2k +2}{n-k+1}\Bigg) -2\text{LL}(\hat{\vec{\theta}};\vec{x})
\]</span></p>
<p>These scoring models avoid summarizing the data based on a histogram, which requires a specification of the bin sizes (or widths) and tabulation of frequencies or proportions associated with the bins.</p>
<p>As illustrated in Figure <a href="distFitting.html#fig:ScoringModelLabel">2.8</a>, the scoring models are implemented by sub-classing from the <code>PDFScoringModel</code> abstract base class. Users of the KSL distribution recommendation framework can select which scoring models to include during the evaluation process. The default set of scoring models are BIC, AD, CVM, and QQC. During testing, the BIC criterion performed very well across all but very low sample sizes. The AD and CVM criteria tend to perform better for lower sample sizes, while the QQC criterion tends to perform better for higher sample sizes and for particular distribution families.</p>
<p>The quality of a parametric fit for a specific distribution can be evaluated by one or more scoring models. Since distribution quality metrics have been designed to measure different aspects of the fit, the KSL allows the scoring results to be combined into an overall score. Suppose distribution <span class="math inline">\(F_k\)</span> is evaluated by the the scoring models, each resulting in score <span class="math inline">\(S_i\)</span> for <span class="math inline">\(i=1,2,\cdots, m\)</span>, where <span class="math inline">\(m\)</span> is the number of scoring models. In general, the scores may not have the same scales and the same direction of <em>goodness</em>. The KSL scoring system translates and scales each score <span class="math inline">\(S_i\)</span> in to a value measure, <span class="math inline">\(M_i\)</span>, that has a common scale and direction (a bigger score is better). These value measures are then combined into an overall value (<span class="math inline">\(V_k\)</span>) for the distribution using weights (<span class="math inline">\(w_i\)</span>) across the scoring criteria:</p>
<p><span class="math display">\[\begin{equation}
V_{k} = \sum_{i=1}^{m}w_i \times M_i
\end{equation}\]</span></p>
<p>The distribution that has the overall largest value, <span class="math inline">\(V_k\)</span>, is then recommended as the best fitting probability model.</p>
<p>This methodology is based on the commonly used multi-objective decision analysis (MODA) method for choosing among a set of alternatives. In the KSL’s default application of this methodology, each scoring model is weighted equally and a linearly additive model is assumed. The framework is designed to allow the user to define and apply their own scoring models and to set the preference weights among the metrics. In addition, sensitivity analysis of the weights can easily be accomplished. Once the best distribution has been recommended, then the KSL facilitates performing statistical tests with resulting p-values.</p>
<p>Figure <a href="distFitting.html#fig:PDFModelerLabel">2.9</a> presents the main class (<code>PDFModeler</code>) for performing the continuous distribution fitting task. The companion object provides functionality to estimate the shift parameter, shift the data to the left, compute confidence intervals for the minimum and maximum of the data via bootstrapping, estimate the range of possible values for the distribution, create distributions from estimated parameters, create the default evaluation model, and work with histograms.</p>
<div class="figure"><span style="display:block;" id="fig:PDFModelerLabel"></span>
<img src="figures2/ch2/PDFModeler.png" alt="PDF Modeling Framework" width="100%" height="100%" />
<p class="caption">
Figure 2.9: PDF Modeling Framework
</p>
</div>
<p>The modeling process starts with creating an instance of <code>PDFModeler</code> by supplying the data to be modeled and the set of scoring models to be used within the evaluation process. Then, functions can be used to perform the estimation and scoring tasks.</p>
<ul>
<li><p><code>estimateParameters(estimators: Set&lt;ParameterEstimatorIfc&gt;, automaticShifting: Boolean = true)</code> - This function estimates the parameters for all estimators represented by the supplied set of estimators. The parameter, <code>automaticShifting</code> controls whether the data will be automatically shifted. If the automatic shift parameter is true (the default), then a confidence interval for the minimum of the data is estimated from the data. If the upper limit of the estimated confidence interval is greater than the value specified by the default zero tolerance property, then the data is shifted to the left and used in the estimation process. The estimated shift will be recorded in the result. Automated shift estimation will occur only if the automatic shifting parameter is true, if the estimator requires that its range be checked, and if the data actually requires a shift. If the automatic shifting parameter is false, then no shifting will occur. In this case it is up to the user to ensure that the supplied data is representative of the set of estimators to be estimated. The returned list will contain the results for each estimator.</p></li>
<li><p><code>evaluateScores(estimationResults: List&lt;EstimationResult&gt;)</code> - This function applies the supplied scoring models to the results from the parameter estimation process. Each distribution with estimated parameters will be scored by each of the supplied models and the results tabulated as an instance of the <code>PDFModelingResults</code> class.</p></li>
<li><p><code>estimateAndEvaluateScores(estimators: Set&lt;ParameterEstimatorIfc&gt; = allEstimators, automaticShifting: Boolean = true, scoringModels: Set&lt;PDFScoringModel&gt; = allScoringModels)</code> - As its name implies, this function combines the functions of <code>estimateParameters()</code> and <code>evaluateScores()</code> into a single function for the convenience of the modeler. The returned instance of the <code>PDFModelingResults</code> class has the estimation results and the scoring results.</p></li>
<li><p><code>showAllResultsInBrowser(fileName: String = "pdfModelingResults")</code> - This function makes a histogram, observations plot, auto-correlation plot, performs the fitting and scoring process, and performs goodness
of fit tests on the top scoring distribution and displays all the results by opening a browser window. The generated <code>html</code> file is stored in the <code>KSL.plotDir</code> directory using the supplied name as the pre-fix for a temporary file. This one function performs all the necessary fitting steps and returns the results, including plots, within an <code>html</code> page.</p></li>
<li><p><code>showAllGoodnessofFitSummariesInBrowser(pdfModelingResults: PDFModelingResults)</code> - This function shows the goodness of fit summaries for every distribution used within the fitting process. This function shows the raw scores, the scaled scores, the ranked scores, and the PDF summary results for each distribution. The PDF summary results includes the <code>FitDistPlot</code> plots as well as the results of the Chi-Squared, K-S, Anderson Darling, and Cramer Von Mises, statistical tests. This function is very useful when comparing the quality of the fitted distributions.</p></li>
</ul>
<p>The <code>PDFModeling</code> class encapsulates the estimation and scoring process. The purpose of this class is to serve as the general location for implementing the estimation of distribution parameters across many distributions. The general use involves the following:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb43-1"><a href="distFitting.html#cb43-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb43-2"><a href="distFitting.html#cb43-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">estimationResults</span><span class="op">:</span> List<span class="op">&lt;</span>EstimationResult<span class="op">&gt;</span> <span class="op">=</span> d<span class="op">.</span>estimateParameters<span class="op">(</span>d<span class="op">.</span>allEstimators<span class="op">)</span></span>
<span id="cb43-3"><a href="distFitting.html#cb43-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">scoringResults</span> <span class="op">=</span> d<span class="op">.</span>scoringResults<span class="op">(</span>estimationResults<span class="op">)</span></span>
<span id="cb43-4"><a href="distFitting.html#cb43-4" tabindex="-1"></a><span class="kw">val</span> <span class="va">model</span> <span class="op">=</span> d<span class="op">.</span>evaluateScoringResults<span class="op">(</span>scoringResults<span class="op">)</span></span>
<span id="cb43-5"><a href="distFitting.html#cb43-5" tabindex="-1"></a>scoringResults<span class="op">.</span>forEach<span class="op">(</span> <span class="op">::</span>println<span class="op">)</span></span></code></pre></div>
<p>The scoring results will be updated with the evaluation information and will contain the evaluation scores. The scoring results can be sorted to find the recommended distribution based on the evaluation score. Alternatively, the single function can be used:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb44-1"><a href="distFitting.html#cb44-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb44-2"><a href="distFitting.html#cb44-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">results</span>  <span class="op">=</span> d<span class="op">.</span>estimateAndEvaluateScores<span class="op">()</span></span></code></pre></div>
<p>This function returns an instance of <code>PDFModelingResults,</code> which will have the results of the entire fitting process. The advantage of using the individual functions may permit some further customization of the estimation process. The <code>PDFModelingResults</code> class in Figure <a href="distFitting.html#fig:PDFModelerLabel">2.9</a> is a data class that holds all of the results from the fitting and scoring process. In addition, the class holds an instance of the scoring model (<code>AdditiveMODAModel</code>), which can be used to perform additional analysis of the scores. The property <code>sortedScoringResults</code> provides the list of results sorted such that the top performer is the first element of the list.</p>
<p>To summarize, the KSL continuous distribution modeling framework allows the modeler to:</p>
<ul>
<li>Define and select from a set of distributions to evaluate</li>
<li>Define and select from a set of parameter estimation methods</li>
<li>Compute bootstrap estimates of the confidence intervals for the estimated parameters</li>
<li>Define and select from a set of distribution fit quality metrics (scoring models)</li>
<li>Combine scoring models into an overall measure</li>
<li>Recommend the best distribution based on weighted preference among evaluation metrics</li>
<li>Make observations plots, histograms, autocorrelation plots, P-P plots, Q-Q plots, and empirical distribution plots.</li>
</ul>
<p>All of this functionality is encapsulated in the <code>PDFModeler</code> class. This functionality will be illustrated in Section <a href="distFitting.html#pdfmexamples">2.4.4</a>.</p>
<p>After performing the estimation and scoring process, the modeler may want to perform statistical tests for the top performing distribution (or others). The <code>ContinuousCDFGoodnessOfFit</code> class facilitates the performing of the following goodness of fit tests:</p>
<ul>
<li>Chi-Squared</li>
<li>Kolmogorov-Smirnov</li>
<li>Anderson-Darling</li>
<li>Cramer-Von Mises</li>
</ul>
<div class="figure"><span style="display:block;" id="fig:ContinuousCDFGoodnessOfFitLabel"></span>
<img src="figures2/ch2/ContinuousCDFGoodnessOfFit.png" alt="Continuous Distribution Goodness of Fit Framework" width="100%" height="100%" />
<p class="caption">
Figure 2.10: Continuous Distribution Goodness of Fit Framework
</p>
</div>
<p>Figure <a href="distFitting.html#fig:ContinuousCDFGoodnessOfFitLabel">2.10</a> shows the framework of classes and interfaces for performing goodness of fit tests within the KSL. The main class is the <code>ContinuousCDFGoodnessOfFit</code> class. This class will compute the test statistics and their P-values.</p>
<p>The chi-squared test is the most challenging test to execute in an automated fashion. The KSL follows the recommendation found in Chapter 6 of <span class="citation">(<a href="#ref-law2007simulation">Law 2007</a>)</span> for setting up the chi-squared test. The KSL does not use arbitrary break points from a histogram generation process. Instead the KSL attempts to define the break points for the chi-squared intervals such that each interval has the <em>same</em> probability of occurrence. This also ensures that the expected number of observations within each interval is approximately the same. The theoretical basis for this approach can be found in <span class="citation">(<a href="#ref-CAWilliams1950">Williams 1950</a>)</span>. <span class="citation">(<a href="#ref-CAWilliams1950">Williams 1950</a>)</span> considered the testing of <span class="math inline">\(U(0,1)\)</span> random variates. In the case of the <span class="math inline">\(U(0,1)\)</span> distribution, the choice of the number of intervals determines the break points because each interval is equally likely. <span class="citation">(<a href="#ref-CAWilliams1950">Williams 1950</a>)</span> recommended choosing the class limits such that the expected number in the interval was <span class="math inline">\(n/k\)</span>, where <span class="math inline">\(n\)</span> is the number of observations and <span class="math inline">\(k\)</span> is the number of class intervals. Based on the ability to ensure that the resulting chi-squared test statistic actually has a chi-squared distribution, <span class="citation">(<a href="#ref-CAWilliams1950">Williams 1950</a>)</span> recommended that the number of class intervals be:</p>
<p><span class="math display">\[\begin{equation}
k = \Bigg\lceil 4 \, \sqrt[5]{\frac{2(n-1)^2}{z_{1-\alpha}}} \, \Bigg\rceil
\end{equation}\]</span></p>
<p>This approach produces equally distant break points between <span class="math inline">\((0,1)\)</span>. Let’s call those break points <span class="math inline">\(u_i\)</span> for <span class="math inline">\(i=1,\cdots,k\)</span>. We then define the break points for the chi-squared test for the distribution, <span class="math inline">\(F(x)\)</span>, as <span class="math inline">\(b_i = F^{-1}(u_i)\)</span>, which will result in non-equally spaced break points for <span class="math inline">\(F(x)\)</span>, but the probability <span class="math inline">\(p_i\)</span> associated with the intervals will all be the same. For the resulting recommended break points, the procedure attempts to ensure that the number of intervals is at least 3 and that the expected number within the intervals is at least 5. If the number of observations of the sample, <span class="math inline">\(n\)</span>, is less than or equal to 15, this may not be possible. The procedure ensures that there are at least 3 intervals and if the expected count is less than 5 for any interval the user is warned. This same procedure is used in determining the break points for the squared error criteria. This approach reduces the sensitivity of the chi-squared fitting process and the squared error criteria to the choice of the intervals. This functionality is found in the <code>suggestBreakPoints()</code> function of the companion object of the <code>ContinuousCDFGoodnessOfFit</code> class.</p>
<p>As an example, the following code generates an exponentially distributed sample and applies the goodness of fit tests to the data.</p>
<div class="example">
<p><span id="exm:ch2ex24" class="example"><strong>Example 2.24  (Goodness of Fit Testing) </strong></span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb45-1"><a href="distFitting.html#cb45-1" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb45-2"><a href="distFitting.html#cb45-2" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> Exponential<span class="op">(</span><span class="fl">10.0</span><span class="op">)</span></span>
<span id="cb45-3"><a href="distFitting.html#cb45-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">e</span> <span class="op">=</span> d<span class="op">.</span>randomVariable<span class="op">(</span><span class="dv">3</span><span class="op">)</span></span>
<span id="cb45-4"><a href="distFitting.html#cb45-4" tabindex="-1"></a>    e<span class="op">.</span>advanceToNextSubStream<span class="op">()</span></span>
<span id="cb45-5"><a href="distFitting.html#cb45-5" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">n</span> <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb45-6"><a href="distFitting.html#cb45-6" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> e<span class="op">.</span>sample<span class="op">(</span>n<span class="op">)</span></span>
<span id="cb45-7"><a href="distFitting.html#cb45-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">gof</span> <span class="op">=</span> ContinuousCDFGoodnessOfFit<span class="op">(</span><span class="kw">data</span><span class="op">,</span> d<span class="op">)</span></span>
<span id="cb45-8"><a href="distFitting.html#cb45-8" tabindex="-1"></a>    println<span class="op">(</span>gof<span class="op">)</span></span>
<span id="cb45-9"><a href="distFitting.html#cb45-9" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<p>The results, as expected, indicate that the data is exponentially distributed. Notice how the binning process for the data results in the bin probabilities and expected number per bin being all equal. The observed counts look pretty consistent for the intervals. Thus, the chi-squared test does not reject the hypothesis that the data is exponential with a mean of 10. In addition, the Anderson-Darling, K-S test, and Cramer Von Mises P-values indicate that we should not reject the hypothesis that the data is exponentially distributed. The <code>showAllResultsInBrowser()</code> function of the <code>PDFModeler</code> class automatically performs these goodness of fit tests for the recommended distribution from the PDF modeling process.</p>
<pre><code>GOF Results for Distribution: Exponential(mean=10.0)
---------------------------------------------------------

Chi-Squared Test Results:
Bin Label                 P(Bin)       Observed   Expected
  1 [ 0.00, 0.17)         0.016949           20    16.9492
  2 [ 0.17, 0.34)         0.016949           14    16.9492
  3 [ 0.34, 0.52)         0.016949           23    16.9492
  4 [ 0.52, 0.70)         0.016949           14    16.9492
  5 [ 0.70, 0.89)         0.016949           21    16.9492
  6 [ 0.89, 1.07)         0.016949           21    16.9492
  7 [ 1.07, 1.26)         0.016949           22    16.9492
  8 [ 1.26, 1.46)         0.016949           10    16.9492
  9 [ 1.46, 1.66)         0.016949           18    16.9492
 10 [ 1.66, 1.86)         0.016949           12    16.9492
 11 [ 1.86, 2.06)         0.016949           16    16.9492
 12 [ 2.06, 2.27)         0.016949           12    16.9492
 13 [ 2.27, 2.49)         0.016949           23    16.9492
 14 [ 2.49, 2.71)         0.016949           15    16.9492
 15 [ 2.71, 2.93)         0.016949           17    16.9492
 16 [ 2.93, 3.16)         0.016949           14    16.9492
 17 [ 3.16, 3.40)         0.016949           21    16.9492
 18 [ 3.40, 3.64)         0.016949           13    16.9492
 19 [ 3.64, 3.89)         0.016949           11    16.9492
 20 [ 3.89, 4.14)         0.016949           20    16.9492
 21 [ 4.14, 4.40)         0.016949           18    16.9492
 22 [ 4.40, 4.67)         0.016949           19    16.9492
 23 [ 4.67, 4.94)         0.016949           23    16.9492
 24 [ 4.94, 5.22)         0.016949           19    16.9492
 25 [ 5.22, 5.51)         0.016949           17    16.9492
 26 [ 5.51, 5.81)         0.016949           18    16.9492
 27 [ 5.81, 6.12)         0.016949           12    16.9492
 28 [ 6.12, 6.44)         0.016949           17    16.9492
 29 [ 6.44, 6.76)         0.016949           16    16.9492
 30 [ 6.76, 7.10)         0.016949           13    16.9492
 31 [ 7.10, 7.45)         0.016949           18    16.9492
 32 [ 7.45, 7.82)         0.016949           17    16.9492
 33 [ 7.82, 8.19)         0.016949           21    16.9492
 34 [ 8.19, 8.59)         0.016949           17    16.9492
 35 [ 8.59, 8.99)         0.016949           25    16.9492
 36 [ 8.99, 9.42)         0.016949            9    16.9492
 37 [ 9.42, 9.86)         0.016949           14    16.9492
 38 [ 9.86,10.33)         0.016949           15    16.9492
 39 [10.33,10.82)         0.016949           13    16.9492
 40 [10.82,11.33)         0.016949           12    16.9492
 41 [11.33,11.87)         0.016949           18    16.9492
 42 [11.87,12.44)         0.016949           23    16.9492
 43 [12.44,13.05)         0.016949           20    16.9492
 44 [13.05,13.69)         0.016949            9    16.9492
 45 [13.69,14.38)         0.016949           14    16.9492
 46 [14.38,15.13)         0.016949           16    16.9492
 47 [15.13,15.93)         0.016949           13    16.9492
 48 [15.93,16.80)         0.016949           22    16.9492
 49 [16.80,17.75)         0.016949           15    16.9492
 50 [17.75,18.80)         0.016949           18    16.9492
 51 [18.80,19.98)         0.016949           23    16.9492
 52 [19.98,21.32)         0.016949           23    16.9492
 53 [21.32,22.86)         0.016949           25    16.9492
 54 [22.86,24.68)         0.016949            9    16.9492
 55 [24.68,26.91)         0.016949           14    16.9492
 56 [26.91,29.79)         0.016949           16    16.9492
 57 [29.79,33.84)         0.016949           15    16.9492
 58 [33.84,40.78)         0.016949           15    16.9492
 59 [40.78,155.00)        0.016949           22    16.9490

Number of estimated parameters = 1
Number of intervals = 59
Degrees of Freedom = 57
Chi-Squared Test Statistic = 61.52812706136465
P-value = 0.31723313805973075
Hypothesis test at 0.05 level: 
The p-value = 0.31723313805973075 is &gt;= 0.05 : Do not reject hypothesis.

Goodness of Fit Test Results:
K-S test statistic = 0.017687069238841113
K-S test p-value = 0.9075526348536717

Anderson-Darling test statistic = 0.3610051171259556
Anderson-Darling test p-value = 0.8863125779601514

Cramer-Von-Mises test statistic = 0.043345445388941854
Cramer-Von-Mises test p-value = 0.9152815646329959</code></pre>
</div>
<div id="discrete-distribution-framework" class="section level3 hasAnchor" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Discrete Distribution Framework<a href="distFitting.html#discrete-distribution-framework" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For discrete distributions, the KSL provides the <code>PMFModeler</code> class. Since there are less discrete distributions within the KSL than continuous distributions, the <code>PMFModeler</code> class does not provide the full range of functionality provided by the <code>PDFModeler</code> class. Instead the <code>PMFModeler</code> class focuses on estimating the parameters of discrete distributions. Similar to how the <code>PDFModeler</code> class functions, the <code>PMFModeler</code> has an <code>estimateParameters()</code> function that uses a set of objects that implement the <code>ParameterEstimatorIfc</code> interface. The default set of discrete distributions includes the Poisson, negative binomial, and the binomial distributions. Of course users can define additional discrete distributions and implement parameter estimators for those distributions.</p>
<p>Figure <a href="distFitting.html#fig:PMFMEstimationLabel">2.11</a> presents the PMF estimation framework. As indicated the key function is the <code>estimateParameters()</code> function. Note also that the companion object for the <code>PMFModeler</code> class has the function <code>equalizedPMFBreakPoints(),</code> which can be useful during the goodness of fit testing of the distribution. The purpose of the function is to attempt to form intervals that have similar probabilities.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:PMFMEstimationLabel"></span>
<img src="figures2/ch2/PMFModeler.png" alt="PMF Estimation Framework" width="70%" height="70%" />
<p class="caption">
Figure 2.11: PMF Estimation Framework
</p>
</div>
<p>The application of the <code>estimateParameters()</code> function results in the creation of a list that contains instances of <code>EstimationResult,</code> one for each of the estimation methods.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:DiscretePMFGoodnessOfFitLabel"></span>
<img src="figures2/ch2/DiscretePMFGoodnessOfFit.png" alt="Discrete Distribution Goodness of Fit Framework" width="90%" height="90%" />
<p class="caption">
Figure 2.12: Discrete Distribution Goodness of Fit Framework
</p>
</div>
<p>Given the limited number of discrete distributions, the KSL does not provide a scoring model approach for selecting the best distribution. Instead, the <code>DiscretePMFGoodnessOfFit</code> class, illustrated in Figure <a href="distFitting.html#fig:DiscretePMFGoodnessOfFitLabel">2.12</a> can be used to check the goodness of fit for the discrete distribution. The primary method for testing the goodness of it is the chi-squared goodness of fit test. Similar to how the continuous distribution defines break points that result in approximately equal probabilities for the bins and expected counts, the KSL attempts to form intervals for the chi-squared test that have approximately equal probabilities. The following code illustrates how to fit a negative binomial distribution to some randomly generated data.</p>
<div class="example">
<p><span id="exm:ch2ex25" class="example"><strong>Example 2.25  (Discrete Goodness of Fit Testing) </strong></span></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb47-1"><a href="distFitting.html#cb47-1" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">main</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb47-2"><a href="distFitting.html#cb47-2" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">dist</span> <span class="op">=</span> NegativeBinomial<span class="op">(</span><span class="fl">0.2</span><span class="op">,</span> theNumSuccesses <span class="op">=</span> <span class="fl">4.0</span><span class="op">)</span></span>
<span id="cb47-3"><a href="distFitting.html#cb47-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">rv</span> <span class="op">=</span> dist<span class="op">.</span>randomVariable<span class="op">(</span>streamNumber <span class="op">=</span> <span class="dv">3</span><span class="op">)</span></span>
<span id="cb47-4"><a href="distFitting.html#cb47-4" tabindex="-1"></a>    rv<span class="op">.</span>advanceToNextSubStream<span class="op">()</span></span>
<span id="cb47-5"><a href="distFitting.html#cb47-5" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> rv<span class="op">.</span>sample<span class="op">(</span><span class="dv">200</span><span class="op">)</span></span>
<span id="cb47-6"><a href="distFitting.html#cb47-6" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">breakPoints</span> <span class="op">=</span> PMFModeler<span class="op">.</span>makeZeroToInfinityBreakPoints<span class="op">(</span><span class="kw">data</span><span class="op">.</span>size<span class="op">,</span> dist<span class="op">)</span></span>
<span id="cb47-7"><a href="distFitting.html#cb47-7" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">pf</span> <span class="op">=</span> DiscretePMFGoodnessOfFit<span class="op">(</span><span class="kw">data</span><span class="op">,</span> dist<span class="op">,</span> breakPoints <span class="op">=</span> breakPoints<span class="op">)</span></span>
<span id="cb47-8"><a href="distFitting.html#cb47-8" tabindex="-1"></a>    println<span class="op">(</span>pf<span class="op">.</span>chiSquaredTestResults<span class="op">())</span></span>
<span id="cb47-9"><a href="distFitting.html#cb47-9" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<p>The results indicate the challenge of trying to make bins with equal probability for discrete distributions. In general, it may not be possible to do so. Thus, the modeler is encouraged to update the break points as needed during the distribution assessment process. As expected the results indicate that we should not reject the hypothesis of a negative binomial distribution for this situation.</p>
<pre><code>Chi-Squared Test Results:
Bin Label                 P(Bin)       Observed   Expected
  1 [ 0.00, 3.00)         0.016960            4    3.39200   *** Warning: expected &lt; 5 ***
  2 [ 3.00, 5.00)         0.039322            7    7.86432
  3 [ 5.00, 6.00)         0.029360           10    5.87203
  4 [ 6.00, 7.00)         0.035232            7    7.04643
  5 [ 7.00, 8.00)         0.040265            7    8.05306
  6 [ 8.00, 9.00)         0.044292            5    8.85837
  7 [ 9.00,10.00)         0.047245           10    9.44893
  8 [10.00,11.00)         0.049134            9    9.82689
  9 [11.00,12.00)         0.050028            6    10.0056
 10 [12.00,13.00)         0.050028           11    10.0056
 11 [13.00,14.00)         0.049258            6    9.85162
 12 [14.00,15.00)         0.047851           12    9.57015
 13 [15.00,16.00)         0.045937            7    9.18734
 14 [16.00,17.00)         0.043640           17    8.72798
 15 [17.00,18.00)         0.041073            4    8.21457
 16 [18.00,19.00)         0.038335            7    7.66693
 17 [19.00,20.00)         0.035510            7    7.10200
 18 [20.00,21.00)         0.032669            9    6.53384
 19 [21.00,22.00)         0.029869            5    5.97379
 20 [22.00,23.00)         0.027154            3    5.43072
 21 [23.00,24.00)         0.024556            4    4.91126   *** Warning: expected &lt; 5 ***
 22 [24.00,26.00)         0.041903           13    8.38058
 23 [26.00,28.00)         0.033376            9    6.67520
 24 [28.00,31.00)         0.036998            6    7.39969
 25 [31.00,36.00)         0.036799            7    7.35973
 26 [36.00,Infinity)      0.033207            8    6.64147

Number of estimated parameters = 2
Number of intervals = 26
Degrees of Freedom = 23
Chi-Squared Test Statistic = 25.69659399548871
P-value = 0.31539706650371313
Hypothesis test at 0.05 level: 
The p-value = 0.31539706650371313 is &gt;= 0.05 : Do not reject hypothesis.</code></pre>
</div>
<div id="pdfmexamples" class="section level3 hasAnchor" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Illustrative Examples from Appendix <a href="appidm.html#appidm">B</a><a href="distFitting.html#pdfmexamples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This section illustrates how to use the KSL probability distribution modeling frameworks by applying the previously discussed constructs to two examples from Appendix <a href="appidm.html#appidm">B</a>. We will start with the fitting of Poisson distribution to the data from Example <a href="appidmsecfitDiscrete.html#exm:PoissonFit">B.1</a>, which is repeated here for convenience. The data associated with the examples of this section can be found in the chapter <a href="https://github.com/rossetti/KSL/tree/main/KSLExamples/chapterFiles/Appendix-Distribution%20Fitting">files</a> with in the <code>KSLExamples</code> project associated with the KSL source code repository.</p>
<div class="infobox note">
<p><strong>NOTE!</strong>
Distribution fitting often requires visualizing the data. The KSL provides support for making plots via the <a href="https://github.com/JetBrains/lets-plot-kotlin">lets-plot library</a>. Section <a href="appPlotting.html#appPlotting">D.8</a> of Appendix <a href="appUtilities.html#appUtilities">D</a> illustrates the basics of KSL plotting functionality. This section illustrates some plots that are important for distribution modeling.</p>
</div>
<hr />
<div class="example">
<p><span id="exm:ch2ex26" class="example"><strong>Example 2.26  (Fitting a Poisson Distribution) </strong></span>Suppose that we are interested in modeling the demand for a computer laboratory
during the morning hours between 9 am to 11 am on normal weekdays.
During this time a team of undergraduate students has collected the
number of students arriving to the computer lab during 15 minute
intervals over a period of 4 weeks.</p>
<p>Since there are four 15 minute intervals in each hour for each two hour
time period, there are 8 observations per day. Since there are 5 days
per week, we have 40 observations per week for a total of
<span class="math inline">\(40\times 4= 160\)</span> observations. A sample of observations per 15 minute
interval are presented in Table <a href="distFitting.html#tab:CLAdataCh2">2.1</a>.
The full data set is available with the chapter files. Check whether a Poisson distribution is
an appropriate model for this data.</p>
</div>
<div id="tab:CLAdataCh2">
<table>
<caption><span id="tab:CLAdataCh2">Table 2.1: </span> Computer Laboratory Arrival Counts by Week, Period, and Day</caption>
<thead>
<tr>
<th align="center">Week</th>
<th align="center">Period</th>
<th align="center">M</th>
<th align="center">T</th>
<th align="center">W</th>
<th align="center">TH</th>
<th align="center">F</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">1</td>
<td align="center">9:00-9:15 am</td>
<td align="center">8</td>
<td align="center">5</td>
<td align="center">16</td>
<td align="center">7</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">9:15-9:30 am</td>
<td align="center">8</td>
<td align="center">4</td>
<td align="center">9</td>
<td align="center">8</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">9:30-9:45 am</td>
<td align="center">9</td>
<td align="center">5</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">5</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">9:45-10:00 am</td>
<td align="center">10</td>
<td align="center">11</td>
<td align="center">12</td>
<td align="center">10</td>
<td align="center">12</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">10:00-10:15 am</td>
<td align="center">6</td>
<td align="center">7</td>
<td align="center">14</td>
<td align="center">9</td>
<td align="center">3</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">10:15-10:30 am</td>
<td align="center">11</td>
<td align="center">8</td>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">11</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">10:30-10:45 am</td>
<td align="center">12</td>
<td align="center">7</td>
<td align="center">8</td>
<td align="center">3</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">10:45-11:00 am</td>
<td align="center">8</td>
<td align="center">9</td>
<td align="center">9</td>
<td align="center">8</td>
<td align="center">6</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center">9:00-9:15 am</td>
<td align="center">10</td>
<td align="center">13</td>
<td align="center">7</td>
<td align="center">7</td>
<td align="center">7</td>
</tr>
<tr>
<td align="center">3</td>
<td align="center">9:00-9:15 am</td>
<td align="center">5</td>
<td align="center">7</td>
<td align="center">14</td>
<td align="center">8</td>
<td align="center">8</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">9:00-9:15 am</td>
<td align="center">7</td>
<td align="center">11</td>
<td align="center">8</td>
<td align="center">5</td>
<td align="center">4</td>
</tr>
<tr>
<td align="center">4</td>
<td align="center">10:45-11:00 am</td>
<td align="center">8</td>
<td align="center">9</td>
<td align="center">7</td>
<td align="center">9</td>
<td align="center">6</td>
</tr>
</tbody>
</table>
</div>
<hr />
<p>Since the testing of dependence on the day of the week or the period of observation was already performed in Appendix <a href="appidm.html#appidm">B</a>, we focus on the distribution fitting process in this demonstration of the KSL constructs. Here, we need to fit a Poisson distribution to the data. The first step is reading the data from the CSV file. This can be readily accomplished by using the CSV file reading capabilities of <a href="(https://github.com/Kotlin/dataframe)">Kotlin’s <code>DataFrame</code> library</a>. The following code uses the KSL’s <code>KSLFileUtil</code> object to open a file choosing dialog for the user to select the file, which then has its contents read in using the CSV file processing function for the <code>DataFrame</code> object. This data is converted into an integer array and returned. A discussion of CSV file processing and data frames can be found in Sections <a href="appDCSVEtc.html#appDCSVEtc">D.4</a> and <a href="dfUtil.html#dfUtil">D.5</a> of Appendix <a href="appUtilities.html#appUtilities">D</a>.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb49-1"><a href="distFitting.html#cb49-1" tabindex="-1"></a><span class="kw">fun</span> <span class="fu">readCountData</span><span class="op">():</span> <span class="dt">IntArray</span> <span class="op">{</span></span>
<span id="cb49-2"><a href="distFitting.html#cb49-2" tabindex="-1"></a>    <span class="co">// choose file: KSL/KSLExamples/chapterFiles/Appendix-Distribution Fitting/PoissonCountData.csv</span></span>
<span id="cb49-3"><a href="distFitting.html#cb49-3" tabindex="-1"></a>    <span class="kw">val</span> <span class="va">file</span> <span class="op">=</span> KSLFileUtil<span class="op">.</span>chooseFile<span class="op">()</span></span>
<span id="cb49-4"><a href="distFitting.html#cb49-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>file <span class="op">!=</span> <span class="kw">null</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb49-5"><a href="distFitting.html#cb49-5" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">df</span> <span class="op">=</span> DataFrame<span class="op">.</span>readCSV<span class="op">(</span></span>
<span id="cb49-6"><a href="distFitting.html#cb49-6" tabindex="-1"></a>            file<span class="op">,</span></span>
<span id="cb49-7"><a href="distFitting.html#cb49-7" tabindex="-1"></a>            colTypes <span class="op">=</span> mapOf<span class="op">(</span></span>
<span id="cb49-8"><a href="distFitting.html#cb49-8" tabindex="-1"></a>                <span class="st">&quot;week&quot;</span> to ColType<span class="op">.</span><span class="kw">Int</span><span class="op">,</span></span>
<span id="cb49-9"><a href="distFitting.html#cb49-9" tabindex="-1"></a>                <span class="st">&quot;period&quot;</span> to ColType<span class="op">.</span><span class="kw">Int</span><span class="op">,</span></span>
<span id="cb49-10"><a href="distFitting.html#cb49-10" tabindex="-1"></a>                <span class="st">&quot;day&quot;</span> to ColType<span class="op">.</span><span class="kw">String</span><span class="op">,</span></span>
<span id="cb49-11"><a href="distFitting.html#cb49-11" tabindex="-1"></a>                <span class="st">&quot;count&quot;</span> to ColType<span class="op">.</span><span class="kw">Int</span></span>
<span id="cb49-12"><a href="distFitting.html#cb49-12" tabindex="-1"></a>            <span class="op">)</span></span>
<span id="cb49-13"><a href="distFitting.html#cb49-13" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb49-14"><a href="distFitting.html#cb49-14" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">count</span> <span class="kw">by</span> column<span class="op">&lt;</span><span class="kw">Int</span><span class="op">&gt;()</span></span>
<span id="cb49-15"><a href="distFitting.html#cb49-15" tabindex="-1"></a>        <span class="kw">val</span> <span class="va">countData</span><span class="op">:</span> DataColumn<span class="op">&lt;</span><span class="kw">Int</span><span class="op">&gt;</span> <span class="op">=</span> df<span class="op">[</span>count<span class="op">]</span></span>
<span id="cb49-16"><a href="distFitting.html#cb49-16" tabindex="-1"></a>        <span class="kw">return</span> countData<span class="op">.</span>toIntArray<span class="op">()</span></span>
<span id="cb49-17"><a href="distFitting.html#cb49-17" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb49-18"><a href="distFitting.html#cb49-18" tabindex="-1"></a>    <span class="kw">return</span> IntArray<span class="op">(</span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb49-19"><a href="distFitting.html#cb49-19" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Once the data is an array, the KSL’s discrete distribution framework can be easily applied. In the following code, the data is used to visualize the count data in the form of an integer frequency plot, which we can use like a histogram to view the distribution of the data and see if it has a shape that would support the hypothesis of a Poisson distribution.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb50-1"><a href="distFitting.html#cb50-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> readCountData<span class="op">()</span></span>
<span id="cb50-2"><a href="distFitting.html#cb50-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">f</span> <span class="op">=</span> IntegerFrequency<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb50-3"><a href="distFitting.html#cb50-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">fp</span> <span class="op">=</span> f<span class="op">.</span>frequencyPlot<span class="op">()</span></span>
<span id="cb50-4"><a href="distFitting.html#cb50-4" tabindex="-1"></a>fp<span class="op">.</span>showInBrowser<span class="op">()</span></span>
<span id="cb50-5"><a href="distFitting.html#cb50-5" tabindex="-1"></a>fp<span class="op">.</span>saveToFile<span class="op">(</span><span class="st">&quot;Lab_Count_Freq_Plot&quot;</span><span class="op">)</span></span></code></pre></div>
<p>Figure <a href="distFitting.html#fig:LCFreqPlot">2.13</a> clearly indicates that the Poisson distribution is a candidate model.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LCFreqPlot"></span>
<img src="figures2/ch2/Lab_Count_Freq_Plot.PNG" alt="Integer Frequency Plot of Lab Count Data" width="80%" height="80%" />
<p class="caption">
Figure 2.13: Integer Frequency Plot of Lab Count Data
</p>
</div>
<p>The following code will create a time series observation plot of the data and an auto correlation plot of the data. The use of both of these plots for analysis of data is discussed in Appendix <a href="appidm.html#appidm">B</a>. This code will also save the plots to files and display the plots within a browser window.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb51-1"><a href="distFitting.html#cb51-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">op</span> <span class="op">=</span> ObservationsPlot<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb51-2"><a href="distFitting.html#cb51-2" tabindex="-1"></a>op<span class="op">.</span>saveToFile<span class="op">(</span><span class="st">&quot;Lab_Count_Obs_Plot&quot;</span><span class="op">)</span></span>
<span id="cb51-3"><a href="distFitting.html#cb51-3" tabindex="-1"></a>op<span class="op">.</span>showInBrowser<span class="op">()</span></span>
<span id="cb51-4"><a href="distFitting.html#cb51-4" tabindex="-1"></a><span class="kw">val</span> <span class="va">acf</span> <span class="op">=</span> ACFPlot<span class="op">(</span><span class="kw">data</span><span class="op">.</span>toDoubles<span class="op">())</span></span>
<span id="cb51-5"><a href="distFitting.html#cb51-5" tabindex="-1"></a>acf<span class="op">.</span>saveToFile<span class="op">(</span><span class="st">&quot;Lab_Count_ACF_Plot&quot;</span><span class="op">)</span></span>
<span id="cb51-6"><a href="distFitting.html#cb51-6" tabindex="-1"></a>acf<span class="op">.</span>showInBrowser<span class="op">()</span></span>
<span id="cb51-7"><a href="distFitting.html#cb51-7" tabindex="-1"></a>println<span class="op">(</span>f<span class="op">)</span></span></code></pre></div>
<p>Just as in Appendix <a href="appidm.html#appidm">B</a>, the time series plot does not indicate a trend or pattern with respect to time as shown in Figure <a href="distFitting.html#fig:LCObsPlot">2.14</a>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LCObsPlot"></span>
<img src="figures2/ch2/Lab_Count_Obs_Plot.PNG" alt="Time Series Plot of Lab Count Data" width="80%" height="80%" />
<p class="caption">
Figure 2.14: Time Series Plot of Lab Count Data
</p>
</div>
<p>Again, the ACF plot, see Figure <a href="distFitting.html#fig:LCACFPlot">2.15</a>, does not indicate that the data has any significant concerns with respect to autocorrelation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LCACFPlot"></span>
<img src="figures2/ch2/Lab_Count_ACF_Plot.PNG" alt="Autocorrelation Plot of Lab Count Data" width="80%" height="80%" />
<p class="caption">
Figure 2.15: Autocorrelation Plot of Lab Count Data
</p>
</div>
<p>Because the plots indicate that the data is likely to be independent and identically distributed, it appears that it should be safe to proceed with the distribution modeling task. The following code will estimate the parameters, perform a goodness of fit test, and display a plot that compares the theoretical PMF to the empirical PMF.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb52-1"><a href="distFitting.html#cb52-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">pmfModeler</span> <span class="op">=</span> PMFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb52-2"><a href="distFitting.html#cb52-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">results</span> <span class="op">=</span> pmfModeler<span class="op">.</span>estimateParameters<span class="op">(</span>setOf<span class="op">(</span>PoissonMLEParameterEstimator<span class="op">))</span></span>
<span id="cb52-3"><a href="distFitting.html#cb52-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">e</span> <span class="op">=</span> results<span class="op">.</span>first<span class="op">()</span></span>
<span id="cb52-4"><a href="distFitting.html#cb52-4" tabindex="-1"></a>println<span class="op">(</span>e<span class="op">)</span></span>
<span id="cb52-5"><a href="distFitting.html#cb52-5" tabindex="-1"></a><span class="kw">val</span> <span class="va">mean</span> <span class="op">=</span> e<span class="op">.</span>parameters<span class="op">!!.</span>doubleParameter<span class="op">(</span><span class="st">&quot;mean&quot;</span><span class="op">)</span></span>
<span id="cb52-6"><a href="distFitting.html#cb52-6" tabindex="-1"></a><span class="kw">val</span> <span class="va">pf</span> <span class="op">=</span> PoissonGoodnessOfFit<span class="op">(</span><span class="kw">data</span><span class="op">.</span>toDoubles<span class="op">(),</span> mean <span class="op">=</span> mean<span class="op">)</span></span>
<span id="cb52-7"><a href="distFitting.html#cb52-7" tabindex="-1"></a>println<span class="op">(</span>pf<span class="op">)</span></span>
<span id="cb52-8"><a href="distFitting.html#cb52-8" tabindex="-1"></a><span class="kw">val</span> <span class="va">plot</span> <span class="op">=</span> PMFComparisonPlot<span class="op">(</span><span class="kw">data</span><span class="op">,</span> pf<span class="op">.</span>distribution<span class="op">)</span></span>
<span id="cb52-9"><a href="distFitting.html#cb52-9" tabindex="-1"></a>plot<span class="op">.</span>saveToFile<span class="op">(</span><span class="st">&quot;Lab_Count_PMF_Plot&quot;</span><span class="op">)</span></span>
<span id="cb52-10"><a href="distFitting.html#cb52-10" tabindex="-1"></a>plot<span class="op">.</span>showInBrowser<span class="op">()</span></span></code></pre></div>
<p>The code first creates an instance of the <code>PMFModeler</code> class to perform the estimation. In this situation, only the estimator for the Poisson distribution is specified as input to the <code>estimateParameters()</code> function. The estimated mean of the distribution is extracted from the estimated parameters and used for the <code>PoissonGoodnessOfFit</code> class. The <code>PoissonGoodnessOfFit</code> class is a straight-forward sub-class of <code>DiscretePMFGoodnessOfFit</code> class. The results of the fit are printed and then the PMF comparison plot is created.</p>
<pre><code>Shift estimation results:
null

Estimated parameters:
RV Type = Poisson
Double Parameters {mean=8.275000000000002}
Integer Parameters {}
Double Array Parameters {}

Chi-Squared Test Results:
Bin Label                 P(Bin)       Observed   Expected
  1 [ 0.00, 4.00)         0.035151            6    5.62421
  2 [ 4.00, 5.00)         0.049782            7    7.96515
  3 [ 5.00, 6.00)         0.082390           13    13.1823
  4 [ 6.00, 7.00)         0.113629           16    18.1806
  5 [ 7.00, 8.00)         0.134326           21    21.4921
  6 [ 8.00, 9.00)         0.138943           25    22.2309
  7 [ 9.00,10.00)         0.127750           20    20.4401
  8 [10.00,11.00)         0.105713           21    16.9141
  9 [11.00,12.00)         0.079525           11    12.7241
 10 [12.00,13.00)         0.054839            7    8.77429
 11 [13.00,14.00)         0.034907            5    5.58518
 12 [14.00,Infinity)      0.043044            8    6.88700

Number of estimated parameters = 1
Number of intervals = 12
Degrees of Freedom = 10
Chi-Squared Test Statistic = 2.5923612067415056
P-value = 0.9894603477732713
Hypothesis test at 0.05 level: 
The p-value = 0.9894603477732713 is &gt;= 0.05 : Do not reject hypothesis.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:LCPMFPlot"></span>
<img src="figures2/ch2/Lab_Count_PMF_Plot.PNG" alt="PMF Comparison Plot of Lab Count Data" width="80%" height="80%" />
<p class="caption">
Figure 2.16: PMF Comparison Plot of Lab Count Data
</p>
</div>
<p>The results of the goodness of fit test and the PMF comparison plot, Figure <a href="distFitting.html#fig:LCPMFPlot">2.16</a>, clearly indicate that the Poisson distribution should not be rejected as a model for this data.</p>
<p>The follow example repeats the analysis of Section <a href="appidmsecfitContinuous.html#appidms2sb3">B.5.6</a> on the pharmacy service time data using KSL constructs.</p>
<hr />
<div class="example">
<p><span id="exm:ch2ex27" class="example"><strong>Example 2.27  (Analyzing the Pharmacy Data using the KSL) </strong></span>One hundred observations of the service time were collected using a
portable digital assistant and are shown in
Table <a href="distFitting.html#tab:PharmacyDataCh2">2.2</a> where the first observation is in row 1
column 1, the second observation is in row 2 column 1, the <span class="math inline">\(21^{st}\)</span>
observation is in row 1 column 2, and so forth.</p>
</div>
<div id="tab:PharmacyDataCh2">
<table>
<caption><span id="tab:PharmacyDataCh2">Table 2.2: </span> Pharmacy Service Times</caption>
<tbody>
<tr>
<td align="center">61</td>
<td align="center">278.73</td>
<td align="center">194.68</td>
<td align="center">55.33</td>
<td align="center">398.39</td>
</tr>
<tr>
<td align="center">59.09</td>
<td align="center">70.55</td>
<td align="center">151.65</td>
<td align="center">58.45</td>
<td align="center">86.88</td>
</tr>
<tr>
<td align="center">374.89</td>
<td align="center">782.22</td>
<td align="center">185.45</td>
<td align="center">640.59</td>
<td align="center">137.64</td>
</tr>
<tr>
<td align="center">195.45</td>
<td align="center">46.23</td>
<td align="center">120.42</td>
<td align="center">409.49</td>
<td align="center">171.39</td>
</tr>
<tr>
<td align="center">185.76</td>
<td align="center">126.49</td>
<td align="center">367.76</td>
<td align="center">87.19</td>
<td align="center">135.6</td>
</tr>
<tr>
<td align="center">268.61</td>
<td align="center">110.05</td>
<td align="center">146.81</td>
<td align="center">59</td>
<td align="center">291.63</td>
</tr>
<tr>
<td align="center">257.5</td>
<td align="center">294.19</td>
<td align="center">73.79</td>
<td align="center">71.64</td>
<td align="center">187.02</td>
</tr>
<tr>
<td align="center">475.51</td>
<td align="center">433.89</td>
<td align="center">440.7</td>
<td align="center">121.69</td>
<td align="center">174.11</td>
</tr>
<tr>
<td align="center">77.3</td>
<td align="center">211.38</td>
<td align="center">330.09</td>
<td align="center">96.96</td>
<td align="center">911.19</td>
</tr>
<tr>
<td align="center">88.71</td>
<td align="center">266.5</td>
<td align="center">97.99</td>
<td align="center">301.43</td>
<td align="center">201.53</td>
</tr>
<tr>
<td align="center">108.17</td>
<td align="center">71.77</td>
<td align="center">53.46</td>
<td align="center">68.98</td>
<td align="center">149.96</td>
</tr>
<tr>
<td align="center">94.68</td>
<td align="center">65.52</td>
<td align="center">279.9</td>
<td align="center">276.55</td>
<td align="center">163.27</td>
</tr>
<tr>
<td align="center">244.09</td>
<td align="center">71.61</td>
<td align="center">122.81</td>
<td align="center">497.87</td>
<td align="center">677.92</td>
</tr>
<tr>
<td align="center">230.68</td>
<td align="center">155.5</td>
<td align="center">42.93</td>
<td align="center">232.75</td>
<td align="center">255.64</td>
</tr>
<tr>
<td align="center">371.02</td>
<td align="center">83.51</td>
<td align="center">515.66</td>
<td align="center">52.2</td>
<td align="center">396.21</td>
</tr>
<tr>
<td align="center">160.39</td>
<td align="center">148.43</td>
<td align="center">56.11</td>
<td align="center">144.24</td>
<td align="center">181.76</td>
</tr>
<tr>
<td align="center">104.98</td>
<td align="center">46.23</td>
<td align="center">74.79</td>
<td align="center">86.43</td>
<td align="center">554.05</td>
</tr>
<tr>
<td align="center">102.98</td>
<td align="center">77.65</td>
<td align="center">188.15</td>
<td align="center">106.6</td>
<td align="center">123.22</td>
</tr>
<tr>
<td align="center">140.19</td>
<td align="center">104.15</td>
<td align="center">278.06</td>
<td align="center">183.82</td>
<td align="center">89.12</td>
</tr>
<tr>
<td align="center">193.65</td>
<td align="center">351.78</td>
<td align="center">95.53</td>
<td align="center">219.18</td>
<td align="center">546.57</td>
</tr>
</tbody>
</table>
</div>
<hr />
<p>Recall the basic process described in Appendix <a href="appidm.html#appidm">B</a>. We will plot the data using a histogram, make a time series observation plot, and make an ACF plot. The following code performs those tasks. The plots can be shown in a browser window or saved to files.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb54-1"><a href="distFitting.html#cb54-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> KSLFileUtil<span class="op">.</span>scanToArray<span class="op">(</span>myFile<span class="op">.</span>toPath<span class="op">())</span></span>
<span id="cb54-2"><a href="distFitting.html#cb54-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb54-3"><a href="distFitting.html#cb54-3" tabindex="-1"></a>println<span class="op">(</span>d<span class="op">.</span>histogram<span class="op">)</span></span>
<span id="cb54-4"><a href="distFitting.html#cb54-4" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb54-5"><a href="distFitting.html#cb54-5" tabindex="-1"></a><span class="kw">val</span> <span class="va">hPlot</span> <span class="op">=</span> d<span class="op">.</span>histogram<span class="op">.</span>histogramPlot<span class="op">()</span></span>
<span id="cb54-6"><a href="distFitting.html#cb54-6" tabindex="-1"></a>hPlot<span class="op">.</span>showInBrowser<span class="op">()</span></span>
<span id="cb54-7"><a href="distFitting.html#cb54-7" tabindex="-1"></a><span class="kw">val</span> <span class="va">op</span> <span class="op">=</span> ObservationsPlot<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb54-8"><a href="distFitting.html#cb54-8" tabindex="-1"></a>op<span class="op">.</span>showInBrowser<span class="op">()</span></span>
<span id="cb54-9"><a href="distFitting.html#cb54-9" tabindex="-1"></a><span class="kw">val</span> <span class="va">acf</span> <span class="op">=</span> ACFPlot<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb54-10"><a href="distFitting.html#cb54-10" tabindex="-1"></a>acf<span class="op">.</span>showInBrowser<span class="op">()</span></span></code></pre></div>
<p>This results in the following histogram summary, which clearly indicates that the data is shifted from zero to about 36.</p>
<pre><code>-------------------------------------
Number of bins = 6
First bin starts at = 36.0
Last bin ends at = 786.0
Under flow count = 0.0
Over flow count = 0.0
Total bin count = 100.0
Total count = 100.0
-------------------------------------
Bin Range        Count CumTot Frac  CumFrac
  1 [36.00,161.00)  = 60  60.0 0.600000 0.600000 
  2 [161.00,286.00)  = 22  82.0 0.220000 0.820000 
  3 [286.00,411.00)  = 10  92.0 0.100000 0.920000 
  4 [411.00,536.00)  = 6  98.0 0.060000 0.980000 
  5 [536.00,661.00)  = 1  99.0 0.010000 0.990000 
  6 [661.00,786.00)  = 1 100.0 0.010000 1.000000 
-------------------------------------</code></pre>
<p>Figure <a href="distFitting.html#fig:ch2PharmacyHistPlot">2.17</a> clearly shows an exponential shape for the distribution.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyHistPlot"></span>
<img src="figures2/ch2/pdfModelingResults_Hist_Plot.PNG" alt="Histogram of the Pharmacy Data" width="80%" height="80%" />
<p class="caption">
Figure 2.17: Histogram of the Pharmacy Data
</p>
</div>
<p>Similar to the analysis in Appendix <a href="appidm.html#appidm">B</a>, the time series plot, Figure <a href="distFitting.html#fig:ch2PharmachyObsPlot">2.18</a>, and the ACF plot, Figure <a href="distFitting.html#fig:ch2PharmacyACFPlot">2.19</a> do not indicate any issues with non-stationary behavior or with dependence within the observations.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmachyObsPlot"></span>
<img src="figures2/ch2/pdfModelingResults_Obs_Plot.PNG" alt="Time Series Observation Plot for Pharmacy Data" width="80%" height="80%" />
<p class="caption">
Figure 2.18: Time Series Observation Plot for Pharmacy Data
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyACFPlot"></span>
<img src="figures2/ch2/pdfModelingResults_ACF_Plot.PNG" alt="ACF Plot for Pharmacy Data" width="80%" height="80%" />
<p class="caption">
Figure 2.19: ACF Plot for Pharmacy Data
</p>
</div>
<p>Given this analysis, we can proceed with modeling the distribution and checking for the goodness of fit. The following KSL code will estimate the parameters of the default distributions within the KSL and recommend a candidate distribution. Notice that the shift parameter will be <em>automatically</em> estimated for this situation.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb56-1"><a href="distFitting.html#cb56-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">results</span>  <span class="op">=</span> d<span class="op">.</span>estimateAndEvaluateScores<span class="op">()</span></span>
<span id="cb56-2"><a href="distFitting.html#cb56-2" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;PDF Estimation Results for each Distribution:&quot;</span><span class="op">)</span></span>
<span id="cb56-3"><a href="distFitting.html#cb56-3" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;------------------------------------------------------&quot;</span><span class="op">)</span></span>
<span id="cb56-4"><a href="distFitting.html#cb56-4" tabindex="-1"></a>results<span class="op">.</span>sortedScoringResults<span class="op">.</span>forEach<span class="op">(::</span>println<span class="op">)</span></span>
<span id="cb56-5"><a href="distFitting.html#cb56-5" tabindex="-1"></a><span class="kw">val</span> <span class="va">topResult</span> <span class="op">=</span> results<span class="op">.</span>sortedScoringResults<span class="op">.</span>first<span class="op">()</span></span>
<span id="cb56-6"><a href="distFitting.html#cb56-6" tabindex="-1"></a><span class="kw">val</span> <span class="va">scores</span> <span class="op">=</span> results<span class="op">.</span>evaluationModel<span class="op">.</span>alternativeScoresAsDataFrame<span class="op">(</span><span class="st">&quot;Distributions&quot;</span><span class="op">)</span></span>
<span id="cb56-7"><a href="distFitting.html#cb56-7" tabindex="-1"></a>println<span class="op">(</span>scores<span class="op">)</span></span>
<span id="cb56-8"><a href="distFitting.html#cb56-8" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb56-9"><a href="distFitting.html#cb56-9" tabindex="-1"></a><span class="kw">val</span> <span class="va">values</span> <span class="op">=</span> results<span class="op">.</span>evaluationModel<span class="op">.</span>alternativeValuesAsDataFrame<span class="op">(</span><span class="st">&quot;Distributions&quot;</span><span class="op">)</span></span>
<span id="cb56-10"><a href="distFitting.html#cb56-10" tabindex="-1"></a>println<span class="op">(</span>values<span class="op">)</span></span>
<span id="cb56-11"><a href="distFitting.html#cb56-11" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb56-12"><a href="distFitting.html#cb56-12" tabindex="-1"></a><span class="kw">val</span> <span class="va">distPlot</span> <span class="op">=</span> topResult<span class="op">.</span>distributionFitPlot<span class="op">()</span></span>
<span id="cb56-13"><a href="distFitting.html#cb56-13" tabindex="-1"></a>distPlot<span class="op">.</span>showInBrowser<span class="op">(</span><span class="st">&quot;Recommended Distribution </span><span class="ss">${</span>topResult<span class="op">.</span>name<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb56-14"><a href="distFitting.html#cb56-14" tabindex="-1"></a>println<span class="op">()</span></span>
<span id="cb56-15"><a href="distFitting.html#cb56-15" tabindex="-1"></a>println<span class="op">(</span><span class="st">&quot;** Recommended Distribution** </span><span class="ss">${</span>topResult<span class="op">.</span>name<span class="ss">}</span><span class="st">&quot;</span><span class="op">)</span></span>
<span id="cb56-16"><a href="distFitting.html#cb56-16" tabindex="-1"></a>println<span class="op">()</span></span></code></pre></div>
<p>The following table displays the distribution fitting scores for the Bayesian Information Criterion (BIC), Anderson-Darling (AD), Cramer Von Mises (CVM), and Q-Q plot correlation criteria.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyScores"></span>
<img src="figures2/ch2/pdfModelingResults_Scores.png" alt="Scoring Model Results" width="100%" height="100%" />
<p class="caption">
Figure 2.20: Scoring Model Results
</p>
</div>
<p>By applying the value scoring model and sorting, we can see in Figure <a href="distFitting.html#fig:ch2PharmacyOveralScores">2.21</a> that the top performing distribution is the exponential distribution with an overall value of 0.9484545. Thus, the recommended distribution is: 36.83628655364795 + Exponential(mean=145.94151344635202). Notice that the shift parameter was automatically estimated for this situation.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyOveralScores"></span>
<img src="figures2/ch2/pdfModelingResults_OverallScores.png" alt="Overall Scoring Results" width="100%" height="100%" />
<p class="caption">
Figure 2.21: Overall Scoring Results
</p>
</div>
<p>The KSL distribution recommendation framework also evaluates each distribution based on the rank obtained by each metric. The distribution that had the most first place ranks can be considered the top performing distribution. As shown in Figure <a href="distFitting.html#fig:ch2PharmacyOveralRanks">2.22</a>, we again see that the exponential distribution is the top distribution based on rankings.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyOveralRanks"></span>
<img src="figures2/ch2/pdfModelingResults_RankingResults.png" alt="Overall Ranking Results" width="100%" height="100%" />
<p class="caption">
Figure 2.22: Overall Ranking Results
</p>
</div>
<p>If you are unsure of the recommended distribution or you want to better understand the sensitivity of the recommendation, the <code>PDFModeler</code> companion object provides support for bootstrapping the distribution family recommendation. Assuming that the observations are in an array called <code>data,</code> the following code will repeatedly sample from the data using a bootstrapping approach to tabulate the frequency that each possible distribution is recommended by the framework.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb57-1"><a href="distFitting.html#cb57-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">df</span> <span class="op">=</span> PDFModeler<span class="op">.</span>bootstrapFamilyFrequencyAsDataFrame<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb57-2"><a href="distFitting.html#cb57-2" tabindex="-1"></a>println<span class="op">(</span>df<span class="op">)</span></span></code></pre></div>
<p>Running the bootstrapping family frequency tabulation process on the pharamacy model data yields the following results.</p>
<pre><code>      Distribution Ranked First cum_count proportion cumProportion
 0      Triangular          1.0       1.0     0.0025      0.002500
 1 GeneralizedBeta          2.0       3.0     0.0050      0.007500
 2     Exponential        321.0     324.0     0.8025      0.810000
 3           Gamma         76.0     400.0     0.1900      1.000000</code></pre>
<p>Clearly, the exponential distribution is the most likely distribution to be recommended using the average scoring criterion. This process can be used before going through the PDF modeling process to suggest distributions to consider, or, as done here, it can be performed after the distribution recommendation process to provide some confidence in the recommended distribution.</p>
<p>After we are comfortable with the recommended distribution, we can use the following code to perform a goodness of fit analysis.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb59-1"><a href="distFitting.html#cb59-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">gof</span> <span class="op">=</span> ContinuousCDFGoodnessOfFit<span class="op">(</span>topResult<span class="op">.</span>estimationResult<span class="op">.</span>testData<span class="op">,</span></span>
<span id="cb59-2"><a href="distFitting.html#cb59-2" tabindex="-1"></a>  topResult<span class="op">.</span>distribution<span class="op">,</span></span>
<span id="cb59-3"><a href="distFitting.html#cb59-3" tabindex="-1"></a>  numEstimatedParameters <span class="op">=</span> topResult<span class="op">.</span>numberOfParameters</span>
<span id="cb59-4"><a href="distFitting.html#cb59-4" tabindex="-1"></a><span class="op">)</span></span>
<span id="cb59-5"><a href="distFitting.html#cb59-5" tabindex="-1"></a>println<span class="op">(</span>gof<span class="op">)</span></span></code></pre></div>
<p>The results of the goodness of fit analysis clearly indicate that we should not reject the exponential distribution. Notice that the results are for the shifted distribution.</p>
<pre><code>GOF Results for Distribution: Exponential(mean=145.94151344635202)
---------------------------------------------------------

Chi-Squared Test Results:
Bin Label                 P(Bin)       Observed   Expected
  1 [ 0.00, 7.49)         0.050000            3    5.00000
  2 [ 7.49,15.38)         0.050000            4    5.00000
  3 [15.38,23.72)         0.050000            8    5.00000
  4 [23.72,32.57)         0.050000            3    5.00000
  5 [32.57,41.98)         0.050000            8    5.00000
  6 [41.98,52.05)         0.050000            4    5.00000
  7 [52.05,62.87)         0.050000            5    5.00000
  8 [62.87,74.55)         0.050000            8    5.00000
  9 [74.55,87.25)         0.050000            4    5.00000
 10 [87.25,101.16)        0.050000            2    5.00000
 11 [101.16,116.54)       0.050000            9    5.00000
 12 [116.54,133.72)       0.050000            3    5.00000
 13 [133.72,153.21)       0.050000            4    5.00000
 14 [153.21,175.71)       0.050000            6    5.00000
 15 [175.71,202.32)       0.050000            3    5.00000
 16 [202.32,234.88)       0.050000            4    5.00000
 17 [234.88,276.87)       0.050000            7    5.00000
 18 [276.87,336.04)       0.050000            4    5.00000
 19 [336.04,437.20)       0.050000            5    5.00000
 20 [437.20,1596.00)      0.049982            6    4.99822   *** Warning: expected &lt; 5 ***

Number of estimated parameters = 1
Number of intervals = 20
Degrees of Freedom = 18
Chi-Squared Test Statistic = 16.000784446070348
P-value = 0.5924925929222188
Hypothesis test at 0.05 level: 
The p-value = 0.5924925929222188 is &gt;= 0.05 : Do not reject hypothesis.

Goodness of Fit Test Results:
K-S test statistic = 0.0399213095618332
K-S test p-value = 0.9954253138552503

Anderson-Darling test statistic = 0.24859556182926212
Anderson-Darling test p-value = 0.9710833730000956

Cramer-Von-Mises test statistic = 0.025283543923658194
Cramer-Von-Mises test p-value = 0.9893094979248238</code></pre>
<p>Finally, we can review the distribution plot, Figure <a href="distFitting.html#fig:ch2PharmacyPDFPlot">2.23</a>, and see that according the the P-P plot, Q-Q plot, histogram overlay, and empirical cumulative distribution overlay plot that the exponential distribution is an excellent probability model for this data.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:ch2PharmacyPDFPlot"></span>
<img src="figures2/ch2/pdfModelingResults_PDF_Plot.PNG" alt="Distribution Plot for Pharmacy Data" width="80%" height="80%" />
<p class="caption">
Figure 2.23: Distribution Plot for Pharmacy Data
</p>
</div>
<p>All the previously illustrated analysis can be performed with a few lines of code:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb61-1"><a href="distFitting.html#cb61-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">data</span> <span class="op">=</span> KSLFileUtil<span class="op">.</span>scanToArray<span class="op">(</span>myFile<span class="op">.</span>toPath<span class="op">())</span></span>
<span id="cb61-2"><a href="distFitting.html#cb61-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb61-3"><a href="distFitting.html#cb61-3" tabindex="-1"></a>d<span class="op">.</span>showAllResultsInBrowser<span class="op">()</span></span></code></pre></div>
<p>Finally, if you want to analyze a specific distribution, then you can access the results from the returned instance of the <code>PDFModelingResults</code> class. For example, if we want to analyze the second best distribution we can access the results for the second best distribution and display its results. Assuming that the data to be analyzed is in an array called <em>data</em>, the following code illustrates how to accomplish this task.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb62-1"><a href="distFitting.html#cb62-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb62-2"><a href="distFitting.html#cb62-2" tabindex="-1"></a><span class="co">// capture the PDFModelingResults</span></span>
<span id="cb62-3"><a href="distFitting.html#cb62-3" tabindex="-1"></a><span class="kw">val</span> <span class="va">results</span>  <span class="op">=</span> d<span class="op">.</span>estimateAndEvaluateScores<span class="op">()</span></span>
<span id="cb62-4"><a href="distFitting.html#cb62-4" tabindex="-1"></a><span class="kw">val</span> <span class="va">sortedResults</span><span class="op">:</span> List<span class="op">&lt;</span>ScoringResult<span class="op">&gt;</span> <span class="op">=</span> results<span class="op">.</span>resultsSortedByScoring</span>
<span id="cb62-5"><a href="distFitting.html#cb62-5" tabindex="-1"></a><span class="co">// the array is 0 based, so the element at 1 is the 2nd best</span></span>
<span id="cb62-6"><a href="distFitting.html#cb62-6" tabindex="-1"></a><span class="kw">val</span> <span class="va">result</span><span class="op">:</span> ScoringResult <span class="op">=</span> sortedResults<span class="op">[</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb62-7"><a href="distFitting.html#cb62-7" tabindex="-1"></a>KSLFileUtil<span class="op">.</span>openInBrowser<span class="op">(</span></span>
<span id="cb62-8"><a href="distFitting.html#cb62-8" tabindex="-1"></a>   fileName <span class="op">=</span> <span class="st">&quot;PDF_Goodness_Of_Fit_Results&quot;</span><span class="op">,</span></span>
<span id="cb62-9"><a href="distFitting.html#cb62-9" tabindex="-1"></a>   d<span class="op">.</span>htmlGoodnessOfFitSummary<span class="op">(</span>result<span class="op">)</span></span>
<span id="cb62-10"><a href="distFitting.html#cb62-10" tabindex="-1"></a><span class="op">)</span></span></code></pre></div>
<p>To see the results for every distribution, just use the <code>showAllGoodnessOfFitSummariesInBrowser</code> function.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode kt"><code class="sourceCode kotlin"><span id="cb63-1"><a href="distFitting.html#cb63-1" tabindex="-1"></a><span class="kw">val</span> <span class="va">d</span> <span class="op">=</span> PDFModeler<span class="op">(</span><span class="kw">data</span><span class="op">)</span></span>
<span id="cb63-2"><a href="distFitting.html#cb63-2" tabindex="-1"></a><span class="kw">val</span> <span class="va">results</span>  <span class="op">=</span> d<span class="op">.</span>estimateAndEvaluateScores<span class="op">()</span></span>
<span id="cb63-3"><a href="distFitting.html#cb63-3" tabindex="-1"></a>d<span class="op">.</span>showAllGoodnessOfFitSummariesInBrowser<span class="op">(</span>results<span class="op">)</span></span></code></pre></div>
<p>The functionally for distribution modeling within the KSL is on par with what you can find within commercial software.</p>
</div>
</div>
<h3><span class="header-section-number">G</span> References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-akaike74" class="csl-entry">
Akaike, H. 1974. <span>“A New Look at the Statistical Model Identification.”</span> <em>IEEE Transactions on Automatic Control</em> 19 (6): 716–23. <a href="https://doi.org/10.1109/TAC.1974.1100705">https://doi.org/10.1109/TAC.1974.1100705</a>.
</div>
<div id="ref-gan-koehler" class="csl-entry">
Gan, F., and K. J. Koehler. 1990. <span>“Goodness-of-Fit Tests Based on p-p Probability Plots.”</span> <em>Technometrics</em> 32 (3): 289–303.
</div>
<div id="ref-law2007simulation" class="csl-entry">
Law, A. 2007. <em>Simulation Modeling and Analysis</em>. 4th ed. McGraw-Hill.
</div>
<div id="ref-levina-bickel2001" class="csl-entry">
Levina, E., and P. Bickel. 2001. <span>“The Earth Mover’s Distance Is the Mallows Distance: Some Insights from Statistics.”</span> <em>Proceedings Eighth IEEE International Conference on Computer Vision. ICCV 2001</em> 2: 251–256 vol.2. <a href="https://doi.org/10.1109/ICCV.2001.937632">https://doi.org/10.1109/ICCV.2001.937632</a>.
</div>
<div id="ref-schwarz1978" class="csl-entry">
Schwarz, Gideon. 1978. <span>“<span class="nocase">Estimating the Dimension of a Model</span>.”</span> <em>The Annals of Statistics</em> 6 (2): 461–64. <a href="https://doi.org/10.1214/aos/1176344136">https://doi.org/10.1214/aos/1176344136</a>.
</div>
<div id="ref-vose2010" class="csl-entry">
Vose, David. 2010. <span>“Fitting Distributions to Data.”</span> <a href="https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=19631811c7fd08cac567a4ee886acae6d82e8f3f">https://citeseerx.ist.psu.edu/document?repid=rep1&amp;type=pdf&amp;doi=19631811c7fd08cac567a4ee886acae6d82e8f3f</a>.
</div>
<div id="ref-CAWilliams1950" class="csl-entry">
Williams, C. Arthur. 1950. <span>“On the Choice of the Number and Width of Classes for the Chi-Square Test of Goodness of Fit.”</span> <em>Journal of the American Statistical Association</em> 45 (249): 77–86.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probModels.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="summary.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
